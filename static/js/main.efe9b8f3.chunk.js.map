{"version":3,"sources":["../node_modules/peerjs/dist sync","theme/colors.ts","theme/transitions.js","theme/inputs/inputPadding.js","theme/inputs/baseInput.js","theme/buttons.js","theme/inputs/normal.js","theme/inputs/baseMagic.js","theme/inputs/index.js","theme/inputs/inputMagic.js","theme/menuItem.js","theme/dropdown.js","theme/text.js","theme/wells.js","theme/messages.js","theme/index.ts","theme/badges.js","theme/code.js","theme/links.js","theme/styles.js","utils/componentHelpers.ts","components/common/Button.tsx","components/common/Icon.jsx","components/NavBar.tsx","components/common/BasicInput.jsx","components/common/IconButton.jsx","components/common/Input.tsx","components/common/Well.tsx","lib/Observable.ts","lib/ConnectionTypes.ts","lib/PkgType.ts","lib/Connection.ts","lib/fake/FakeConn.ts","lib/fake/FakeMediaConnection.ts","lib/fake/FakePeer.ts","lib/PeerFactory.ts","3d/constants.ts","lib/ConnectionManager.ts","3d/extraObjects.ts","3d/helpers.ts","Game/components/TreeComponent.ts","3d/assets.ts","Game/components/SunOrientationTagComponent.ts","Game/systems/GameWorldSystem.ts","Game/components/AxialCoordsComponent.ts","Game/components/TileComponent.ts","Game/easing/applyEasing.ts","Game/easing/1d/inverseElastic.ts","Game/easing/1d/elastic.ts","Game/easing/1d/easeOut.ts","Game/easing/3d/jelly.ts","Game/components/TweenComponent.ts","Game/easing/3d/linear.ts","Game/components/SelectableComponent.ts","Game/systems/TreeSystem.ts","Game/components/TweenTargetComponent.ts","Game/systems/TweenSystem.ts","Game/systems/AxialCoordsSystem.ts","Game/systems/TileSystem.ts","Game/systems/SunOrientationSystem.ts","3d/Coordinates/HexCube.ts","3d/Coordinates/Cartesian2D.ts","3d/Coordinates/Axial.ts","Game/systems/TouchSystem.ts","Game/components/RendererComposerComponent.ts","Game/systems/RendererComposerSystem.ts","Game/systems/SelectionSystem.ts","Game/entities/tree.ts","Game/easing/1d/easeInOut.ts","Game/components/DelayedActionComponent.ts","Game/systems/DelayedActionSystem.ts","lib/StarMeshNetwork.ts","Game/GameWorld.ts","lib/pause.ts","lib/errors/NetworkStateBusyError.ts","Game/Game.ts","Game/getInitialState.ts","Game/isTreeGrowthStage.ts","lib/Room.ts","lib/RoomContext.ts","components/common/Card.tsx","components/Home.tsx","components/common/IconText.tsx","components/common/Dialog.jsx","components/common/ConfirmDialog.jsx","components/common/AlertDialog.tsx","components/common/AlertContext.tsx","components/Room.tsx","Game/GameContext.tsx","components/common/Collapsible.tsx","components/common/CollapsibleWell.tsx","assets/images/tokens/token1.png","assets/images/tokens/token2.png","assets/images/tokens/token3.png","assets/images/tokens/token4.png","components/common/Image.tsx","components/common/CountBadge.tsx","components/common/ImageStack.tsx","components/ScoreTokenStack.tsx","components/common/ButtonGroup.jsx","assets/images/sun.svg","components/SunlightTag.tsx","components/SunlightBadge.tsx","assets/images/tokens/seedBlue.png","assets/images/tokens/shortBlue.png","assets/images/tokens/midBlue.png","assets/images/tokens/tallBlue.png","assets/images/tokens/seedGreen.png","assets/images/tokens/shortGreen.png","assets/images/tokens/midGreen.png","assets/images/tokens/tallGreen.png","assets/images/tokens/seedOrange.png","assets/images/tokens/shortOrange.png","assets/images/tokens/midOrange.png","assets/images/tokens/tallOrange.png","assets/images/tokens/seedYellow.png","assets/images/tokens/shortYellow.png","assets/images/tokens/midYellow.png","assets/images/tokens/tallYellow.png","components/TreeTokenStack.tsx","components/Panel.tsx","components/Popper.tsx","components/common/ConfirmContext.tsx","components/playerStation/StationIndicator.tsx","components/playerStation/Token.tsx","components/playerStation/Station.tsx","components/GamePlayer.tsx","components/App.tsx","components/GameRenderer.tsx","Game/easing/1d/easeInOutQuart.ts","components/RevolutionCounter.tsx","serviceWorker.ts","index.tsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","makeFade","transparentize","vibrantColors","blue","red","green","yellow","gray","dullColors","paleColors","baseColors","vibrantHighlights","mapObjIndexed","dark","light","white","colors","primary","accent","inputFocus","fgHighlights","bgHighlights","text","muted","background","bgs","fgs","bgPales","map","fgPales","border","highlight","sunTagShadow","color","backgroundColor","prolog","comment","keyword","number","constant","variable","string","selector","tag","operator","punctuation","function","className","char","SLOW","transition","time","props","ease","p","join","shortTransition","inputPadding","px","py","baseInput","borderRadius","borderColor","boxShadow","theme","lineHeight","fontFamily","fontWeight","fontSize","baseButton","display","alignItems","textAlign","outline","cursor","pillButton","smButton","mdButton","buttonStyles","buttonColors","normal","fg","bg","hoverBg","success","warning","danger","active","transparent","buttons","styleName","colorName","fill","fakePlaceholder","position","top","pt","left","pointerEvents","ml","fakePlaceholderPull","baseMagic","inputMagic","overflow","zIndex","pageHeadingSizes","pageHeadingIconSizes","x","fontSizes","heading","mb","subheading","textTransform","letterSpacing","pageHeading","svg","width","height","largeHeading","columnHeading","columnCardHeading","helperText","baseWell","my","borderWidth","borderStyle","dashed","baseMessage","messageStyle","fillColor","info","useColorSchemeMediaQuery","modes","breakpoints","space","fonts","body","monospace","fontWeights","bold","lineHeights","input","radii","shadows","layout","container","maxWidth","sidebar","inputs","badges","messages","tabSize","MozTabSize","content","borderTopWidth","borderTopStyle","borderTopColor","right","menuItem","links","default","plain","dropdown","wells","styles","root","boxSizing","margin","overscrollBehaviorY","h1","h2","h3","h4","h5","h6","a","textDecoration","pre","overflowX","table","borderCollapse","borderSpacing","th","borderBottomStyle","td","img","hr","borderTop","borderBottom","isDefined","undefined","buttonProps","block","PropTypes","bool","Button","forwardRef","ref","variant","sx","justifyContent","propTypes","defaultProps","displayName","Icon","size","isInferringFontSize","Array","isArray","reduce","c","it","sizes","NavBar","func","isRequired","useColorMode","colorMode","setColorMode","mr","flex","onClick","title","path","mdiCircleSlice4","BasicInput","as","__themeKey","IconButton","type","visibility","hidden","iconSx","Input","object","onClearClick","mt","fullwidth","placeholder","label","disabled","transform","mdiClose","Well","TIMEOUT_DURATION","isMatcher","match","ConnEvent","PkgType","Observable","_onEventListeners","_onceEventListeners","event","listener","events","this","uuid","uuidv4","on","value","equals","Object","_","flag","key","once","preventClear","timeout","Promise","reject","cb","window","setTimeout","toString","clearTimeout","JSON","stringify","onceMatch","values","forEach","clearUuid","entries","push","off","Connection","conn","connectionManager","manager","dataHandler","pid","data","_t","ACK","response","ack","v","emit","CONN_DATA","CONN_PKG","send","CONN_ACK","enrichConn","log","peer","v4","split","promise","untilMatch","open","close","CONN_CLOSE","CONN_OPEN","error","CONN_ERROR","payload","FakeConn","bufferSize","dataChannel","metadata","peerConnection","reliable","serialization","otherEnd","hostPeer","callbacks","sent","trigger","_data","connections","filter","fn","FakeMediaConnection","f","stream","options","FakePeer","destroyed","disconnected","prototype","allPeers","fakeConn","fakeConn2","ap","peerId","connectionId","find","callback","Color","GrowthStage","PeerFactory","peers","useFake","make","r","shift","Peer","host","process","port","Number","parseInt","secure","config","parse","ConnectionManager","closed","onPeerOpenHandler","PEER_OPEN","onPeerConnectionHandler","connection","PEER_CONNECT","initPeer","existing","id1","id2","PEER_ERROR","connect","openHandler","prefixId","all","pkgType","sendPkg","PEER_CLOSE","PEER_DISCONNECT","rest","then","toLog","destroy","disconnectAll","startAs","TAU","Math","PI","IMAGES_LOCATION","MODELS","BLUE_TOP","ORANGE_TOP","YELLOW_TOP","GREEN_TOP","TRUNK","SHADE","GROUND_SHADE","ACORN","PINE_CONE","MAPLE_SEED","BASSWOOD_SEED","RING","LANDSCAPE","TREE_MODELS","BLUE","ORANGE","YELLOW","GREEN","SEED_MODELS","COLOR_VALUES","SHADE_Y","INITIAL_SUN_ORIENTATION","TREE_GROWTH_PROPS","SEED","tree","scale","Vector3","seed","SHORT","MID","TALL","TREE_GROWTH_DURATION","ACTION_COST_GROW","ACTION_COST_PURCHASE","IMAGE_SIZE_CSS","GROWTH_STAGE_NAME","textureLoader","TextureLoader","sunSegmentTexture","MeshBasicMaterial","load","console","sunSegmentMaterial","sunSegmentGeometry","PlaneBufferGeometry","sunSegmentMesh","Mesh","rotation","renderOrder","LEAF_CIRCLES","count","texture","leafMaterial","cylinderGeometry","CircleBufferGeometry","leafMesh","leafObj","Object3D","name","add","disposeObj3D","obj3d","traverse","obj","geometry","material","dispose","disposeMaterial","prop","Texture","TreeComponent","growthStage","topObj","trunkObj","plant","shade","groundShade","Component","schema","Types","Ref","objects","objectWaitOrders","loadedCount","totalCount","getObject","modelName","queue","modelNotFoundMessage","SunOrientationTagComponent","TagComponent","GameWorldSystem","world","attributes","gameWorld","ECSYThreeSystem","AxialCoordsComponent","axial","TileComponent","treeEntity","applyEasing","mapper","from","to","applyNumber","applyVector3","clone","multiply","sub","subScalar","bezier","hEase","compose","inverseElastic","easeOut","vEase","elastic","i","xz","TweenComponent","tweens","entity","tween","getMutableComponent","addScalar","SelectableComponent","refEntity","TreeSystem","delta","queries","trees","changed","updateGrowthStage","sceneHasUpdated","added","treeComp","axialComp","getComponent","getObject3D","linkedTileEntity","tileEntities","get","linkedTileComp","objectsToFetch","objs","o","seedObj","shadeObj","groundShadeObj","shadeContainer","y","groundShadeContainer","treeObj","set","plantContainerObj","random","createEntity","addObject3DComponent","addComponent","groundShadeContainerEntity","catch","queueTween","duration","loop","jelly","Euler","linear","setFromVector3","toVector3","components","Object3DComponent","listen","removed","TweenTargetComponent","TweenSystem","object3DTweens","results","tweenComp","tweenTarget","t","k","fromArray","toArray","referencedTweens","target","valueSetter","newTweens","tweenProp","oldValue","min","result","AxialCoordsSystem","axialPositions","prevQ","userData","q","prevR","toCartesian","z","TileSystem","tiles","tileComp","newColor","getHex","setHex","SunOrientationSystem","sunFacingObjs","sunOrientationRad","HexCube","Axial","hexCube","n","abs","max","s","neighbors","Cartesian2D","coords","sqrt","coord","euclideanDistance","origin","norm","normalize","toHexCube","range","toAxial","TouchSystem","hm","panDistances","lastPinchDistance","pinchDistance","setXY","mouseScreenPosition","innerWidth","innerHeight","hasMouseMoved","onMouseMove","MouseEvent","clientX","clientY","changedTouches","pageX","pageY","canvas","renderer","domElement","Hammer","enable","Pan","direction","DIRECTION_ALL","velocityX","velocityY","center","willSelectObject","clamp","camera","addEventListener","panDistance","pop","hDistance","vDistance","cameraRotationObj","newTilt","cameraTiltObj","RendererComposerComponent","composer","outlinePass","effectFXAA","WebGLRendererComponent","scene","RendererComposerSystem","needsResize","intersectionCounter","onResize","bind","removeEventListener","renderers","component","clientWidth","clientHeight","EffectComposer","renderTarget1","encoding","sRGBEncoding","renderTarget2","renderPass","RenderPass","addPass","OutlinePass","Vector2","edgeStrength","edgeThickness","hiddenEdgeColor","ShaderPass","FXAAShader","uniforms","removeComponent","rendererComposers","getPixelRatio","devicePixelRatio","setPixelRatio","aspect","updateProjectionMatrix","setSize","resolution","hoverObject","activeObject","selectedObjects","render","isECSYObject3D","SelectionSystem","secondsElapsed","raycaster","Raycaster","CHECK_PERIOD","selectableObjs","selectables","setFromCamera","intersections","intersectObjects","length","intersectedObject","parent","currentRef","willContinueSearch","activeObjectChangeHandlers","handler","createTree","gameEntity","pow","DelayedActionComponent","actions","DelayedActionSystem","delayedActions","delayedActionComp","newActions","delayedAction","StarMeshNetworkEvents","GameWorld","gui","stats","hasStarted","sceneEntity","Map","sunManagerEntity","Stats","dat","GUI","WebGLRenderer","antialias","ECSYThreeWorld","entityPoolSize","document","appendChild","dom","init","destroyGUI","stop","clear","splice","initGUI","clock","Clock","initialize","animationLoop","begin","execute","getDelta","elapsedTime","end","initRenderer","initECS","initScene","play","registerComponent","unregisterSystem","WebGLRendererSystem","registerSystem","priority","shadowMap","enabled","VSMShadowMap","setClearColor","outputEncoding","fov","remove","cameraFolder","addFolder","ambientLight","AmbientLight","sun","DirectionalLight","sin","castShadow","shadow","visible","bias","radius","near","far","bottom","mapSize","sunContainer","Group","sky","commonLights","floorObj","game","generateGrid","sunSegmentWrapperObj","sunSegmentObj","SUN_SEGMENT_SIZE","boardObj","boardEntity","tileContainer","tileEntity","ring","ringContainerObj","ringClone","mesh","children","originalMaterial","MeshStandardMaterial","distFromOrigin","tileDistance","cartesian","atan","message","treeComponent","removeTree","directionType","floor","realTo","easeInOut","getActiveEntity","setRayDirection","linkedTileComponent","pause","NETWORK_STATE_BUSY_ERROR","GameEvent","GameActions","isMemberChangePayload","d","members","StarMeshNetwork","myConnectionManager","initialState","reducer","hostConnectionManager","meToHostConnection","state","networkName","hostId","activeAction","requestQueue","stateStaging","stagingActionId","logs","networkErrorHandler","NETWORK_ERROR","sendToHost","initMyConnectionManagerListeners","onPkg","MEMBER_CHANGE","handleMemberChange","SET_STATE","STATE_CHANGE","DISPATCH","dispatchHandler","CANCEL","PROMOTE","setState","startPrefix","hostConnection","oldHost","broadcastPkg","connectPrefix","isClosed","member","HOST_CHANGE","includes","oldList","newList","memberJoining","memberLeaving","disconnect","MEMBERS_CHANGE","MEMBERS_JOIN","MEMBERS_LEFT","setReducer","dispatch","action","queueThisAction","actionId","responses","gotBusyError","gotValidationErrors","filtered","uniq","dispatchLocal","newState","leave","params","getInitialPlayerInfo","lightPoint","score","availableArea","playerBoard","getInitialBoard","leaves","isTreeGrowthStage","stage","RoomActionTypes","RoomEvents","Game","room","mi","turn","network","GAME_EVENT","errorHandler","prevState","connId","playerId","pi","gameState","END_TURN","endTurnHandler","GROW_TREE","fromString","growTreeHandler","PLANT_SEED","source","plantSeedHandler","PURCHASE","purchaseHandler","UPDATE_GAME_STATE","onActiveObjectChange","ACTIVE_OBJECT_CHANGED","activeAxial","getActiveAxial","started","myId","me","playerIds","_gameState","resetBoard","board","axialString","tileInfo","setTile","rayDirection","GAME_OVER","_playerId","dirtyTiles","nPlayers","preparingRound","revolutionLeft","endGameCalculation","photosynthesis","tile","distance","playerInfo","winningsPlayerIds","winningScore","gameOver","whoami","existingStage","resetTile","returnTree","obtainToken","current","nextPurchase","purchaseIndex","cost","scoreTokens","nextToken","amount","players","totalRevolutions","1","2","3","4","photosynthesisHints","getInitialState","CH","freeze","maxPlayers","minPlayers","Room","create","myName","roomCode","joinOrHost","JOIN","leaveRoom","joinOrCreate","ERROR","rename","RENAME","SET_HOST","LEAVE_ROOM","startGame","idDict","nameDict","START_GAME","endGame","END_GAME","networkReducer","setName","SET_PLAYERS","rejoin","LEAVE","typed","start","trace","idDictElement","roomState","globalRoom","RoomContext","createContext","useRoom","useContext","Card","Home","useState","location","hash","substring","setRoomCode","setError","setMessage","loading","setLoading","pushRoomCodeToHistory","history","pushState","useEffect","AppState","HOME","replaceState","flexDirection","onChange","toUpperCase","ROOM","finally","GAME","IconText","node","oneOfType","arrayOf","any","reverse","iconMargin","otherProps","reverse_","fillOpacity","Dialog","useThemeUI","ariaHideApp","isOpen","onRequestClose","isStatic","onClose","contentLabel","style","overlay","padding","overflowY","minWidth","opacity","ConfirmDialog","always","onAction","run","setIsOpen","pb","hideNoChoice","noText","yesText","AlertDialog","useAlert","AlertContext","alert","setPlayers","setHost","id3","id4","mdiCrown","mdiAccount","GameContext","useGame","GameContextProvider","setGameState","setGameOver","Provider","Collapsible","hideOnly","noInitialTransition","boxProps","useRef","scrollHeight","setScrollHeight","isVisible","setVisible","transitionState","setTransitionState","isMounted","setMounted","setInit","BEFORE","CollapsibleWell","defaultOpen","header","noPad","setController","reverseHeader","headerSx","onOpen","setOpen","show","hide","toggle","mdiChevronDown","Image","backgroundImage","backgroundSize","CountBadge","ImageStack","stack","imgPath","badge","hovering","setHovering","onTap","preventDefault","onPress","onPressUp","onMouseEnter","onMouseLeave","unselectable","onContextMenu","m","tokenImages","token1","token2","token3","token4","getScoreTokenImageByLeaves","ScoreTokenStack","tokenImage","ButtonGroup","cc","React","Children","child","borderLeft","borderBottomLeftRadius","borderTopLeftRadius","borderRight","borderBottomRightRadius","borderTopRightRadius","cloneElement","SunlightTag","alt","maxHeight","src","SunlightBadge","myPoints","Infinity","textShadow","TREE_TOKENS_BLUE","seedBlue","shortBlue","midBlue","tallBlue","TREE_TOKENS_GREEN","seedGreen","shortGreen","midGreen","tallGreen","TREE_TOKENS_ORANGE","seedOrange","shortOrange","midOrange","tallOrange","TREE_TOKENS_YELLOW","seedYellow","shortYellow","midYellow","tallYellow","TREE_TOKENS","getTreeImageByColorGrowthStage","TreeTokenStack","canBuy","useMemo","indexOf","Panel","interactionStateReducer","activePlayerId","setActivePlayerId","getName","flexWrap","columns","handlerAvailableTokenClick","growStage","Popper","interactionState","isMyTile","growthStageOfTile","parentElement","axialUpdateHandler","useCallback","popperCoord","purchase","plantInitialTreeButton","iHaveSeed","purchaseSeedCost","plantSeedButton","iHaveNextTree","purchaseNextStageCost","growTreeButton","haveSlot","harvestButton","justifyItems","defaultConfirm","confirm","ConfirmContext","GamePlayer","setInteractionState","patch","endTurn","plantSeed","growTree","yes","isPreparationRound","hintText","GameRenderer","divElem","childNodes","removeChild","getSystem","getRemainingSlices","elapsedRounds","circleIndex","isPieEnlarged","BORDER_WIDTH","RevolutionCounter","preparingRounds","isPreparation","totalRounds","circleIndexes","ceil","getColor","darken","lighten","otherBoxProps","updateNodeGroup","remaining","timing","SUN_ROTATION_DURATION","easeInOutQuart","userSelect","viewBox","shapeRendering","dx","dy","stdDeviation","floodOpacity","cx","cy","clipPath","stroke","strokeWidth","xlinkHref","fx","fy","stopColor","stopOpacity","offset","href","gradientUnits","gradientTransform","rx","ry","keyAccessor","update","enter","nodes","percentageRemaining","isLargeArc","cos","arcX","arcY","maskId","mask","textAnchor","WrappedComponent","withConfirmQueue","setQueue","popAlert","slice","queueConfirm","concat","confirmNodes","alertNodes","Boolean","hostname","exec","omitTheme","omit","ReactDOM","StrictMode","getElementById","loader","GLTFLoader","modelNames","MODELS_LOCATION","gltf","receiveShadow","waitOrders","order","orders","startLoad","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.efe9b8f3.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 109;","import { transparentize } from 'polished'\nimport { mapObjIndexed } from 'ramda'\n\nexport const makeFade = transparentize(0.6)\n\nexport const vibrantColors = {\n  blue: '#3976E9',\n  red: '#E4456F',\n  green: '#2AC87D',\n  yellow: '#E99608',\n  gray: '#9CC6E9'\n}\n\nexport const dullColors = {\n  blue: '#4168AE',\n  red: '#925666',\n  green: '#569276',\n  yellow: '#D49E41',\n  gray: '#8E959B'\n}\n\nexport const paleColors = {\n  blue: '#7ea6f1',\n  red: '#ed86a1',\n  green: '#74dbaa',\n  yellow: '#f1bb5e',\n  gray: '#bfdaf1'\n}\n\nexport const baseColors = {\n  ...vibrantColors,\n  vibrantHighlights: mapObjIndexed(makeFade, vibrantColors),\n  dark: ['#282c30', '#383e43', '#484f56'],\n  light: ['#E0E3E5', '#c0c2c4', '#a0a1a3'],\n  white: ['#f9fbfc', '#f0f2f3', '#e8ebec']\n}\n\nexport const colors = {\n  ...baseColors,\n  primary: baseColors.blue,\n  accent: baseColors.yellow,\n  inputFocus: transparentize(0.2, baseColors.blue)\n}\n\nexport const light = {\n  ...colors,\n  blue: [colors.blue, dullColors.blue],\n  red: [colors.red, dullColors.red],\n  green: [colors.green, dullColors.green],\n  yellow: [colors.yellow, dullColors.yellow],\n  fgHighlights: mapObjIndexed(makeFade, dullColors),\n  bgHighlights: mapObjIndexed(makeFade, paleColors),\n  gray: [colors.gray, dullColors.gray],\n  text: colors.dark[0],\n  muted: makeFade(colors.dark[0]),\n  background: colors.white[0],\n  bgs: colors.white,\n  fgs: colors.dark,\n  bgPales: colors.light.map(makeFade),\n  fgPales: colors.dark.map(makeFade),\n  border: transparentize(0.8, baseColors.dark[0]),\n  highlight: transparentize(0.9, baseColors.dark[0]),\n  sunTagShadow: '#9c4727',\n  code: {\n    color: '#0451a5',\n    backgroundColor: '#ffffff',\n    prolog: '#001080',\n    comment: '#008000',\n    keyword: '#0000FF',\n    number: '#09885a',\n    constant: '#0000ff',\n    variable: '#001080',\n    string: '#a31515',\n    selector: '#800000',\n    tag: '#800000',\n    operator: '#000000',\n    punctuation: '#000000',\n    function: '#795e26',\n    className: '#267f99',\n    char: '#a31515'\n  }\n}\n\nexport const dark = {\n  ...colors,\n  blue: [colors.blue, paleColors.blue],\n  red: [colors.red, paleColors.red],\n  green: [colors.green, paleColors.green],\n  yellow: [colors.yellow, paleColors.yellow],\n  gray: [colors.gray, paleColors.gray],\n  fgHighlights: mapObjIndexed(makeFade, paleColors),\n  bgHighlights: mapObjIndexed(makeFade, dullColors),\n  text: colors.light[0],\n  muted: makeFade(colors.light[0]),\n  background: colors.dark[0],\n  bgs: colors.dark,\n  fgs: colors.light,\n  bgPales: colors.dark.map(makeFade),\n  fgPales: colors.light.map(makeFade),\n  border: transparentize(0.8, baseColors.light[0]),\n  highlight: transparentize(0.9, baseColors.light[0]),\n  code: {\n    color: '#9CDCFE',\n    backgroundColor: '#1E1E1E',\n    prolog: '#9cdcfe',\n    comment: 'rgb(106, 153, 85)',\n    keyword: 'rgb(86, 156, 214)',\n    number: 'rgb(181, 206, 168)',\n    constant: 'rgb(100, 102, 149)',\n    variable: 'rgb(156, 220, 254)',\n    string: 'rgb(206, 145, 120)',\n    selector: 'rgb(215, 186, 125)',\n    tag: 'rgb(86, 156, 214)',\n    operator: '#808080',\n    punctuation: 'rgb(212, 212, 212)',\n    function: 'rgb(220, 220, 170)',\n    className: 'rgb(78, 201, 176)',\n    char: 'rgb(209, 105, 105)'\n  }\n}\n","export const SLOW = 0.3\nexport const FAST = 0.1\n\nexport const transition = (time, props, ease = 'ease') => ({\n  transition: props.map(p => `${time}s ${p} ${ease}`).join(',')\n})\n\nexport const shortTransition = (props) => transition(FAST, props)\n","export const inputPadding = {\n  px: 3,\n  py: 2\n}\n\nexport const mdInputPadding = {\n  px: 2,\n  py: 2\n}\n\nexport const smInputPadding = {\n  px: 1,\n  py: 1\n}\n","import { shortTransition } from '../transitions'\n\nexport const baseInput = {\n  borderRadius: 1,\n  border: '1px solid',\n  borderColor: 'border',\n  ...shortTransition(['box-shadow']),\n  boxShadow: '0 0 0 0 transparent',\n  ':focus, &.focus': {\n    boxShadow: theme => `0 0 0 3px ${theme.colors.inputFocus}`,\n    borderColor: 'unset'\n  },\n  lineHeight: 'input',\n  backgroundColor: 'transparent',\n  color: 'text',\n  fontFamily: 'body',\n  fontWeight: 'body',\n  fontSize: 1\n}\n","import { shortTransition } from './transitions'\nimport { inputPadding, mdInputPadding, smInputPadding } from './inputs/inputPadding'\nimport { baseInput } from './inputs/baseInput'\n\nexport const baseButton = {\n  ...baseInput,\n  ...inputPadding,\n  ...shortTransition(['background-color']),\n  display: 'inline-flex',\n  alignItems: 'center',\n  textAlign: 'unset',\n  outline: 'none',\n  '::-moz-focus-inner': {\n    border: 'none'\n  },\n  cursor: 'pointer',\n  ':disabled': {\n    cursor: 'default'\n  }\n}\n\nexport const pillButton = {\n  borderRadius: 4\n}\n\nexport const smButton = {\n  ...baseButton,\n  ...smInputPadding\n}\n\nexport const mdButton = {\n  ...baseButton,\n  ...mdInputPadding\n}\n\nexport const borderlessButton = {\n  ...baseButton,\n  border: 0\n}\n\nexport const borderlessSmButton = {\n  ...smButton,\n  border: 0\n}\n\nexport const borderlessMdButton = {\n  ...mdButton,\n  border: 0\n}\n\nconst buttonStyles = {\n  '': baseButton,\n  '-sm': smButton,\n  '-md': mdButton,\n  '-borderless': borderlessButton,\n  '-borderless-sm': borderlessSmButton,\n  '-borderless-md': borderlessMdButton,\n  '-pill': { ...baseButton, ...pillButton, px: 5 },\n  '-pill-sm': { ...smButton, ...pillButton, px: 3 },\n  '-pill-md': { ...mdButton, ...pillButton, px: 4 }\n}\n\nconst buttonColors = {\n  normal: {\n    fg: 'text',\n    bg: 'background',\n    hoverBg: 'highlight'\n  },\n  primary: {\n    fg: 'white.0',\n    bg: 'blue.0',\n    hoverBg: 'blue.1'\n  },\n  success: {\n    fg: 'white.0',\n    bg: 'blue.0',\n    hoverBg: 'blue.1'\n  },\n  warning: {\n    fg: 'dark.0',\n    bg: 'yellow.0',\n    hoverBg: 'yellow.1'\n  },\n  danger: {\n    fg: 'white.0',\n    bg: 'red.0',\n    hoverBg: 'red.1'\n  },\n  red: {\n    fg: 'white.0',\n    bg: 'red.0',\n    hoverBg: 'red.1'\n  },\n  active: {\n    fg: 'white.0',\n    bg: 'blue.0'\n  },\n  transparent: {\n    fg: 'fgs.0',\n    bg: 'transparent',\n    hoverBg: 'highlight',\n    border: 0\n  }\n}\n\n/**\n * @type {Record<string, any>}\n */\nconst buttons = {}\n\nfor (const styleName in buttonStyles) {\n  for (const colorName in buttonColors) {\n    buttons[colorName + styleName] = {\n      ...buttonStyles[styleName],\n      backgroundColor: buttonColors[colorName].bg,\n      color: buttonColors[colorName].fg,\n      '*': {\n        fill: buttonColors[colorName].fg\n      },\n      ':hover': {\n        backgroundColor: buttonColors[colorName].hoverBg\n      },\n      '&:disabled': {\n        backgroundColor: 'light.0',\n        color: 'light.1'\n      }\n    }\n  }\n}\n\nexport default buttons\n","import { inputPadding } from './inputPadding'\nimport { baseInput } from './baseInput'\n\nexport default {\n  ...baseInput,\n  ...inputPadding\n}\n","import { shortTransition } from '../transitions'\nimport { inputPadding } from './inputPadding'\n\nexport const placeholder = {\n  '::placeholder': {\n    color: 'transparent'\n  }\n}\n\nexport const fakePlaceholder = {\n  position: 'absolute',\n  top: '12px',\n  pt: '1px',\n  left: inputPadding.px,\n  pointerEvents: 'none',\n  ml: -1,\n  px: 1,\n  fontSize: 1,\n  borderRadius: 1,\n  color: 'fgs.1',\n  ...shortTransition(['top', 'font-size', 'color', 'background-color'])\n}\n\nexport const fakePlaceholderPull = {\n  backgroundColor: 'background',\n  fontSize: 0,\n  top: '-10px'\n}\n\nexport const fakePlaceholderFocus = {\n  color: 'blue'\n}\n\nexport default {\n  ...placeholder,\n  '+ *': {\n    ...fakePlaceholder\n  },\n  ':not(:placeholder-shown) + *': {\n    ...fakePlaceholderPull\n  },\n  ':focus + *': {\n    ...fakePlaceholderPull,\n    ...fakePlaceholderFocus\n  }\n}\n","import inputMagic from './inputMagic'\nimport normal from './normal'\nimport baseMagic from './baseMagic'\n\nexport default {\n  normal,\n  baseMagic,\n  inputMagic\n}\n","import normal from './normal'\nimport baseMagic from './baseMagic'\n\nexport default {\n  ...normal,\n  ...baseMagic\n}\n","import { inputPadding } from './inputs/inputPadding'\n\nexport default {\n  ...inputPadding,\n  color: 'text',\n  display: 'block',\n  ':hover': {\n    backgroundColor: 'highlight'\n  }\n}\n","import { baseInput } from './inputs/baseInput'\n\nexport default {\n  ...baseInput,\n  boxShadow: 2,\n  backgroundColor: 'bgs.1',\n  lineHeight: 1.8,\n  overflow: 'hidden',\n  zIndex: 1\n}\n","const pageHeadingSizes = [4, 5, 6]\nconst pageHeadingIconSizes = pageHeadingSizes.map(x => theme => theme.fontSizes[x])\n\nexport default {\n  fontSize: 1,\n  success: {\n    color: 'green.1'\n  },\n  danger: {\n    color: 'red.1'\n  },\n  warning: {\n    color: 'yellow.1'\n  },\n  heading: {\n    fontSize: [3, 4],\n    mb: 3\n  },\n  subheading: {\n    textTransform: 'uppercase',\n    letterSpacing: '2px',\n    fontWeight: 'bold',\n    fontSize: 2,\n    color: 'fgs.0',\n    mb: 3\n  },\n  pageHeading: {\n    fontSize: pageHeadingSizes,\n    mb: 3,\n    svg: {\n      color: '#ff0000',\n      width: pageHeadingIconSizes,\n      height: pageHeadingIconSizes\n    }\n  },\n  largeHeading: {\n    fontSize: [5, null, 7],\n    mb: 3\n  },\n  columnHeading: {\n    fontSize: 2,\n    fontWeight: 'bold'\n  },\n  columnCardHeading: {\n    fontSize: 2,\n    fontWeight: 'bold'\n  },\n  helperText: {\n    fontSize: 0,\n    color: 'muted'\n  }\n}\n","import { colors } from './colors'\nimport { transparentize } from 'polished'\n\nexport const baseWell = {\n  p: 3,\n  px: 3,\n  py: 3,\n  my: 3,\n  borderRadius: 1,\n  borderWidth: 1,\n  borderStyle: 'solid',\n  borderColor: 'border'\n}\n\nexport default {\n  normal: {\n    ...baseWell\n  },\n  dashed: {\n    ...baseWell,\n    borderStyle: 'dashed'\n  },\n  primary: {\n    ...baseWell,\n    borderColor: 'blue.1'\n  },\n  danger: {\n    ...baseWell,\n    borderColor: 'red.1',\n    backgroundColor: transparentize(0.7, colors.red)\n  },\n  warning: {\n    ...baseWell,\n    borderColor: 'yellow.1'\n  },\n  success: {\n    ...baseWell,\n    borderColor: 'green.1',\n    backgroundColor: transparentize(0.7, colors.green)\n  }\n}\n","const baseMessage = {\n  borderRadius: 1\n}\n\nconst messageStyle = (borderColor, fillColor) => ({\n  ...baseMessage,\n  borderColor: borderColor,\n  color: fillColor,\n  '*': {\n    fill: fillColor\n  }\n})\n\nexport default {\n  primary: messageStyle('blue.0', 'blue.1'),\n  info: messageStyle('gray.0', 'gray.1'),\n  danger: messageStyle('red.0', 'red.1'),\n  warning: messageStyle('yellow.0', 'yellow.1'),\n  success: messageStyle('green.0', 'green.1')\n}\n","import { colors, dark, light } from './colors'\nimport code from './code'\nimport buttons from './buttons'\nimport inputs from './inputs'\nimport menuItem from './menuItem'\nimport links from './links'\nimport dropdown from './dropdown'\nimport styles from './styles'\nimport text from './text'\nimport wells from './wells'\nimport messages from './messages'\nimport badges from './badges'\nimport { Theme } from '@theme-ui/css'\n\nconst theme: Theme = {\n  useColorSchemeMediaQuery: true,\n  colors: {\n    ...light,\n    modes: {\n      dark\n    }\n  },\n  bg: {\n    success: colors.green[0],\n    danger: colors.red[0],\n    warning: colors.yellow[0]\n  },\n  // eslint-disable-next-line\n  // @ts-ignore\n  text,\n  breakpoints: ['40em', '52em', '64em', '110em'],\n  space: [\n    0,\n    4,\n    8,\n    16,\n    32,\n    64,\n    128,\n    256,\n    512\n  ],\n  fonts: {\n    body: 'Nunito',\n    heading: 'inherit',\n    monospace: 'Inconsolata, monospace'\n  },\n  fontSizes: [\n    12,\n    14,\n    16,\n    20,\n    24,\n    32,\n    48,\n    64,\n    96\n  ],\n  fontWeights: {\n    body: 400,\n    heading: 300,\n    bold: 700\n  },\n  lineHeights: {\n    body: 1.5,\n    heading: 1.3,\n    input: 1.7\n  },\n  radii: [0, 4, 8, 16, 32],\n  shadows: [\n    'none',\n    '0 2px 4px rgba(0, 0, 0, 0.2)',\n    '0 4px 8px rgba(0, 0, 0, 0.3)'\n  ],\n  layout: {\n    container: {\n      maxWidth: '100em',\n      p: [3, null, 4]\n    },\n    sidebar: {\n      width: '250px'\n    }\n  },\n  buttons,\n  inputs,\n  badges,\n  messages,\n  code,\n  menuItem,\n  links,\n  dropdown,\n  wells,\n  // eslint-disable-next-line\n  // @ts-ignore\n  styles\n}\nexport default theme\n","export default {\n  primary: {\n    backgroundColor: 'blue.0',\n    color: 'white.0',\n    '*': {\n      fill: 'white.0'\n    }\n  },\n  success: {\n    backgroundColor: 'green.0',\n    color: 'white.0',\n    '*': {\n      fill: 'white.0'\n    }\n  },\n  danger: {\n    backgroundColor: 'red.0',\n    color: 'white.0',\n    '*': {\n      fill: 'white.0'\n    }\n  },\n  warning: {\n    backgroundColor: 'yellow.0',\n    color: 'dark.0',\n    '*': {\n      fill: 'dark.0'\n    }\n  }\n}\n","export default {\n  fontFamily: 'monospace',\n  fontSize: 'inherit',\n  color: 'code.color',\n  backgroundColor: 'code.backgroundColor',\n  borderRadius: 1,\n  borderWidth: '1px',\n  borderStyle: 'solid',\n  borderColor: 'border',\n  p: 3,\n  tabSize: 4,\n  MozTabSize: '4',\n  '.token-line': {\n    display: 'flex'\n  },\n  '.token': {\n    display: 'inline-block',\n    lineHeight: 1.5\n  },\n  '.prolog': {\n    color: 'code.prolog'\n  },\n  '.comment': {\n    color: 'code.comment'\n  },\n  '.builtin,.changed,.keyword': {\n    color: 'code.keyword'\n  },\n  '.number': {\n    color: 'code.number'\n  },\n  '.constant': {\n    color: 'code.constant'\n  },\n  '.attr-name,.variable': {\n    color: 'code.variable'\n  },\n  '.string,.attr-value': {\n    color: 'code.string'\n  },\n  '.selector': {\n    color: 'code.selector'\n  },\n  '.tag': {\n    color: 'code.tag'\n  },\n  '.punctuation,.operator': {\n    color: 'code.operator'\n  },\n  '.punctuation, .plain': {\n    color: 'code.punctuation'\n  },\n  '.function': {\n    color: 'code.function'\n  },\n  '.class-name': {\n    color: 'code.className'\n  },\n  '.char': {\n    color: 'code.char'\n  },\n  '.inserted': {\n    backgroundColor: 'fgHighlights.green'\n  },\n  '.deleted': {\n    backgroundColor: 'fgHighlights.red'\n  },\n  '.special': {\n    color: 'red.0'\n  },\n  '.tab': {\n    position: 'relative',\n    '::before': {\n      position: 'absolute',\n      left: '1px',\n      top: 'calc(50% - 0.5px)',\n      content: '\"\"',\n      width: 'calc(100% - 3.5px)',\n      borderTopWidth: '1px',\n      borderTopStyle: 'solid',\n      borderTopColor: 'red.0'\n    },\n    '::after': {\n      position: 'absolute',\n      right: '1px',\n      top: 0,\n      content: '\">\"',\n      color: 'red.0'\n    }\n  }\n}\n","export default {\n  default: {\n    color: 'blue.1',\n    '*': {\n      fill: 'blue.1'\n    },\n    ':hover': {\n      color: 'blue.0',\n      '*': {\n        fill: 'blue.0'\n      }\n    }\n  },\n  plain: {\n    color: 'gray.1',\n    '*': {\n      fill: 'gray.1'\n    },\n    ':hover': {\n      color: 'gray.0',\n      '*': {\n        fill: 'gray.0'\n      }\n    }\n  },\n  active: {\n    color: 'yellow.1',\n    '*': {\n      fill: 'yellow.1'\n    },\n    ':hover': {\n      color: 'yellow.0',\n      '*': {\n        fill: 'yellow.0'\n      }\n    }\n  }\n}\n","export default {\n  root: {\n    fontFamily: 'body',\n    fontWeight: 'body',\n    lineHeight: 'body'\n  },\n  '*': {\n    boxSizing: 'border-box'\n  },\n  body: {\n    margin: 0,\n    overscrollBehaviorY: 'contain'\n  },\n  h1: {\n    color: 'text',\n    fontFamily: 'heading',\n    lineHeight: 'heading',\n    fontWeight: 'heading',\n    fontSize: 5\n  },\n  h2: {\n    color: 'text',\n    fontFamily: 'heading',\n    lineHeight: 'heading',\n    fontWeight: 'heading',\n    fontSize: 4\n  },\n  h3: {\n    color: 'text',\n    fontFamily: 'heading',\n    lineHeight: 'heading',\n    fontWeight: 'heading',\n    fontSize: 3\n  },\n  h4: {\n    color: 'text',\n    fontFamily: 'heading',\n    lineHeight: 'heading',\n    fontWeight: 'heading',\n    fontSize: 2\n  },\n  h5: {\n    color: 'text',\n    fontFamily: 'heading',\n    lineHeight: 'heading',\n    fontWeight: 'heading',\n    fontSize: 1\n  },\n  h6: {\n    color: 'text',\n    fontFamily: 'heading',\n    lineHeight: 'heading',\n    fontWeight: 'heading',\n    fontSize: 0\n  },\n  p: {\n    color: 'text',\n    fontFamily: 'body',\n    fontWeight: 'body',\n    lineHeight: 'body'\n  },\n  a: {\n    textDecoration: 'none',\n    outline: 'none',\n    '::-moz-focus-inner': {\n      border: 'none'\n    }\n  },\n  pre: {\n    fontFamily: 'monospace',\n    overflowX: 'auto',\n    code: {\n      color: 'inherit'\n    }\n  },\n  table: {\n    width: '100%',\n    borderCollapse: 'separate',\n    borderSpacing: 0\n  },\n  th: {\n    textAlign: 'left',\n    borderBottomStyle: 'solid'\n  },\n  td: {\n    textAlign: 'left',\n    borderBottomStyle: 'solid'\n  },\n  img: {\n    maxWidth: '100%'\n  },\n  hr: {\n    borderTop: '1px solid',\n    borderBottom: 'none',\n    borderColor: 'border'\n  }\n}\n","/**\n * Guard against null and undefined\n * @param x\n */\nexport const isDefined = <T> (x: T | null | undefined): x is T => x !== undefined && x !== null\n\n/**\n * Use default value if null or undefined\n * @param x\n * @param defaultValue\n */\nexport const defaultValue = <T> (x: T | null | undefined, defaultValue: T): T => isDefined(x) ? x : defaultValue\n\nexport const useOrFallback = <T, U> (x: T | null | undefined, dependent: (x: T) => U, defaultValue: U): U =>\n  isDefined(x) ? dependent(x) : defaultValue\n\nexport const show = <T, U> (x: T | null | undefined, content: (x: T) => U): U | null => isDefined(x) ? content(x) : null\n","import { Button as ThemeUIButton, ButtonProps } from '@theme-ui/components'\nimport PropTypes from 'prop-types'\nimport { forwardRef, FunctionComponent } from 'react'\nimport { isDefined } from '../../utils/componentHelpers'\n\nconst buttonProps = {\n  block: PropTypes.bool\n}\n\ntype MyButtonProps = PropTypes.InferProps<typeof buttonProps>\n\nconst Button: FunctionComponent<MyButtonProps & ButtonProps> = forwardRef<HTMLButtonElement, MyButtonProps & ButtonProps>((props, ref) => (\n  <ThemeUIButton\n    ref={ref}\n    variant='normal'\n    sx={{\n      display: isDefined(props.block) && props.block ? 'flex' : undefined,\n      width: isDefined(props.block) && props.block ? '100%' : undefined,\n      justifyContent: isDefined(props.block) && props.block ? 'center' : undefined,\n      position: 'relative'\n    }}\n    {...props}\n  />\n))\n\nButton.propTypes = buttonProps\n\nButton.defaultProps = {\n  block: false\n}\n\nButton.displayName = 'Button'\n\nexport default Button\n","import MdiIcon from '@mdi/react'\nimport PropTypes from 'prop-types'\n\nconst Icon = (props) => {\n  const { color, size, sx } = props\n  const isInferringFontSize = (Array.isArray(size) && size.reduce((c, it) => c && typeof it === 'number', true)) || typeof size === 'number'\n  const fontSizes = Array.isArray(size) ? size : typeof size === 'number' ? [size] : size\n  const sizes = isInferringFontSize ? fontSizes.map(x => theme => theme.fontSizes[x] * theme.lineHeights.body) : fontSizes\n\n  return (\n    <MdiIcon\n      {...{ ...props, color: null, size: null }}\n      sx={{\n        fill: color,\n        height: sizes,\n        width: sizes,\n        ...sx\n      }}\n    />\n  )\n}\n\nIcon.propTypes = {\n  path: PropTypes.string.isRequired,\n  color: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.func\n  ]),\n  size: PropTypes.oneOfType([\n    PropTypes.number,\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.oneOfType([\n      PropTypes.number,\n      PropTypes.string\n    ]))\n  ]),\n  sx: PropTypes.object\n}\n\nIcon.defaultProps = {\n  color: 'text',\n  size: 1\n}\n\nexport default Icon\n","import { mdiCircleSlice4 } from '@mdi/js'\nimport { Flex } from '@theme-ui/components'\nimport { useColorMode } from '@theme-ui/color-modes'\nimport theme from '../theme'\nimport Button from './common/Button'\nimport Icon from './common/Icon'\nimport React, { FunctionComponent } from 'react'\nimport PropTypes from 'prop-types'\n\nconst propTypes = {\n  setState: PropTypes.func.isRequired,\n  state: PropTypes.number.isRequired\n}\n\nconst NavBar: FunctionComponent<PropTypes.InferProps<typeof propTypes>> = () => {\n  const [colorMode, setColorMode] = useColorMode()\n  const toggleDarkMode = (): void => setColorMode(colorMode === 'default' ? 'dark' : 'default')\n\n  return (\n    <Flex\n      py={2}\n      // eslint-disable-next-line\n      // @ts-ignore\n      // eslint-disable-next-line\n      px={theme.layout?.container.p}\n      sx={{ alignItems: 'center', position: 'fixed', width: '100%', zIndex: 1 }}>\n      <Flex mr={2} sx={{ alignItems: 'center', flex: 1 }}>\n        {/* {state > 0 && <Button onClick={() => setState(state - 1)}><Icon path={mdiArrowLeft}/></Button>} */}\n      </Flex>\n      <Flex ml='auto' sx={{ alignItems: 'center' }}>\n        <Button onClick={toggleDarkMode} mr={2} title='Toggle Dark Mode'><Icon path={mdiCircleSlice4}/></Button>\n      </Flex>\n    </Flex>\n  )\n}\nexport default NavBar\n\nNavBar.propTypes = propTypes\n","import { Box } from '@theme-ui/components'\n\nconst BasicInput = props => <Box as='input' __themeKey='inputs' variant='normal' {...props}/>\n\nexport default BasicInput\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Button from './Button'\nimport Icon from './Icon'\n\nconst IconButton = (props) => {\n  return <Button\n    variant={props.variant || 'normal-sm'}\n    type='button'\n    sx={{\n      ...props.sx,\n      visibility: props.hidden === undefined || props.hidden === null || !props.hidden ? 'unset' : 'hidden',\n      overflow: 'hidden'\n    }}\n    onClick={props.onClick}>\n    <Icon path={props.path} sx={props.iconSx} color={props.color} size={props.size}/>\n  </Button>\n}\n\nIconButton.propTypes = {\n  variant: PropTypes.string,\n  sx: PropTypes.object,\n  iconSx: PropTypes.object,\n  path: PropTypes.node,\n  onClick: PropTypes.func,\n  hidden: PropTypes.bool,\n  color: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.func\n  ]),\n  size: PropTypes.oneOfType([\n    PropTypes.number,\n    PropTypes.arrayOf(PropTypes.number)\n  ])\n}\n\nexport default IconButton\n","import { Box, Label, Text } from '@theme-ui/components'\nimport PropTypes from 'prop-types'\nimport BasicInput from './BasicInput'\nimport { FunctionComponent } from 'react'\nimport IconButton from './IconButton'\nimport { mdiClose } from '@mdi/js'\n\nconst propTypes = {\n  fullwidth: PropTypes.bool,\n  label: PropTypes.string.isRequired,\n  sx: PropTypes.object,\n  helperText: PropTypes.string,\n  disabled: PropTypes.bool,\n  onClearClick: PropTypes.func,\n  onChange: PropTypes.func,\n  value: PropTypes.string\n}\n\nconst Input: FunctionComponent<PropTypes.InferProps<typeof propTypes>> = ({ onClearClick, ...props }) => (\n  <Box mt={3} sx={{ width: props.fullwidth ?? false ? '100%' : undefined, ...props.sx }}>\n    <Label\n      sx={{\n        position: 'relative'\n      }}>\n      <BasicInput\n        {...props}\n        placeholder={props.label}\n        variant='inputMagic'\n        sx={{ width: props.fullwidth ?? false ? '100%' : undefined, ...props.sx }}\n      />\n      <Text>{props.label}</Text>\n      {!(props.disabled ?? false) && onClearClick !== undefined\n        ? <Box sx={{ position: 'absolute', right: 1, top: '50%', transform: 'translateY(-50%)' }}>\n          <IconButton variant='transparent-borderless-sm' path={mdiClose} onClick={onClearClick}/>\n        </Box>\n        : null}\n    </Label>\n    <Text variant='helperText'>\n      {props.helperText}\n    </Text>\n  </Box>\n)\n\nInput.propTypes = propTypes\n\nexport default Input\n","import React, { forwardRef, FunctionComponent } from 'react'\nimport { Box, BoxOwnProps } from '@theme-ui/components'\n\nconst Well: FunctionComponent<BoxOwnProps> = forwardRef<HTMLDivElement, BoxOwnProps>((props, ref) => (\n  <Box\n    ref={ref}\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-expect-error\n    __themeKey='wells'\n    variant='normal'\n    {...props}\n  />\n))\n\nWell.displayName = 'Well'\n\nexport default Well\n","import { v4 as uuidv4 } from 'uuid'\nimport { equals } from 'ramda'\n\nconst TIMEOUT_DURATION = 5000\n\ntype Payload = unknown\n\ntype Listener<P extends Payload> = (payload: P, preventClear?: () => void) => void\ntype Matcher<P extends Payload> = (payload: P) => boolean\n\nfunction isMatcher<P extends Payload> (match: P | Matcher<P> | { _: Partial<P> }): match is Matcher<P> {\n  return typeof match === 'function'\n}\n\n/**\n * @template E `typeof MyEnum` or a general `Record` with event names as keys paired with unique values\n * @template P type of payload\n */\nexport class Observable<E extends Record<string, string | number> = never, P extends Payload = never> {\n  private _onEventListeners: { [k in E[keyof E]]?: Record<string, Listener<P>> } = {}\n  private _onceEventListeners: { [k in E[keyof E]]?: Record<string, Listener<P>> } = {}\n\n  public on (event: E[keyof E], listener: Listener<P>): string {\n    let events = this._onEventListeners[event]\n    if (events === undefined) {\n      events = this._onEventListeners[event] = {}\n    }\n    const uuid = uuidv4()\n    events[uuid] = listener\n    return uuid\n  }\n\n  /**\n   * Given event, if the value going to feed to listener is equal to the params, call the listener\n   * @param event A value of E\n   * @param listener\n   * @param match\n   */\n  public onMatch (event: E[keyof E], listener: Listener<P>, match: P | Matcher<P> | { _: Partial<P> }): string {\n    return this.on(event, (value: P) => {\n      if (isMatcher(match)) {\n        if (match(value)) {\n          listener(value)\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n      } else if (equals(match, value) as unknown as boolean) {\n        listener(value)\n      } else if (\n        typeof match === 'object' &&\n        match !== null &&\n        // @ts-expect-error FIXME\n        '_' in match &&\n        Object.keys(match._)\n          .reduce(\n            (flag: boolean, key) => (\n              flag && equals(\n                (match._ as Record<string, unknown>)[key],\n                (value as Record<string, unknown>)[key])\n            ),\n            true\n          )\n      ) {\n        listener(value)\n      }\n    })\n  }\n\n  public once (event: E[keyof E], listener: Listener<P>): string {\n    let events = this._onceEventListeners[event]\n    if (events === undefined) {\n      events = this._onceEventListeners[event] = {}\n    }\n    const uuid = uuidv4()\n    events[uuid] = listener\n    return uuid\n  }\n\n  /**\n   *\n   * @param event\n   * @param listener\n   * @param match\n   */\n  public onceMatch (event: E[keyof E], listener: Listener<P>, match: P | Matcher<P> | { _: Partial<P> }): string {\n    return this.once(event, (value: P, preventClear?: () => void) => {\n      if (isMatcher(match)) {\n        if (match(value)) {\n          listener(value, preventClear)\n        } else {\n          preventClear?.()\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n      } else if (equals(match, value) as unknown as boolean) {\n        listener(value, preventClear)\n      } else if (\n        typeof match === 'object' &&\n        match !== null &&\n        // @ts-expect-error FIXME\n        '_' in match &&\n        Object.keys(match._)\n          .reduce(\n            (flag: boolean, key) => (\n              flag && equals(\n                (match._ as Record<string, unknown>)[key],\n                (value as Record<string, unknown>)[key])\n            ),\n            true\n          )\n      ) {\n        listener(value, preventClear)\n      } else {\n        preventClear?.()\n      }\n    })\n  }\n\n  public async until (event: E[keyof E], timeout = TIMEOUT_DURATION, _message?: unknown): Promise<P> {\n    return await new Promise((resolve, reject) => {\n      const cb = window.setTimeout(() => {\n        reject(new Error(event.toString() + ' timeout'))\n      }, timeout)\n      this.once(event, (value) => {\n        window.clearTimeout(cb)\n        resolve(value)\n      })\n    })\n  }\n\n  public async untilMatch (event: E[keyof E], value: P | Matcher<P> | { _: Partial<P> }, timeout = TIMEOUT_DURATION, _message?: unknown): Promise<P> {\n    if (value === undefined) throw new Error('expect undefined')\n    return await new Promise((resolve, reject) => {\n      const cb = window.setTimeout(() => {\n        reject(new Error(`${event} ${JSON.stringify(value)} timeout`))\n      }, timeout)\n      this.onceMatch(event, (value) => {\n        window.clearTimeout(cb)\n        resolve(value)\n      }, value)\n    })\n  }\n\n  public off (event: E[keyof E], uuid: string): void {\n    delete this._onEventListeners?.[event]?.[uuid]\n    delete this._onceEventListeners?.[event]?.[uuid]\n  }\n\n  public emit (event: E[keyof E], value: P): void {\n    Object.values(this._onEventListeners?.[event] ?? {})?.forEach((listener) => {\n      listener(value)\n    })\n    const clearUuid: string[] = []\n    Object.entries(this._onceEventListeners?.[event] ?? {})?.forEach(([uuid, listener]) => {\n      let preventClear = false\n      listener(value, () => {\n        preventClear = true\n      })\n      if (!preventClear) {\n        clearUuid.push(uuid)\n      }\n    })\n    clearUuid.forEach((uuid) => {\n      this.off(event, uuid)\n    })\n    // if (event !== '*') {\n    //   this.emit('*', event, ...params)\n    // }\n  }\n}\n","import { Connection } from './Connection'\nimport { PkgType } from './PkgType'\n\nexport enum ConnEvent {\n  ANY = '*',\n  PEER_OPEN = '_open',\n  PEER_CLOSE = '_close',\n  PEER_CONNECT = '_connect',\n  PEER_DISCONNECT = '_disconnect',\n  PEER_ERROR = '_error',\n  CONN_OPEN = 'open',\n  CONN_CLOSE = 'close',\n  CONN_DATA = 'data',\n  CONN_ERROR = 'error',\n  CONN_ACK = 'ack',\n  CONN_PKG = 'pkg'\n}\n\nexport interface ConnectionError {\n  name: string\n  message: string\n  stack?: string\n  type?: string\n}\n\nexport interface Package { _t: PkgType, data: unknown }\nexport type PayloadData = [string, Package]\n\nexport interface ConnectionListenerPayload {\n  conn?: Connection\n  data?: unknown\n  error?: ConnectionError\n  pid?: string\n  type?: PkgType\n  ack?: (ackVal: unknown) => void\n}\nexport type ConnectionListener = (payload: ConnectionListenerPayload) => void\n","export enum PkgType {\n  ALERT = 'alert',\n  XD = 'xd',\n  JOIN = 0,\n  MEMBER_CHANGE,\n  NEW_JOIN,\n  ACK,\n  PLAYER_LEFT,\n  CHANGE_HOST,\n  RENAME,\n  START_GAME,\n  GAME_EVENT,\n  UPDATE_GAME_STATE,\n  DISPATCH,\n  SET_STATE,\n  PROMOTE,\n  CANCEL,\n}\n","import { DataConnection } from 'peerjs'\nimport { v4 } from 'uuid'\nimport { ConnectionListenerPayload, ConnEvent, Package, PayloadData } from './ConnectionTypes'\nimport { ConnectionManager } from './ConnectionManager'\nimport { Observable } from './Observable'\nimport { PkgType } from './PkgType'\n\nexport class Connection extends Observable<typeof ConnEvent, ConnectionListenerPayload> {\n  protected conn?: DataConnection // undefined if it is connecting to itself\n  protected manager: ConnectionManager\n\n  protected log (...params: unknown[]): void {\n    this.manager.log(...params)\n  }\n\n  public get id (): string {\n    if (this.conn !== undefined) {\n      return this.conn.peer\n    } else {\n      return this.manager.id\n    }\n  }\n\n  constructor (conn: DataConnection | 'self', connectionManager: ConnectionManager) {\n    super()\n    if (conn !== 'self') {\n      this.conn = conn\n      this.enrichConn(conn)\n    }\n    this.manager = connectionManager\n  }\n\n  public async send (data: Package): Promise<ConnectionListenerPayload> {\n    const pid = v4().split('-')[0]\n    const promise = this.manager.untilMatch(\n      ConnEvent.CONN_ACK,\n      ({ pid: p }: ConnectionListenerPayload) => p === pid)\n    if (this.conn !== undefined) {\n      if (this.conn.open) {\n        this.conn.send([pid, data])\n      } else {\n        this.conn.on('open', () => {\n          this.conn?.send([pid, data])\n        })\n      }\n    } else {\n      this.dataHandler()([pid, data])\n    }\n    return await promise\n  }\n\n  public async sendPkg (type: PkgType, data: unknown): Promise<ConnectionListenerPayload> {\n    return await this.send({\n      data,\n      _t: type\n    })\n  }\n\n  public close (): void {\n    this.conn?.close()\n    this.emit(ConnEvent.CONN_CLOSE, { conn: this })\n  }\n\n  private readonly dataHandler = (conn?: DataConnection) => ([pid, data]: PayloadData) => {\n    if (data !== undefined && data._t !== PkgType.ACK) {\n      let response: unknown\n      const ack = (v: unknown): void => {\n        response = v\n      }\n      this.emit(ConnEvent.CONN_DATA, { conn: this, data, ack })\n      if (typeof data === 'object' && data._t !== undefined) {\n        this.emit(ConnEvent.CONN_PKG, { conn: this, data: data.data, type: data._t, ack })\n      }\n      if (conn !== undefined) {\n        if (response === undefined) {\n          conn.send([pid, { _t: PkgType.ACK, data: response }])\n        } else {\n          conn.send([pid, { _t: PkgType.ACK, data: response }])\n        }\n      } else {\n        if (response === undefined) {\n          this.dataHandler()([pid, { _t: PkgType.ACK, data: undefined }])\n        } else {\n          this.dataHandler()([pid, { _t: PkgType.ACK, data: response }])\n        }\n      }\n    } else {\n      if (typeof data === 'object' && data !== null && data._t !== undefined) {\n        this.emit(ConnEvent.CONN_ACK, { conn: this, data: data.data, type: data._t, pid })\n      } else {\n        this.emit(ConnEvent.CONN_ACK, { conn: this, data, pid })\n      }\n    }\n  }\n\n  private enrichConn (conn: DataConnection): DataConnection {\n    conn.on('open', () => {\n      this.emit(ConnEvent.CONN_OPEN, { conn: this })\n    })\n    conn.on('data', this.dataHandler(conn))\n    conn.on('error', (error: Error) => {\n      this.emit(ConnEvent.CONN_ERROR, { conn: this, error })\n    })\n    conn.on('close', () => {\n      this.emit(ConnEvent.CONN_CLOSE, { conn: this })\n    })\n    return conn\n  }\n\n  public emit (event: ConnEvent, payload: ConnectionListenerPayload): void {\n    super.emit(event, payload)\n    this.manager.emit(event, payload)\n  }\n}\n","import { DataConnection } from 'peerjs'\nimport { FakePeer } from './FakePeer'\n\nexport class FakeConn implements DataConnection {\n  bufferSize!: number\n  dataChannel!: RTCDataChannel\n  label = 'my label'\n  metadata: unknown\n  open = false\n  peer = 'peer'\n  peerConnection!: RTCPeerConnection\n  reliable = true\n  serialization = 'binary'\n  type = 'data'\n  otherEnd?: FakeConn\n  hostPeer?: FakePeer\n\n  constructor () {\n    window.setTimeout(() => {\n      this.open = true\n      this.trigger('open')\n    }, 1)\n  }\n\n  parse (): void {\n    throw new Error('not implemented')\n  }\n\n  stringify (_data: Record<string, unknown> | number | string | unknown[]): string {\n    throw new Error('not implemented')\n  }\n\n  close (): void {\n    if (this.open) {\n      this.open = false\n      if (this.hostPeer !== undefined) {\n        this.hostPeer.connections = this.hostPeer?.connections.filter(conn => conn !== this)\n      }\n      if (this.otherEnd !== undefined) {\n        this.otherEnd.open = false\n        if (this.otherEnd.hostPeer !== undefined) {\n          this.otherEnd.hostPeer.connections = this.otherEnd.hostPeer?.connections.filter(conn => conn !== this.otherEnd)\n        }\n      }\n      window.setTimeout(() => {\n        this.otherEnd?.trigger('close')\n        this.trigger('close')\n      }, 1)\n    }\n  }\n\n  off (event: string, fn: () => void, once?: boolean): void {\n    throw new Error('not implemented')\n  }\n\n  public callbacks: Record<string | 'data' | 'open' | 'close' | 'error', Array<(d?: unknown) => void>> = {}\n\n  public on (event: string, cb: () => void): void\n  public on (event: 'data', cb: (data: unknown) => void): void\n  public on (event: 'open', cb: () => void): void\n  public on (event: 'close', cb: () => void): void\n  public on (event: 'error', cb: (err: unknown) => void): void\n  public on (event: string | 'data' | 'open' | 'close' | 'error', cb: (() => void) | ((data: unknown) => void)): void {\n    if (!(event in this.callbacks)) {\n      this.callbacks[event] = []\n    }\n    this.callbacks[event].push(cb)\n  }\n\n  public trigger (event: string | 'data' | 'open' | 'close' | 'error', data?: unknown): void {\n    this.callbacks[event]?.forEach(cb => {\n      cb(data)\n    })\n  }\n\n  public sent: unknown[] = []\n\n  send (data: unknown): void {\n    if (!this.open) {\n      throw new Error('Send data before opening')\n    }\n    this.sent.push(data)\n    // eslint-disable-next-line no-void\n    void Promise.resolve(\n      this.otherEnd?.trigger('data', data)\n    )\n  }\n}\n","import Peer, { MediaConnection } from 'peerjs'\n\nexport class FakeMediaConnection implements MediaConnection {\n  bufferSize: unknown\n  dataChannel: unknown\n  label = 'my label'\n  metadata: unknown\n  open = true\n  peer = 'peer'\n  peerConnection!: RTCPeerConnection\n  reliable = true\n  serialization = 'binary'\n  type = 'data'\n\n  parse (): void {\n    throw new Error('not implemented')\n  }\n\n  stringify (data: Record<string, unknown> | string | number | unknown[]): string {\n    return ''\n  }\n\n  close (): void {\n    this.open = false\n  }\n\n  off (event: string, fn: () => void, once?: boolean): void {\n    this.callbacks[event] = this.callbacks[event].filter(f => f !== fn)\n  }\n\n  public callbacks: Record<string | 'data' | 'open' | 'close' | 'error', Array<(d?: unknown) => void>> = {}\n\n  // on (event: string, cb: () => void): void\n  // on (event: 'data', cb: (data: any) => void): void\n  // on (event: 'open', cb: () => void): void\n  // on (event: 'close', cb: () => void): void\n  // on (event: 'error', cb: (err: any) => void): void\n  // on (event: string | 'data' | 'open' | 'close' | 'error', cb: (() => void) | ((data: any) => void)): void {\n  //   if (!(event in this.callbacks)) {\n  //     this.callbacks[event] = []\n  //   }\n  //   this.callbacks[event].push(cb)\n  // }\n\n  public trigger (event: string | 'data' | 'open' | 'close' | 'error', data: unknown | undefined): void {\n    this.callbacks[event]?.forEach(cb => cb(data))\n  }\n\n  public sent: unknown[] = []\n\n  send (data: unknown): void {\n    this.sent.push(data)\n  }\n\n  answer (stream?: MediaStream, options?: Peer.AnswerOption): void {\n    throw new Error('not implemented')\n  }\n\n  on (event: string, cb: () => void): void\n  on (event: 'stream', cb: (stream: MediaStream) => void): void\n  on (event: 'close', cb: () => void): void\n  on (event: 'error', cb: (err: unknown) => void): void\n  on (event: string | 'stream' | 'close' | 'error', cb: (() => void) | ((stream: MediaStream) => void) | ((err: unknown) => void)): void {\n    if (!(event in this.callbacks)) {\n      this.callbacks[event] = []\n    }\n    this.callbacks[event].push(cb as (d: unknown) => void)\n  }\n}\n","import Peer from 'peerjs'\nimport { FakeConn } from './FakeConn'\nimport { FakeMediaConnection } from './FakeMediaConnection'\nimport { v4 as uuidv4 } from 'uuid'\n\nexport class FakePeer implements Peer {\n  static allPeers: Record<string, FakePeer> = {}\n  connections: FakeConn[] = []\n  destroyed = false\n  disconnected = false\n  id = 'some id'\n  prototype!: RTCIceServer\n\n  constructor (id?: string, options?: unknown) {\n    this.id = id ?? uuidv4()\n    if (this.id in FakePeer.allPeers) {\n      throw new Error(`Peer '${this.id}' already exist`)\n    }\n    FakePeer.allPeers[this.id] = this\n    window.setTimeout(() => {\n      this.trigger('open', this.id)\n    }, 1)\n  }\n\n  call (id: string, stream: MediaStream, options?: Peer.CallOption): Peer.MediaConnection {\n    return new FakeMediaConnection()\n  }\n\n  connect (id: string, options?: Peer.PeerConnectOption): Peer.DataConnection {\n    if (FakePeer.allPeers[id] === undefined) {\n      throw new Error()\n    }\n    const peer: FakePeer = FakePeer.allPeers[id]\n    const fakeConn = new FakeConn()\n    const fakeConn2 = new FakeConn()\n    this.connections.push(fakeConn)\n    peer.connections.push(fakeConn2)\n    fakeConn.peer = id\n    fakeConn2.peer = this.id\n    fakeConn.otherEnd = fakeConn2\n    fakeConn2.otherEnd = fakeConn\n    fakeConn.hostPeer = this\n    fakeConn2.hostPeer = peer\n    peer.trigger('connection', fakeConn2)\n    return fakeConn\n  }\n\n  destroy (): void {\n    this.destroyed = true\n    this.connections.forEach(conn => {\n      conn.close()\n    })\n    const { [this.id]: t, ...ap } = FakePeer.allPeers\n    FakePeer.allPeers = ap\n  }\n\n  disconnect (): void {\n    this.disconnected = true\n    const { [this.id]: t, ...ap } = FakePeer.allPeers\n    FakePeer.allPeers = ap\n  }\n\n  getConnection (peerId: string, connectionId: string): Peer.MediaConnection | Peer.DataConnection | null {\n    return this.connections.find(({ peer }) => peer === peerId) ?? null\n  }\n\n  listAllPeers (callback: (peerIds: string[]) => void): void {\n    throw new Error('not implemented')\n  }\n\n  off (event: string, fn: () => void, once?: boolean): void {\n    throw new Error('not implemented')\n  }\n\n  public callbacks: Record<string | 'data' | 'open' | 'close' | 'error', Array<(d?: unknown) => void>> = {}\n\n  on (event: string, cb: () => void): void\n  on (event: 'open', cb: (id: string) => void): void\n  on (event: 'connection', cb: (dataConnection: Peer.DataConnection) => void): void\n  on (event: 'call', cb: (mediaConnection: Peer.MediaConnection) => void): void\n  on (event: 'close', cb: () => void): void\n  on (event: 'disconnected', cb: () => void): void\n  on (event: 'error', cb: (err: unknown) => void): void\n  on (event: string | 'open' | 'connection' | 'call' | 'close' | 'disconnected' | 'error', cb: (() => void) | ((id: string) => void) | ((dataConnection: Peer.DataConnection) => void) | ((mediaConnection: Peer.MediaConnection) => void) | ((err: unknown) => void)): void {\n    if (!(event in this.callbacks)) {\n      this.callbacks[event] = []\n    }\n    this.callbacks[event].push(cb as (d?: unknown) => void)\n  }\n\n  public trigger (event: string | 'data' | 'open' | 'close' | 'error', data: unknown): void {\n    this.callbacks[event]?.forEach(cb => {\n      cb(data)\n    })\n  }\n\n  reconnect (): void {\n    throw new Error('not implemented')\n  }\n}\n","import Peer from 'peerjs'\nimport { FakePeer } from './fake/FakePeer'\n\nexport const PeerFactory: { peers: Peer[], useFake: boolean, make: (id?: string) => Peer | FakePeer } = {\n  peers: [],\n  useFake: false,\n  make (id?: string): Peer {\n    const r = PeerFactory.peers.shift()\n    if (r !== undefined) {\n      return r\n    } else if (!PeerFactory.useFake) {\n      if (process.env.REACT_APP_PEER_HOST === undefined) {\n        return new Peer(id)\n      } else {\n        return new Peer(id, {\n          host: process.env.REACT_APP_PEER_HOST ?? 'localhost',\n          port: Number.parseInt(process.env.REACT_APP_PEER_PORT ?? '9000'),\n          path: process.env.REACT_APP_PEER_PATH ?? '/peer',\n          secure: process.env.REACT_APP_PEER_SECURE === 'true',\n          // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n          config: typeof process.env.REACT_APP_PEER_CONFIG === 'string' ? JSON.parse(process.env.REACT_APP_PEER_CONFIG) : undefined\n        })\n      }\n    } else {\n      return new FakePeer(id)\n    }\n  }\n}\n","import { Vector3 } from 'three'\n\nexport const TAU = Math.PI * 2\n\nexport const MODELS_LOCATION = process.env.PUBLIC_URL + '/models'\nexport const IMAGES_LOCATION = process.env.PUBLIC_URL + '/images'\n\nexport const MODELS = {\n  BLUE_TOP: 'blueTop',\n  ORANGE_TOP: 'orangeTop',\n  YELLOW_TOP: 'yellowTop',\n  GREEN_TOP: 'greenTop',\n  TRUNK: 'trunk',\n  SHADE: 'shade',\n  GROUND_SHADE: 'groundShade',\n  ACORN: 'acorn',\n  PINE_CONE: 'pineCone',\n  MAPLE_SEED: 'mapleSeed',\n  BASSWOOD_SEED: 'basswoodSeed',\n  RING: 'ring',\n  LANDSCAPE: 'landscape'\n} as const\n\nexport enum Color {\n  BLUE,\n  ORANGE,\n  YELLOW,\n  GREEN\n}\n\nexport enum GrowthStage {\n  SEED,\n  SHORT,\n  MID,\n  TALL\n}\n\nexport type ModelName = typeof MODELS[keyof typeof MODELS]\n\nexport const TREE_MODELS: Record<Color, ModelName> = {\n  [Color.BLUE]: MODELS.BLUE_TOP,\n  [Color.ORANGE]: MODELS.ORANGE_TOP,\n  [Color.YELLOW]: MODELS.YELLOW_TOP,\n  [Color.GREEN]: MODELS.GREEN_TOP\n} as const\n\nexport const SEED_MODELS: Record<Color, ModelName> = {\n  [Color.BLUE]: MODELS.PINE_CONE,\n  [Color.ORANGE]: MODELS.BASSWOOD_SEED,\n  [Color.YELLOW]: MODELS.ACORN,\n  [Color.GREEN]: MODELS.MAPLE_SEED\n} as const\n\n// Rendering specifics\nexport const AMBIENT_COLOR = 0x191F48\nexport const SUN_COLOR = 0xF8FFB2\nexport const SKY_COLOR = 0xcaf1fc\nexport const INACTIVE_COLOR = 0x333333\nexport const COLOR_VALUES: { [k in Color]: number } = {\n  [Color.BLUE]: 0x1C77E9,\n  [Color.ORANGE]: 0xD9311A,\n  [Color.YELLOW]: 0xE9D51C,\n  [Color.GREEN]: 0x53E91C\n}\n\nexport const SHADE_Y: { [k in GrowthStage]: number } = [-18, -10.7, -5.63, 0]\nexport const SUN_ANGLE = 52.725\nexport const TREE_TOP_Y = 10\nexport const TILE_SIZE = 5\nexport const INITIAL_SUN_ORIENTATION = 1.50 * Math.PI\nexport const GROUND_SHADE_HIDDEN_ROTATION = -0.8\nexport const SUN_SEGMENT_SIZE = 56\nexport const SUN_SEGMENT_POSITION_Y = 2.2\nexport const SUN_SEGMENT_POSITION_Z = SUN_SEGMENT_SIZE / 2\n\nexport interface TreeGrowthProp {\n  tree: { scale: Vector3 }\n  seed: { scale: Vector3 }\n}\n\nexport const TREE_GROWTH_PROPS: { [k in GrowthStage]: TreeGrowthProp } = {\n  [GrowthStage.SEED]: {\n    tree: {\n      scale: new Vector3(0, 0, 0)\n    },\n    seed: {\n      scale: new Vector3(1, 1, 1)\n    }\n  },\n  [GrowthStage.SHORT]: {\n    tree: {\n      scale: new Vector3(0.333, 0.333, 0.333)\n    },\n    seed: {\n      scale: new Vector3(0, 0, 0)\n    }\n  },\n  [GrowthStage.MID]: {\n    tree: {\n      scale: new Vector3(0.666, 0.666, 0.666)\n    },\n    seed: {\n      scale: new Vector3(0, 0, 0)\n    }\n  },\n  [GrowthStage.TALL]: {\n    tree: {\n      scale: new Vector3(1, 1, 1)\n    },\n    seed: {\n      scale: new Vector3(0, 0, 0)\n    }\n  }\n}\n\n// Animations\nexport const TREE_GROWTH_DURATION = 1.5\nexport const GROUND_SHADE_DURATION = TREE_GROWTH_DURATION / 3 * 2\nexport const SUN_ROTATION_DURATION = 2\n\n// UI\nexport const CAMERA_INITIAL_POSITION = 95\nexport const CAMERA_MIN_ZOOM_DISTANCE = 20\nexport const CAMERA_MAX_ZOOM_DISTANCE = 300\nexport const CAMERA_FURTHEST_DISTANCE = 325\n\n// Gameplay\nexport const ACTION_COST_SEED = 1\n\nexport const ACTION_COST_GROW: { [k in GrowthStage]: number } = {\n  [GrowthStage.SEED]: 1,\n  [GrowthStage.SHORT]: 2,\n  [GrowthStage.MID]: 3,\n  [GrowthStage.TALL]: 4\n} as const\n\nexport const ACTION_COST_PURCHASE: { [k in GrowthStage]: readonly number[] } = {\n  [GrowthStage.SEED]: [1, 1, 2, 2],\n  [GrowthStage.SHORT]: [2, 2, 3, 3],\n  [GrowthStage.MID]: [3, 3, 4],\n  [GrowthStage.TALL]: [4, 5]\n} as const\n\nexport const IMAGE_SIZE = 50\nexport const IMAGE_SIZE_CSS = `${IMAGE_SIZE}px`\n\nexport const GROWTH_STAGE_NAME: { [k in GrowthStage]: string } = {\n  [GrowthStage.SEED]: 'seed',\n  [GrowthStage.SHORT]: 'short tree',\n  [GrowthStage.MID]: 'middle tree',\n  [GrowthStage.TALL]: 'tall tree'\n}\n","import Peer, { DataConnection } from 'peerjs'\nimport { Observable } from './Observable'\nimport { ConnectionListener, ConnectionListenerPayload, ConnEvent, Package } from './ConnectionTypes'\nimport { Connection } from './Connection'\nimport { PkgType } from './PkgType'\nimport { PeerFactory } from './PeerFactory'\n\nexport class ConnectionManager extends Observable<typeof ConnEvent, ConnectionListenerPayload> {\n  public id: string\n  protected peer: Peer\n  public connections: Connection[] = []\n  protected closed = false\n\n  public isClosed (): boolean {\n    return this.closed || this.peer.disconnected\n  }\n\n  public log = (..._params: unknown[]): void => {\n    // console.log(this.id, ..._params)\n  }\n\n  public static prefixId (id = ''): string {\n    return 'creamy9tale000000' + id\n  }\n\n  public static withPrefix (id = ''): ConnectionManager {\n    return new ConnectionManager(ConnectionManager.prefixId(id))\n  }\n\n  public static async startPrefix (id = ''): Promise<ConnectionManager> {\n    return await ConnectionManager.startAs(ConnectionManager.prefixId(id))\n  }\n\n  public static async startAs (id?: string): Promise<ConnectionManager> {\n    return await new Promise<ConnectionManager>((resolve, reject) => {\n      const manager = new ConnectionManager(id)\n      manager.once(ConnEvent.PEER_OPEN, () => {\n        resolve(manager)\n      })\n      manager.once(ConnEvent.PEER_ERROR, (payload) => {\n        reject(payload.error)\n      })\n    })\n  }\n\n  constructor (id?: string) {\n    super()\n    this.peer = this.initPeer(id)\n    this.id = this.peer.id\n    this.on(ConnEvent.CONN_CLOSE, ({ conn }) => {\n      if (conn !== undefined) {\n        this.connections = this.connections.filter(({ id }) => id !== conn.id)\n      }\n    })\n  }\n\n  public async connect (id: string, timeout = 5000): Promise<Connection> {\n    const existing = this.connections.find(({ id: _id }) => _id === id)\n    if (existing !== undefined) return Promise.resolve(existing)\n    if (id === this.id) {\n      return this.enrichConn(new Connection('self', this))\n    }\n    return await new Promise((resolve, reject) => {\n      const id1 = setTimeout(() => {\n        // reject(new ConnectionTimeoutError(id))\n      }, timeout)\n      const id2 = this.once(ConnEvent.PEER_ERROR, ({ error }: ConnectionListenerPayload) => {\n        reject(error)\n      })\n      const conn = this.peer.connect(id)\n      const openHandler = (): void => {\n        const connection: Connection = this.enrichConn(new Connection(conn, this))\n        this.off(ConnEvent.CONN_ERROR, id2)\n        resolve(connection)\n        clearTimeout(id1)\n      }\n      conn.on('open', () => {\n        openHandler()\n      })\n      if (conn.open) {\n        openHandler()\n      }\n    })\n  }\n\n  public async connectPrefix (id: string): Promise<Connection> {\n    return await this.connect(ConnectionManager.prefixId(id))\n  }\n\n  public async broadcast (data: Package): Promise<unknown> {\n    return await Promise.all(this.connections.map(async conn => {\n      return await conn.send(data)\n    }))\n  }\n\n  public async broadcastPkg (pkgType: PkgType, data: unknown): Promise<ConnectionListenerPayload[]> {\n    return await Promise.all(this.connections.map(async conn => {\n      return await conn.sendPkg(pkgType, data)\n    }))\n  }\n\n  private conn (id: string): Connection {\n    const find = this.connections.find(c => c.id === id)\n    if (find === undefined) {\n      throw new Error(`connection lost with ${id}`)\n    }\n    return find\n  }\n\n  public async send (id: string, data: Package): Promise<ConnectionListenerPayload> {\n    return await this.conn(id).send(data)\n  }\n\n  public async sendPkg (id: string, pkgType: PkgType, data: unknown): Promise<ConnectionListenerPayload> {\n    return await this.conn(id).sendPkg(pkgType, data)\n  }\n\n  private initPeer (id?: string): Peer {\n    const peer = PeerFactory.make(id)\n    peer.on('open', this.onPeerOpenHandler(peer))\n    peer.on('error', (error: Error) => {\n      this.emit(ConnEvent.PEER_ERROR, { error })\n    })\n    peer.on('close', () => {\n      this.emit(ConnEvent.PEER_CLOSE, {})\n    })\n    peer.on('disconnected', () => {\n      this.emit(ConnEvent.PEER_DISCONNECT, {})\n    })\n\n    return peer\n  }\n\n  private readonly onPeerOpenHandler = (peer: Peer) => (id: string): void => {\n    this.id = id\n    this.emit(ConnEvent.PEER_OPEN, {})\n    peer.on('connection', this.onPeerConnectionHandler)\n  }\n\n  private readonly onPeerConnectionHandler = (conn: DataConnection): void => {\n    this.log('connect', conn.peer)\n    const connection = this.enrichConn(new Connection(conn, this))\n    connection.once(ConnEvent.CONN_OPEN, () => {\n      this.emit(ConnEvent.PEER_CONNECT, { conn: connection })\n    })\n  }\n\n  public onPkg (pkgType: PkgType, listener: ConnectionListener): string {\n    return super.onMatch(ConnEvent.CONN_PKG, ({ data, ...rest }: ConnectionListenerPayload) => {\n      listener({ ...rest, data: data, type: pkgType })\n    }, { _: { type: pkgType } })\n  }\n\n  public oncePkg (pkgType: PkgType, listener: ConnectionListener): string {\n    return super.onceMatch(ConnEvent.CONN_PKG, ({ data, ...rest }: ConnectionListenerPayload) => {\n      listener({ ...rest, data: data, type: pkgType })\n    }, { _: { type: pkgType } })\n  }\n\n  public async untilPkg (pkgType: PkgType, timeout?: number): Promise<ConnectionListenerPayload> {\n    if (pkgType === undefined) throw new Error('trying to subscribe undefined pkgType')\n    return await super.untilMatch(ConnEvent.CONN_PKG, { _: { type: pkgType } }, timeout, pkgType)\n      .then(({ data, ...rest }: ConnectionListenerPayload) => {\n        return { ...rest, data: data, type: pkgType }\n      })\n  }\n\n  public on (event: ConnEvent, listener: ConnectionListener): string {\n    return super.on(event, listener)\n  }\n\n  public once (event: ConnEvent, listener: ConnectionListener): string {\n    return super.once(event, listener)\n  }\n\n  public emit (event: ConnEvent, payload: ConnectionListenerPayload): void {\n    const { conn, ...toLog } = payload\n    this.log('emit', event, { ...toLog, ...(conn !== undefined ? { conn: { id: conn?.id } } : {}) })\n    super.emit(event, payload)\n  }\n\n  private enrichConn (connection: Connection): Connection {\n    this.connections.push(connection)\n    return connection\n  }\n\n  public disconnect (id: string): void {\n    this.connections.find(c => c.id === id)?.close()\n  }\n\n  public disconnectAll (): void {\n    this.connections.map(conn => conn.close())\n  }\n\n  public destroy (): void {\n    this.closed = true\n    this.peer.destroy()\n    this.disconnectAll()\n  }\n\n  public close (): void {\n    this.closed = true\n    this.peer.destroy()\n    this.disconnectAll()\n  }\n}\n","import {\n  CircleBufferGeometry,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  PlaneBufferGeometry,\n  TextureLoader\n} from 'three'\nimport { IMAGES_LOCATION, SUN_SEGMENT_SIZE, TILE_SIZE } from './constants'\n\nconst textureLoader = new TextureLoader()\n\nexport const basicGray = new MeshBasicMaterial({\n  color: 0xcccccc\n})\n\nconst sunSegmentTexture = textureLoader.load(\n  IMAGES_LOCATION + '/sun_segment.png', undefined, undefined, console.error\n)\nconst sunSegmentMaterial = new MeshBasicMaterial({\n  transparent: true,\n  map: sunSegmentTexture\n})\nconst sunSegmentGeometry = new PlaneBufferGeometry(SUN_SEGMENT_SIZE, SUN_SEGMENT_SIZE)\nexport const sunSegmentMesh = new Mesh(sunSegmentGeometry, sunSegmentMaterial)\nsunSegmentMesh.rotation.x = -Math.PI / 2\nsunSegmentMesh.renderOrder = 1\n\nconst leafCounts = [1, 2, 3, 4] as const\nconst leafImagePaths = leafCounts.map(count => `${IMAGES_LOCATION}/leaf_${count}.svg`)\nconst leafTextures = leafImagePaths.map(path => textureLoader.load(path))\nconst leafMaterials = leafTextures.map(texture => new MeshBasicMaterial({\n  transparent: true,\n  map: texture\n}))\nexport const LEAF_CIRCLES = leafMaterials.map(leafMaterial => {\n  const cylinderGeometry = new CircleBufferGeometry(TILE_SIZE / 3 * 2, 12)\n  const leafMesh = new Mesh(cylinderGeometry, leafMaterial)\n  leafMesh.rotation.x = -Math.PI / 2\n  const leafObj = new Object3D()\n  leafObj.name = 'cylinder'\n  leafObj.add(leafMesh)\n  return leafObj\n})\n","import { Geometry, Material, Mesh, Object3D, Texture } from 'three'\nimport { BufferGeometry } from 'three/src/core/BufferGeometry'\nimport { basicGray } from './extraObjects'\n\nexport const disposeObj3D = (obj3d?: Object3D | null): void => {\n  obj3d?.traverse((obj) => {\n    if (obj instanceof Mesh) {\n      const geometry = obj.geometry as Geometry | BufferGeometry | undefined\n      const material = obj.material as Material | Material[] | undefined\n\n      if (geometry !== undefined) {\n        geometry.dispose()\n      }\n\n      const disposeMaterial = (material: Material): void => {\n        Object.keys(material).forEach((key) => {\n          const prop = material[key as keyof Material] as unknown\n          if (prop instanceof Texture) {\n            prop.dispose()\n          }\n        })\n        material.dispose()\n      }\n\n      if (material !== undefined) {\n        // Assuming no texture is used\n        if (Array.isArray(material)) {\n          material.forEach(disposeMaterial)\n        } else {\n          disposeMaterial(material)\n        }\n      }\n    }\n  })\n}\n\nexport const swapMaterial = (child: Object3D): void => {\n  if (child instanceof Mesh) {\n    child.material = basicGray\n  }\n}\n","import { Component, Types } from 'ecsy'\nimport { Color, GrowthStage } from '../../3d/constants'\nimport { Object3D } from 'three'\nimport { disposeObj3D } from '../../3d/helpers'\nimport { ECSYThreeEntity } from 'ecsy-three'\n\nexport default class TreeComponent extends Component<TreeComponent> {\n  readonly color!: Color\n  growthStage!: GrowthStage\n  topObj?: Object3D\n  trunkObj?: Object3D\n  plant?: ECSYThreeEntity\n  seed?: ECSYThreeEntity\n  tree?: ECSYThreeEntity\n  shade?: ECSYThreeEntity\n  groundShade?: ECSYThreeEntity\n\n  reset (): void {\n    this.plant = undefined\n    this.seed = undefined\n    this.tree = undefined\n    this.shade = undefined\n    disposeObj3D(this.topObj)\n    disposeObj3D(this.trunkObj)\n    this.topObj = undefined\n    this.trunkObj = undefined\n  }\n}\n\nTreeComponent.schema = {\n  color: { type: Types.Number },\n  growthStage: { type: Types.Number },\n  tree: { type: Types.Ref, default: undefined },\n  topObj: { type: Types.Ref, default: undefined },\n  trunkObj: { type: Types.Ref, default: undefined },\n  shade: { type: Types.Ref, default: undefined },\n  seed: { type: Types.Ref, default: undefined }\n}\n","import { Mesh, Object3D } from 'three'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport { MODELS, MODELS_LOCATION } from './constants'\n\nexport const objects: Record<string, Object3D | undefined> = {}\n\ninterface WaitOrder {\n  resolve: (value: Object3D | PromiseLike<Object3D>) => void\n  reject: (reason: unknown) => void\n  modelName: string\n}\n\nconst objectWaitOrders: Record<string, WaitOrder[] | undefined> = {}\n\nlet loadedCount = 0\nlet totalCount = 0\n\nexport const resetAssets = (): void => {\n  Object.keys(objects).forEach(key => {\n    objects[key] = undefined\n  })\n  loadedCount = 0\n  totalCount = 0\n}\n\nconst modelNotFoundMessage = 'Model not found'\n\nconst doneLoading = (): void => {\n  // Clean up unhandled promises\n  Object.values(objectWaitOrders)\n    .filter(orders => Array.isArray(orders))\n    .forEach(orders => orders?.forEach(({ reject, modelName }) => reject(new Error(modelNotFoundMessage + ': ' + modelName))))\n  Object.keys(objectWaitOrders).forEach(key => {\n    objectWaitOrders[key] = undefined\n  })\n}\n\nexport const startLoad = (): void => {\n  const loader = new GLTFLoader()\n  const modelNames = Object.values(MODELS)\n  totalCount = modelNames.length\n  modelNames.forEach(name => {\n    loader.load(\n      MODELS_LOCATION + '/' + name + '.glb',\n      (gltf) => {\n        // Process objects\n        const object = new Object3D()\n        object.name = name\n        object.add(...gltf.scene.children)\n        object.traverse(child => {\n          if (child instanceof Mesh) {\n            child.castShadow = true\n            child.receiveShadow = true\n          }\n        })\n        objects[name] = object\n\n        // Resolve promises\n        const waitOrders = objectWaitOrders[name]\n        if (waitOrders !== undefined) {\n          waitOrders.forEach(order => {\n            order.resolve(object)\n          })\n          objectWaitOrders[name] = undefined\n        }\n\n        // Loaded\n        loadedCount++\n        if (loadedCount === totalCount) {\n          doneLoading()\n        }\n      },\n      undefined,\n      (e) => console.error(e)\n    )\n  })\n}\n\nexport const getObject = async (modelName: string): Promise<Object3D> => {\n  const obj3d = objects[modelName]\n  if (obj3d === undefined) {\n    if (loadedCount !== totalCount) {\n      // Not all models are loaded, this model may be loading\n      const queue: WaitOrder[] = objectWaitOrders[modelName] ?? []\n      if (objectWaitOrders[modelName] === undefined) {\n        objectWaitOrders[modelName] = queue\n      }\n      return await new Promise((resolve, reject) => {\n        queue.push({ resolve, reject, modelName })\n      })\n    } else {\n      // Model name is definitely not loaded\n      return Promise.reject(new Error(modelNotFoundMessage + ': ' + modelName))\n    }\n  } else {\n    return Promise.resolve(obj3d)\n  }\n}\n","import { TagComponent } from 'ecsy'\n\nexport default class SunOrientationTagComponent extends TagComponent {}\n","import { ECSYThreeSystem, ECSYThreeWorld } from 'ecsy-three'\nimport GameWorld from '../GameWorld'\nimport { GameWorldAttributes } from '../types/GameWorldAttributes'\n\nexport default abstract class GameWorldSystem extends ECSYThreeSystem {\n  protected readonly gameWorld: GameWorld\n\n  public constructor (world: ECSYThreeWorld, attributes?: GameWorldAttributes) {\n    super(world, attributes)\n    if (attributes?.gameWorld === undefined) {\n      throw new Error('Game world must be provided')\n    }\n    this.gameWorld = attributes?.gameWorld\n  }\n}\n","import { Component, Types } from 'ecsy'\nimport Axial from '../../3d/Coordinates/Axial'\n\nexport default class AxialCoordsComponent extends Component<AxialCoordsComponent> {\n  axial!: Axial\n}\n\nAxialCoordsComponent.schema = {\n  axial: { type: Types.Ref }\n}\n","import { Component, Types } from 'ecsy'\nimport { MeshStandardMaterial } from 'three'\nimport { ECSYThreeEntity } from 'ecsy-three'\n\nexport default class TileComponent extends Component<TileComponent> {\n  material?: MeshStandardMaterial\n  treeEntity?: ECSYThreeEntity\n}\n\nTileComponent.schema = {\n  material: { type: Types.Ref, default: undefined },\n  treeEntity: { type: Types.Ref, default: undefined }\n}\n","import { TweenFunction } from '../types/TweenObjectProperties'\nimport { EasingFunction, TweenValueMapper } from '../types/Easing'\nimport { Euler, Vector2, Vector3 } from 'three'\n\nconst applyEasing = <T> (mapper: TweenValueMapper<T>) =>\n  (func: EasingFunction<T>): TweenFunction<T> =>\n    (from: T, to: T, value: number) =>\n      mapper(from, to, func(value))\n\nexport const applyNumber = applyEasing<number>(\n  (from, to, value) => to * value + from * (1 - value)\n)\n\nexport const applyVector3 = applyEasing<Vector3>(\n  (from, to, value) =>\n    to.clone().multiply(value).sub(from.clone().multiply(value.clone().subScalar(1)))\n)\n\nexport const applyVector2 = applyEasing<Vector2>(\n  (from, to, value) =>\n    to.clone().multiply(value).sub(from.clone().multiply(value.clone().subScalar(1)))\n)\n\nexport const toEulerTween = (func: TweenFunction<Vector3>): TweenFunction<Euler> =>\n  (from, to, value) => new Euler().setFromVector3(func(from.toVector3(), to.toVector3(), value))\n","import bezier from 'bezier-easing'\n\nexport default bezier(0.2, 1.61, 0.7, -0.1)\n// export default bezier(0.13, 1.85, 0.57, -0.08)\n","import bezier from 'bezier-easing'\n\nexport default bezier(0.32, -0.16, 0, 1.51)\n// export default bezier(0.49, -0.16, 0, 1.09)\n","import bezier from 'bezier-easing'\n\nexport default bezier(0, 0, 0.58, 1)\n","import { Vector3 } from 'three'\nimport { compose } from 'ramda'\nimport inverseElastic from '../1d/inverseElastic'\nimport elastic from '../1d/elastic'\nimport easeOut from '../1d/easeOut'\n\nconst hEase = compose(inverseElastic, easeOut)\nconst vEase = compose(elastic, easeOut)\n\nexport default (i: number): Vector3 => {\n  const xz = hEase(i)\n  return new Vector3(xz, vEase(i), xz)\n}\n","import { Component, Entity, Types } from 'ecsy'\nimport TweenProperties from '../types/TweenProperties'\n\n// TODO deep clone when getObject\n// TODO tween material\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport default class TweenComponent<T extends TweenProperties<any>> extends Component<TweenComponent<T>> {\n  tweens: T[] = []\n\n  reset (): void {\n    super.reset()\n    this.tweens = []\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static queueTween<T extends TweenProperties<any>> (entity: Entity, tween: T): void {\n    entity.getMutableComponent<TweenComponent<T>>(TweenComponent)?.tweens.push(tween)\n    // console.log(entity.id, tween)\n  }\n}\n\nTweenComponent.schema = {\n  tweens: { type: Types.Array, default: [] }\n}\n","import { Vector3 } from 'three'\n\nexport default (i: number): Vector3 => new Vector3().addScalar(i)\n","import { Component, Types } from 'ecsy'\nimport { ECSYThreeEntity } from 'ecsy-three'\n\nexport default class SelectableComponent extends Component<SelectableComponent> {\n  refEntity!: ECSYThreeEntity\n}\n\nSelectableComponent.schema = {\n  refEntity: { type: Types.Ref }\n}\n","import TreeComponent from '../components/TreeComponent'\nimport { getObject } from '../../3d/assets'\nimport {\n  Color, GROUND_SHADE_DURATION,\n  GROUND_SHADE_HIDDEN_ROTATION,\n  GrowthStage,\n  MODELS,\n  SEED_MODELS,\n  SHADE_Y, TAU, TREE_GROWTH_DURATION,\n  TREE_GROWTH_PROPS,\n  TREE_MODELS,\n  TREE_TOP_Y\n} from '../../3d/constants'\nimport { ECSYThreeEntity, Object3DComponent } from 'ecsy-three'\nimport { Euler, Object3D, Vector3 } from 'three'\nimport SunOrientationTagComponent from '../components/SunOrientationTagComponent'\nimport GameWorldSystem from './GameWorldSystem'\nimport AxialCoordsComponent from '../components/AxialCoordsComponent'\nimport TileComponent from '../components/TileComponent'\nimport { applyVector3, toEulerTween } from '../easing/applyEasing'\nimport jelly from '../easing/3d/jelly'\nimport TweenComponent from '../components/TweenComponent'\nimport TweenObjectProperties from '../types/TweenObjectProperties'\nimport linear from '../easing/3d/linear'\nimport SelectableComponent from '../components/SelectableComponent'\n\nexport default class TreeSystem extends GameWorldSystem {\n  execute (delta: number, time: number): void {\n    this.queries.trees.changed?.forEach((entity) => {\n      TreeSystem.updateGrowthStage(entity)\n      this.gameWorld.sceneHasUpdated = true\n    })\n\n    this.queries.trees.added?.forEach((entity) => {\n      // Added\n      const treeComp = entity.getMutableComponent(TreeComponent)\n      const axialComp = entity.getComponent<AxialCoordsComponent>(AxialCoordsComponent)\n      const obj3d = entity.getObject3D()\n      if (treeComp === undefined || obj3d === undefined || axialComp === undefined) {\n        return\n      }\n\n      const linkedTileEntity = this.gameWorld.tileEntities.get(axialComp.axial.toString())\n      if (linkedTileEntity === undefined) {\n        return\n      }\n\n      const linkedTileComp = linkedTileEntity.getMutableComponent(TileComponent)\n      if (linkedTileComp === undefined) {\n        return\n      }\n      linkedTileComp.treeEntity = entity\n\n      const { color } = treeComp\n      obj3d.name = 'tree-' + entity.id.toString() + '-' + Color[color]\n\n      this.gameWorld.sceneHasUpdated = true\n\n      // setup components\n      const objectsToFetch = [\n        getObject(TREE_MODELS[color]),\n        getObject(MODELS.TRUNK),\n        getObject(SEED_MODELS[color]),\n        getObject(MODELS.SHADE),\n        getObject(MODELS.GROUND_SHADE)\n      ]\n\n      Promise.all(objectsToFetch).then((objs) => {\n        const [\n          topObj,\n          trunkObj,\n          seedObj,\n          shadeObj,\n          groundShadeObj\n        ] = objs.map(o => o.clone())\n\n        const shadeContainer = new Object3D()\n        shadeContainer.name = 'shadeContainer'\n        shadeContainer.add(shadeObj)\n        shadeContainer.position.y = SHADE_Y[treeComp.growthStage]\n\n        const groundShadeContainer = new Object3D()\n        groundShadeContainer.name = 'groundShadeContainer'\n\n        const treeObj = new Object3D()\n        treeObj.name = 'tree'\n        topObj.position.y = TREE_TOP_Y\n        treeComp.topObj = topObj\n        treeComp.trunkObj = trunkObj\n        treeObj.scale.set(0, 0, 0)\n        treeObj.add(topObj, trunkObj)\n\n        seedObj.scale.set(0, 0, 0)\n\n        const plantContainerObj = new Object3D()\n        plantContainerObj.name = 'plantContainer'\n        plantContainerObj.rotation.y = Math.random() * TAU\n        plantContainerObj.add(treeObj, seedObj)\n\n        treeComp.plant = this.world\n          .createEntity()\n          .addObject3DComponent(plantContainerObj, entity)\n          .addComponent(SelectableComponent, { refEntity: linkedTileEntity })\n        treeComp.tree = this.world\n          .createEntity()\n          .addObject3DComponent(treeObj, treeComp.plant)\n          .addComponent(TweenComponent)\n        treeComp.seed = this.world\n          .createEntity()\n          .addObject3DComponent(seedObj, treeComp.plant)\n          .addComponent(TweenComponent)\n        treeComp.shade = this.world\n          .createEntity()\n          .addObject3DComponent(shadeContainer, entity)\n          .addComponent(SunOrientationTagComponent)\n          .addComponent(TweenComponent)\n        const groundShadeContainerEntity = this.world\n          .createEntity()\n          .addObject3DComponent(groundShadeContainer, entity)\n          .addComponent(SunOrientationTagComponent)\n        treeComp.groundShade = this.world\n          .createEntity()\n          .addObject3DComponent(groundShadeObj, groundShadeContainerEntity)\n          .addComponent(TweenComponent)\n\n        // Initialize scales and positions to smallest size for animation\n        groundShadeObj.rotation.x = GROUND_SHADE_HIDDEN_ROTATION\n        shadeContainer.position.y = SHADE_Y[GrowthStage.SEED]\n        treeObj.scale.set(0, 0, 0)\n        seedObj.scale.set(0, 0, 0)\n        TreeSystem.updateGrowthStage(entity)\n      }).catch(console.error)\n    })\n  }\n\n  private static updateGrowthStage (entity: ECSYThreeEntity): void {\n    // Changed\n    const treeComp = entity.getComponent(TreeComponent)\n    if (treeComp === undefined) {\n      return\n    }\n\n    const {\n      tree,\n      seed,\n      shade,\n      groundShade\n    } = treeComp\n\n    const treeObj = tree?.getObject3D()\n    const seedObj = seed?.getObject3D()\n    const shadeObj = shade?.getObject3D()\n    const groundShadeObj = groundShade?.getObject3D()\n\n    if (shade !== undefined && shadeObj !== undefined) {\n      TweenComponent.queueTween<TweenObjectProperties<Object3D, 'position'>>(shade, {\n        duration: TREE_GROWTH_DURATION,\n        loop: 1,\n        value: 0,\n        prop: 'position',\n        from: shadeObj.position,\n        to: new Vector3(0, SHADE_Y[treeComp.growthStage], 0),\n        func: applyVector3(jelly)\n      })\n    }\n    if (groundShade !== undefined && groundShadeObj !== undefined) {\n      TweenComponent.queueTween<TweenObjectProperties<Object3D, 'rotation'>>(groundShade, {\n        duration: GROUND_SHADE_DURATION,\n        loop: 1,\n        value: 0,\n        prop: 'rotation',\n        from: groundShadeObj.rotation,\n        to: new Euler(treeComp.growthStage === GrowthStage.SEED ? GROUND_SHADE_HIDDEN_ROTATION : 0, 0, 0),\n        func: toEulerTween(applyVector3(linear))\n      })\n    }\n    if (tree !== undefined && treeObj !== undefined) {\n      TweenComponent.queueTween<TweenObjectProperties<Object3D, 'scale'>>(tree, {\n        duration: TREE_GROWTH_DURATION,\n        loop: 1,\n        value: 0,\n        prop: 'scale',\n        from: treeObj.scale.clone(),\n        to: TREE_GROWTH_PROPS[treeComp.growthStage].tree.scale.clone(),\n        func: applyVector3(jelly)\n      })\n    }\n    if (seed !== undefined && seedObj !== undefined) {\n      TweenComponent.queueTween<TweenObjectProperties<Object3D, 'scale'>>(seed, {\n        duration: TREE_GROWTH_DURATION,\n        loop: 1,\n        value: 0,\n        prop: 'scale',\n        from: seedObj.scale.clone(),\n        to: TREE_GROWTH_PROPS[treeComp.growthStage].seed.scale.clone(),\n        func: applyVector3(jelly)\n      })\n    }\n  }\n}\n\n/*\nGrowth stages:\n0: seed model, scale = 1 easeInOutBack => tree model scale 0 grow out, seed shrink\n1: tree model, scale = 0.33 easeInOutBack\n2: tree model, scale = 0.66 easeInOutBack\n3: tree model, scale = 1 easeInOutBack\n */\n\nTreeSystem.queries = {\n  trees: {\n    components: [\n      TreeComponent, Object3DComponent\n    ],\n    listen: {\n      added: true,\n      removed: true,\n      changed: [TreeComponent, AxialCoordsComponent]\n    }\n  }\n}\n","import { Component, Types } from 'ecsy'\n\nexport default class TweenTargetComponent<T> extends Component<TweenTargetComponent<T>> {\n  ref!: T\n}\n\nTweenTargetComponent.schema = {\n  ref: { type: Types.Ref }\n}\n","import { Object3DComponent } from 'ecsy-three'\nimport TweenComponent from '../components/TweenComponent'\nimport { Object3D } from 'three'\nimport TweenObjectProperties from '../types/TweenObjectProperties'\nimport TweenTargetComponent from '../components/TweenTargetComponent'\nimport GameWorldSystem from './GameWorldSystem'\n\nexport default class TweenSystem extends GameWorldSystem {\n  execute (delta: number, time: number): void {\n    this.queries.object3DTweens.results.forEach(entity => {\n      const obj3d = entity?.getObject3D()\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const tweenComp = entity.getMutableComponent<TweenComponent<TweenObjectProperties<Object3D, any>>>(TweenComponent)\n\n      if (obj3d === undefined || tweenComp === undefined) {\n        return\n      }\n\n      this.tweenTarget<Object3D, 'scale' | 'position' | 'rotation' | 'quaternion'>(\n        obj3d,\n        tweenComp,\n        delta,\n        (v, t, k) => t[k].fromArray(v.toArray())\n      )\n    })\n\n    this.queries.referencedTweens.results.forEach(entity => {\n      const target = entity?.getComponent<TweenTargetComponent<unknown>>(TweenTargetComponent)?.ref\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const tweenComp = entity.getMutableComponent<TweenComponent<TweenObjectProperties<any, any>>>(TweenComponent)\n\n      if (target === undefined || tweenComp === undefined) {\n        return\n      }\n\n      // eslint-disable-next-line\n      this.tweenTarget<any, any>(target, tweenComp, delta, (v, t, k) => { t[k] = v })\n    })\n  }\n\n  private tweenTarget<T, K extends keyof T> (\n    target: T,\n    tweenComp: TweenComponent<TweenObjectProperties<T, K>>,\n    delta: number,\n    valueSetter: (value: T[K], target: T, key: K) => void\n  ): void {\n    const newTweens: typeof tweenComp.tweens = []\n\n    tweenComp.tweens.forEach((tweenProp) => {\n      if (tweenProp === undefined) {\n        return\n      }\n\n      const {\n        duration,\n        value: oldValue,\n        prop,\n        from,\n        to,\n        func\n      } = tweenProp\n\n      const value = Math.min(1, delta / duration + oldValue)\n      tweenProp.value = value\n\n      const result = func(from, to, value)\n      valueSetter(result, target, prop)\n\n      this.gameWorld.sceneHasUpdated = true\n\n      if (value === 1) {\n        tweenProp.value = 0\n        // Tweening is complete\n        if (tweenProp.loop > 0) {\n          // Next loop\n          tweenProp.loop--\n        }\n        if (tweenProp.loop === 0) {\n          // Keep prop\n          return\n        }\n      }\n\n      newTweens.push(tweenProp)\n    })\n\n    tweenComp.tweens = newTweens\n  }\n}\n\nTweenSystem.queries = {\n  object3DTweens: {\n    components: [TweenComponent, Object3DComponent]\n  },\n  referencedTweens: {\n    components: [TweenComponent, TweenTargetComponent]\n  }\n}\n","import AxialCoordsComponent from '../components/AxialCoordsComponent'\nimport { Object3DComponent } from 'ecsy-three'\nimport { TILE_SIZE } from '../../3d/constants'\nimport GameWorldSystem from './GameWorldSystem'\n\nexport default class AxialCoordsSystem extends GameWorldSystem {\n  execute (delta: number, time: number): void {\n    this.queries.axialPositions.results.forEach(entity => {\n      const axial = entity.getComponent(AxialCoordsComponent)?.axial\n      const obj3d = entity.getObject3D()\n\n      if (axial === undefined || obj3d === undefined) {\n        return\n      }\n\n      const prevQ = (obj3d.userData.q) as number | undefined\n      const prevR = (obj3d.userData.r) as number | undefined\n\n      if (prevQ !== axial.q && prevR !== axial.r) {\n        const [x, z] = axial.toCartesian(TILE_SIZE).toArray()\n        obj3d.userData.q = axial.q\n        obj3d.userData.r = axial.r\n        obj3d.position.set(x, 0, z)\n        this.gameWorld.sceneHasUpdated = true\n      }\n    })\n  }\n}\n\nAxialCoordsSystem.queries = {\n  axialPositions: {\n    components: [AxialCoordsComponent, Object3DComponent]\n  }\n}\n","import TileComponent from '../components/TileComponent'\nimport { COLOR_VALUES, INACTIVE_COLOR } from '../../3d/constants'\nimport TreeComponent from '../components/TreeComponent'\nimport GameWorldSystem from './GameWorldSystem'\n\nexport default class TileSystem extends GameWorldSystem {\n  execute (delta: number, time: number): void {\n    this.queries.tiles.results.forEach(entity => {\n      const tileComp = entity.getComponent<TileComponent>(TileComponent)\n\n      if (tileComp === undefined || tileComp.material === undefined) {\n        return\n      }\n\n      let newColor: number\n\n      if (tileComp.treeEntity !== undefined) {\n        const treeComp = tileComp.treeEntity.getComponent(TreeComponent)\n\n        if (treeComp === undefined) {\n          return\n        }\n\n        newColor = COLOR_VALUES[treeComp.color]\n      } else {\n        newColor = INACTIVE_COLOR\n      }\n\n      if (newColor !== tileComp.material.color.getHex()) {\n        tileComp.material.color.setHex(newColor)\n        this.gameWorld.sceneHasUpdated = true\n      }\n    })\n  }\n}\n\nTileSystem.queries = {\n  tiles: {\n    components: [TileComponent]\n  }\n}\n","import { Object3DComponent } from 'ecsy-three'\nimport SunOrientationTagComponent from '../components/SunOrientationTagComponent'\nimport GameWorldSystem from './GameWorldSystem'\n\nexport default class SunOrientationSystem extends GameWorldSystem {\n  execute (delta: number, time: number): void {\n    this.queries.sunFacingObjs.results.forEach(entity => {\n      const obj3d = entity.getObject3D()\n      if (obj3d === undefined) {\n        return\n      }\n      obj3d.rotation.y = this.gameWorld.sunOrientationRad\n    })\n  }\n}\n\nSunOrientationSystem.queries = {\n  sunFacingObjs: {\n    components: [SunOrientationTagComponent, Object3DComponent]\n  }\n}\n","import Axial from './Axial'\nimport Coordinates from './Coordinates'\n\nexport default class HexCube implements Coordinates<HexCube> {\n  public x: number\n  public y: number\n  public z: number\n\n  constructor (x: number, y: number, z: number) {\n    this.x = x\n    this.y = y\n    this.z = z\n  }\n\n  public static neighbors: HexCube[] = [\n    new HexCube(+1, -1, 0), new HexCube(+1, 0, -1), new HexCube(0, +1, -1),\n    new HexCube(-1, +1, 0), new HexCube(-1, 0, +1), new HexCube(0, -1, +1)\n  ]\n\n  public static fromArray (a: [number, number, number]): HexCube {\n    return new HexCube(...a)\n  }\n\n  public static fromString (s: string): HexCube {\n    const a = s.split(',').map((i: string) => parseInt(i, 10))\n    return HexCube.fromArray([a[0], a[1], a[2]])\n  }\n\n  public static get origin (): HexCube {\n    return new HexCube(0, 0, 0)\n  }\n\n  public toArray (): [number, number, number] {\n    return [this.x, this.y, this.z]\n  }\n\n  public toString (): string {\n    return this.toArray().join(',')\n  }\n\n  public toAxial (): Axial {\n    return new Axial(this.x, this.z)\n  }\n\n  public add (hexCube: HexCube): HexCube {\n    this.x += hexCube.x\n    this.y += hexCube.y\n    this.z += hexCube.z\n    return this\n  }\n\n  public scale (n: number): HexCube {\n    this.x *= n\n    this.y *= n\n    this.z *= n\n    return this\n  }\n\n  public tileDistance (t: HexCube): number {\n    return (Math.abs(this.x - t.x) + Math.abs(this.y - t.y) + Math.abs(this.z - t.z)) / 2\n  }\n\n  public range (r: number): HexCube[] {\n    const results: HexCube[] = []\n    for (let x = -r; x <= r; x++) {\n      for (let y = Math.max(-r, -x - r); y <= Math.min(r, -x + r); y++) {\n        const z = -x - y\n        results.push(\n          new HexCube(this.x + x, this.y + y, this.z + z)\n        )\n      }\n    }\n    return results\n  }\n}\n","import Coordinates from './Coordinates'\n\nexport default class Cartesian2D implements Coordinates<Cartesian2D> {\n  public x: number\n  public y: number\n\n  constructor (x: number, y: number) {\n    this.x = x\n    this.y = y\n  }\n\n  public static fromArray (a: [number, number]): Cartesian2D {\n    return new Cartesian2D(...a)\n  }\n\n  public static fromString (s: string): Cartesian2D {\n    const a = s.split(',').map((i: string) => parseInt(i, 10))\n    return Cartesian2D.fromArray([a[0], a[1]])\n  }\n\n  public static neighbors: Cartesian2D[] = [\n    new Cartesian2D(-1, -1),\n    new Cartesian2D(0, -1),\n    new Cartesian2D(1, -1),\n    new Cartesian2D(-1, 0),\n    new Cartesian2D(1, 0),\n    new Cartesian2D(-1, 1),\n    new Cartesian2D(0, 1),\n    new Cartesian2D(1, 1)\n  ]\n\n  public static get origin (): Cartesian2D {\n    return new Cartesian2D(0, 0)\n  }\n\n  public toArray (): [number, number] {\n    return [this.x, this.y]\n  }\n\n  public toString (): string {\n    return this.toArray().join(',')\n  }\n\n  public add (coords: Cartesian2D): Cartesian2D {\n    this.x += coords.x\n    this.y += coords.y\n    return this\n  }\n\n  public scale (n: number): Cartesian2D {\n    this.x *= n\n    this.y *= n\n    return this\n  }\n\n  public euclideanDistance (t: Cartesian2D): number {\n    return Math.sqrt((this.x - t.x) ** 2 + (this.y - t.y) ** 2)\n  }\n\n  public manhattanDistance (t: Cartesian2D): number {\n    return this.x - t.x + (this.y - t.y)\n  }\n\n  public added (coord: Cartesian2D): Cartesian2D {\n    const ret = new Cartesian2D(this.x, this.y)\n    return ret.add(coord)\n  }\n\n  public scaled (n: number): Cartesian2D {\n    const ret = new Cartesian2D(this.x, this.y)\n    return ret.scale(n)\n  }\n\n  public norm (): number {\n    return this.euclideanDistance(Cartesian2D.origin)\n  }\n\n  public normalize (): Cartesian2D {\n    return this.scale(1 / this.norm())\n  }\n\n  public normalized (): Cartesian2D {\n    const ret = new Cartesian2D(this.x, this.y)\n    return ret.normalize()\n  }\n\n  public clone (): Cartesian2D {\n    return new Cartesian2D(this.x, this.y)\n  }\n}\n","import HexCube from './HexCube'\nimport Coordinates from './Coordinates'\nimport Cartesian2D from './Cartesian2D'\n\nexport default class Axial implements Coordinates<Axial> {\n  public q: number\n  public r: number\n\n  constructor (q: number, r: number) {\n    this.q = q\n    this.r = r\n  }\n\n  public static neighbors = [\n    new Axial(+1, 0),\n    new Axial(+1, -1),\n    new Axial(0, -1),\n    new Axial(-1, 0),\n    new Axial(-1, +1),\n    new Axial(0, +1)\n  ]\n\n  public static fromArray (a: [number, number]): Axial {\n    return new Axial(...a)\n  }\n\n  public static fromString (s: string): Axial {\n    const a = s.split(',').map((i: string) => parseInt(i, 10))\n    return Axial.fromArray([a[0], a[1]])\n  }\n\n  static get origin (): Axial {\n    return new Axial(0, 0)\n  }\n\n  public toArray (): [number, number] {\n    return [this.q, this.r]\n  }\n\n  public toString (): string {\n    return this.toArray().join(',')\n  }\n\n  public toHexCube (): HexCube {\n    return new HexCube(this.q, -this.q - this.r, this.r)\n  }\n\n  public toCartesian (size: number): Cartesian2D {\n    const x = size * (Math.sqrt(3) * this.q + (Math.sqrt(3) / 2) * this.r)\n    const y = size * ((3 / 2) * this.r)\n    return new Cartesian2D(x, y)\n  }\n\n  public add (axial: Axial): Axial {\n    this.q += axial.q\n    this.r += axial.r\n    return this\n  }\n\n  public scale (n: number): Axial {\n    this.q *= n\n    this.r *= n\n    return this\n  }\n\n  public tileDistance (t: Axial): number {\n    return (\n      (Math.abs(this.q - t.q) +\n        Math.abs(this.q + this.r - t.q - t.r) +\n        Math.abs(this.r - t.r)) /\n      2\n    )\n  }\n\n  public range (r: number): Axial[] {\n    return this.toHexCube().range(r).map((c) => c.toAxial())\n  }\n}\n\nexport { Axial }\n","import GameWorldSystem from './GameWorldSystem'\nimport Hammer from 'hammerjs'\nimport { clamp } from 'ramda'\nimport {\n  CAMERA_FURTHEST_DISTANCE,\n  CAMERA_INITIAL_POSITION,\n  CAMERA_MAX_ZOOM_DISTANCE,\n  CAMERA_MIN_ZOOM_DISTANCE\n} from '../../3d/constants'\n\nexport default class TouchSystem extends GameWorldSystem {\n  hm!: HammerManager\n  panDistances: Array<[number, number]> = []\n  lastPinchDistance = CAMERA_INITIAL_POSITION\n  pinchDistance = CAMERA_INITIAL_POSITION\n\n  private readonly setXY = ({ x, y }: { x: number, y: number }): void => {\n    this.gameWorld.mouseScreenPosition.x = (x / window.innerWidth) * 2 - 1\n    this.gameWorld.mouseScreenPosition.y = -(y / window.innerHeight) * 2 + 1\n\n    this.gameWorld.hasMouseMoved = true\n  }\n\n  private readonly onMouseMove = (event: TouchEvent | MouseEvent): void => {\n    let x, y\n\n    if (event instanceof MouseEvent) {\n      x = event.clientX\n      y = event.clientY\n    } else {\n      x = event.changedTouches[0].pageX\n      y = event.changedTouches[0].pageY\n    }\n\n    this.setXY({ x, y })\n  }\n\n  init (): void {\n    const canvas = this.gameWorld.renderer.domElement\n\n    this.hm = new Hammer(canvas)\n    this.hm.get('pinch').set({\n      enable: true\n    })\n    this.hm.add(new Hammer.Pan({ direction: Hammer.DIRECTION_ALL }))\n    this.hm.on('pan', ({ velocityX, velocityY }) => {\n      this.panDistances.push([velocityX, velocityY])\n    })\n    this.hm.on('tap', ({ center }) => {\n      this.setXY(center)\n      this.gameWorld.willSelectObject = true\n    })\n    this.hm.on('pinch', ({ scale }) => {\n      this.pinchDistance = clamp(CAMERA_MIN_ZOOM_DISTANCE, CAMERA_MAX_ZOOM_DISTANCE, this.lastPinchDistance * scale)\n\n      console.log((1 - scale))\n      console.log(this.pinchDistance)\n      // scale means how much the fingers move from originally laying on the screen\n      this.gameWorld.camera.position.z = CAMERA_FURTHEST_DISTANCE - this.pinchDistance\n    })\n    this.hm.on('pinchend', () => {\n      this.lastPinchDistance = this.pinchDistance\n    })\n\n    canvas.addEventListener('touchmove', this.onMouseMove)\n    canvas.addEventListener('mousemove', this.onMouseMove)\n  }\n\n  dispose (): void {\n    this.hm.destroy()\n  }\n\n  execute (delta: number, time: number): void {\n    let panDistance\n    while ((panDistance = this.panDistances.pop()) !== undefined) {\n      const [hDistance, vDistance] = panDistance\n      this.gameWorld.cameraRotationObj.rotation.y -= hDistance * 0.1\n\n      const newTilt = this.gameWorld.cameraTiltObj.rotation.x - vDistance * 0.05\n      this.gameWorld.cameraTiltObj.rotation.x = Math.max(-Math.PI / 2, Math.min(-0.1, newTilt))\n\n      this.gameWorld.sceneHasUpdated = true\n    }\n  }\n}\n","import { RefPropType, Types } from 'ecsy'\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer'\nimport { WebGLRendererComponent } from 'ecsy-three'\nimport { Camera, Object3D, WebGLRenderer } from 'three'\nimport { OutlinePass } from 'three/examples/jsm/postprocessing/OutlinePass'\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass'\n\nexport default class RendererComposerComponent extends WebGLRendererComponent {\n  composer!: EffectComposer\n  outlinePass!: OutlinePass\n  effectFXAA!: ShaderPass\n\n  static schema: {\n    composer: { type: RefPropType<EffectComposer> }\n    renderer: { type: RefPropType<WebGLRenderer> }\n    scene: { type: RefPropType<Object3D> } // this is wrong, but lib also wrong\n    camera: { type: RefPropType<Camera> } // this is wrong, but lib also wrong\n    outlinePass: { type: RefPropType<OutlinePass> }\n    effectFXAA: { type: RefPropType<ShaderPass>}\n  }\n}\n\nRendererComposerComponent.schema = {\n  composer: { type: Types.Ref as RefPropType<EffectComposer> },\n  renderer: { type: Types.Ref as RefPropType<WebGLRenderer> },\n  scene: { type: Types.Ref as RefPropType<Object3D> }, // this is wrong, but lib also wrong\n  camera: { type: Types.Ref as RefPropType<Camera> }, // this is wrong, but lib also wrong\n  outlinePass: { type: Types.Ref as RefPropType<OutlinePass> },\n  effectFXAA: { type: Types.Ref as RefPropType<ShaderPass> }\n}\n","import { ECSYThreeObject3D, WebGLRendererComponent } from 'ecsy-three'\nimport { Object3D, PerspectiveCamera, Scene, sRGBEncoding, Vector2 } from 'three'\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer'\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass'\nimport { OutlinePass } from 'three/examples/jsm/postprocessing/OutlinePass'\nimport RendererComposerComponent from '../components/RendererComposerComponent'\nimport GameWorldSystem from './GameWorldSystem'\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass'\nimport { FXAAShader } from 'three/examples/jsm/shaders/FXAAShader'\n\nexport class RendererComposerSystem extends GameWorldSystem {\n  private needsResize = true\n  private intersectionCounter = 0\n\n  onResize (): void {\n    this.needsResize = true\n    this.gameWorld.sceneHasUpdated = true\n  }\n\n  init (): void {\n    this.needsResize = true\n    this.onResize = this.onResize.bind(this)\n    window.addEventListener('resize', this.onResize.bind(this), false)\n  }\n\n  dispose (): void {\n    window.removeEventListener('resize', this.onResize.bind(this))\n  }\n\n  execute (delta: number, time: number): void {\n    this.intersectionCounter += delta\n\n    if (!this.gameWorld.sceneHasUpdated) {\n      return\n    }\n    this.gameWorld.sceneHasUpdated = false\n\n    // Change renderers into composerRenderers\n    this.queries.renderers.results.forEach(entity => {\n      const component = entity.getComponent(WebGLRendererComponent)\n      if (component === undefined) {\n        return\n      }\n\n      const camera = component.camera.getObject3D() as PerspectiveCamera | undefined\n      const scene = component.scene.getObject3D() as Scene | undefined\n      const renderer = component.renderer\n\n      if (scene === undefined || camera === undefined) {\n        return\n      }\n\n      const canvas = renderer.domElement\n      const width = canvas.clientWidth\n      const height = canvas.clientHeight\n\n      const composer = new EffectComposer(renderer)\n      composer.renderTarget1.texture.encoding = sRGBEncoding\n      composer.renderTarget2.texture.encoding = sRGBEncoding\n      const renderPass = new RenderPass(scene, camera)\n      composer.addPass(renderPass)\n      const outlinePass = new OutlinePass(new Vector2(width, height), scene, camera)\n      outlinePass.edgeStrength = 10\n      outlinePass.edgeThickness = 2\n      outlinePass.hiddenEdgeColor.set(0xFFFFFF)\n      composer.addPass(outlinePass)\n      const effectFXAA = new ShaderPass(FXAAShader)\n      // eslint-disable-next-line\n      effectFXAA.uniforms['resolution'].value.set(1 / width, 1 / height)\n      composer.addPass(effectFXAA)\n\n      entity.addComponent(RendererComposerComponent, {\n        renderer,\n        scene: component.scene,\n        camera: component.camera,\n        composer,\n        outlinePass,\n        effectFXAA\n      })\n\n      entity.removeComponent(WebGLRendererComponent)\n    })\n\n    this.queries.rendererComposers.results.forEach(entity => {\n      const component = entity.getComponent(RendererComposerComponent)\n      if (component === undefined) {\n        return\n      }\n      const camera = component.camera.getObject3D() as PerspectiveCamera | undefined\n      const scene = component.scene.getObject3D() as Scene | undefined\n      const renderer = component.renderer\n      const composer = component.composer\n      const effectFXAA = component.effectFXAA\n      const outlinePass = component.outlinePass\n\n      if (scene === undefined || camera === undefined) {\n        return\n      }\n\n      if (this.needsResize) {\n        const canvas = renderer.domElement\n\n        const curPixelRatio = renderer.getPixelRatio()\n\n        if (curPixelRatio !== window.devicePixelRatio) {\n          renderer.setPixelRatio(window.devicePixelRatio)\n          composer.setPixelRatio(window.devicePixelRatio)\n        }\n\n        const width = canvas.clientWidth\n        const height = canvas.clientHeight\n\n        camera.aspect = width / height\n        camera.updateProjectionMatrix()\n        renderer.setSize(width, height, false)\n        composer.setSize(width, height)\n        outlinePass.resolution.set(width, height)\n        // eslint-disable-next-line\n        effectFXAA.uniforms['resolution'].value.set(1 / width, 1 / height)\n\n        this.needsResize = false\n      }\n\n      const hoverObject = this.gameWorld.hoverObject\n      const activeObject = this.gameWorld.activeObject\n\n      outlinePass.selectedObjects = [hoverObject, activeObject !== hoverObject ? activeObject : undefined]\n        .filter((x): x is (Object3D & ECSYThreeObject3D) => x !== undefined)\n\n      composer.render()\n    })\n  }\n}\n\nRendererComposerSystem.queries = {\n  renderers: {\n    components: [WebGLRendererComponent],\n    listen: {\n      added: true\n    }\n  },\n  rendererComposers: { components: [RendererComposerComponent] }\n}\n","import GameWorldSystem from './GameWorldSystem'\nimport SelectableComponent from '../components/SelectableComponent'\nimport { ECSYThreeObject3D, Object3DComponent } from 'ecsy-three'\nimport { Object3D, Raycaster } from 'three'\n\nconst isECSYObject3D = (o: Object3D): o is (Object3D & ECSYThreeObject3D) => 'entity' in o\n\nexport default class SelectionSystem extends GameWorldSystem {\n  private static readonly CHECK_PERIOD = 0.05\n  private secondsElapsed = 0\n  private readonly raycaster = new Raycaster()\n\n  execute (delta: number, time: number): void {\n    if (!this.gameWorld.willSelectObject) {\n      if (!this.gameWorld.hasMouseMoved) {\n        return\n      }\n      this.gameWorld.hasMouseMoved = false\n\n      this.secondsElapsed += delta\n      if (this.secondsElapsed >= SelectionSystem.CHECK_PERIOD) {\n        this.secondsElapsed -= SelectionSystem.CHECK_PERIOD\n      } else {\n        return\n      }\n    }\n\n    const selectableEntities = this.queries.selectables.results\n    const selectableObjs = selectableEntities\n      .map(entity => entity.getObject3D<Object3D>())\n      .filter((o?: Object3D & ECSYThreeObject3D): o is (Object3D & ECSYThreeObject3D) => o !== undefined)\n\n    this.raycaster.setFromCamera(this.gameWorld.mouseScreenPosition, this.gameWorld.camera)\n    const intersections = this.raycaster.intersectObjects(selectableObjs, true)\n\n    if (intersections.length > 0) {\n      const intersectedObject = intersections[0].object\n      let parent: Object3D | null = intersectedObject\n      let currentRef: Object3D | null = intersectedObject\n      let willContinueSearch = true\n      do {\n        currentRef = parent\n        parent = currentRef?.parent ?? null\n        if (parent !== null) {\n          if (isECSYObject3D(parent)) {\n            willContinueSearch = parent.entity.getComponent(SelectableComponent) === undefined\n          } else if (currentRef !== parent) {\n            willContinueSearch = true\n          }\n        }\n      } while (willContinueSearch)\n\n      if (currentRef === parent) {\n        console.error('currentRef cannot be parent')\n      } else if (parent === null) {\n        console.error('parent cannot be null')\n      } else if (isECSYObject3D(parent) && this.gameWorld.hoverObject !== parent) {\n        this.gameWorld.hoverObject = parent\n        this.gameWorld.sceneHasUpdated = true\n      }\n    } else if (this.gameWorld.hoverObject !== undefined) {\n      this.gameWorld.hoverObject = undefined\n    }\n\n    if (this.gameWorld.willSelectObject) {\n      this.gameWorld.activeObject = this.gameWorld.hoverObject\n      this.gameWorld.willSelectObject = false\n      this.gameWorld.activeObjectChangeHandlers.forEach(handler => handler())\n    }\n\n    this.gameWorld.sceneHasUpdated = true\n  }\n}\n\nSelectionSystem.queries = {\n  selectables: {\n    components: [SelectableComponent, Object3DComponent]\n  }\n}\n","import GameWorld from '../GameWorld'\nimport { Object3D } from 'three'\nimport TreeComponent from '../components/TreeComponent'\nimport { Color, GrowthStage } from '../../3d/constants'\nimport { Axial } from '../../3d/Coordinates/Axial'\nimport AxialCoordsComponent from '../components/AxialCoordsComponent'\nimport { ECSYThreeEntity } from 'ecsy-three'\nimport TweenComponent from '../components/TweenComponent'\n\nexport interface TreeOptions {\n  color: Color\n  growthStage: GrowthStage\n  axial: Axial\n}\n\nexport const createTree = (gameWorld: GameWorld, { color, growthStage, axial }: TreeOptions): ECSYThreeEntity | undefined => {\n  const tree = new Object3D()\n\n  const tileEntity = gameWorld.tileEntities.get(axial.toString())\n\n  if (tileEntity === undefined) {\n    console.error('Tile not found: ' + axial.toString())\n    return\n  }\n\n  return gameWorld.world\n    .createEntity()\n    .addObject3DComponent(tree, gameWorld.gameEntity)\n    .addComponent(TreeComponent, {\n      color,\n      growthStage\n    })\n    .addComponent(AxialCoordsComponent, {\n      axial\n    })\n    .addComponent(TweenComponent)\n}\n","export default (x: number): number => x < 0.5 ? 2 * x * x : 1 - Math.pow(-2 * x + 2, 2) / 2\n","import { Component, Entity } from 'ecsy'\nimport DelayedAction from '../types/DelayedAction'\n\nexport default class DelayedActionComponent extends Component<DelayedActionComponent> {\n  actions: DelayedAction[] = []\n\n  static setTimeout (entity: Entity, handler: DelayedAction['handler'], timeout: number): void {\n    entity.getComponent(DelayedActionComponent)?.actions.push({\n      handler,\n      timeout\n    })\n  }\n}\n\nDelayedActionComponent.schema = {\n}\n","import DelayedActionComponent from '../components/DelayedActionComponent'\nimport DelayedAction from '../types/DelayedAction'\nimport GameWorldSystem from './GameWorldSystem'\n\nexport default class DelayedActionSystem extends GameWorldSystem {\n  execute (delta: number, time: number): void {\n    this.queries.delayedActions.results.forEach(entity => {\n      const delayedActionComp = entity.getMutableComponent(DelayedActionComponent)\n\n      if (delayedActionComp !== undefined) {\n        const newActions: DelayedAction[] = []\n\n        delayedActionComp.actions.forEach(delayedAction => {\n          delayedAction.timeout = Math.max(0, delayedAction.timeout - delta)\n          if (delayedAction.timeout === 0) {\n            delayedAction.handler(entity)\n            this.gameWorld.sceneHasUpdated = true\n          } else {\n            newActions.push(delayedAction)\n          }\n        })\n\n        delayedActionComp.actions = newActions\n      }\n    })\n  }\n}\n\nDelayedActionSystem.queries = {\n  delayedActions: {\n    components: [DelayedActionComponent]\n  }\n}\n","import { ConnectionManager } from './ConnectionManager'\nimport { ConnectionListenerPayload, ConnEvent } from './ConnectionTypes'\nimport { PkgType } from './PkgType'\nimport { Connection } from './Connection'\nimport { Observable } from './Observable'\nimport { clone, uniq } from 'ramda'\nimport { pause } from './pause'\nimport { NETWORK_STATE_BUSY_ERROR } from './errors/NetworkStateBusyError'\nimport { v4 } from 'uuid'\n\nexport enum StarMeshNetworkEvents {\n  STATE_CHANGE,\n  MEMBERS_CHANGE,\n  MEMBERS_JOIN,\n  MEMBERS_LEFT,\n  NETWORK_ERROR,\n  HOST_CHANGE\n}\n\nexport interface StarMeshEventPayload<T> {\n  state?: T\n  members?: string[]\n  error?: Error\n  host?: string\n}\n\nexport type StarMeshAction = Record<string, unknown>\n\nexport type StarMeshReducer<T, U = never> = (prevState: T, action: U | StarMeshAction, connId: string) => T\n\ninterface MemberChangePayload {\n  members: string[]\n  host?: string\n}\n\nconst isMemberChangePayload = (data: unknown): data is MemberChangePayload => {\n  if (typeof data === 'object' && data !== null) {\n    if ('members' in data && 'host' in data) {\n      const d = data as { members: unknown, host: unknown }\n      return Array.isArray(d.members) && d.members.reduce((p: boolean, c) => p && typeof c === 'string', true)\n    }\n  }\n  return false\n}\n\nexport class StarMeshNetwork<T = Record<string, unknown>> extends Observable<typeof StarMeshNetworkEvents, StarMeshEventPayload<T>> {\n  hostConnectionManager?: ConnectionManager\n  myConnectionManager: ConnectionManager\n  meToHostConnection?: Connection\n  members: string[] = []\n\n  state: T\n  networkName?: string\n\n  reducer?: StarMeshReducer<T>\n  hostId?: string\n  initialState: T\n\n  activeAction?: StarMeshAction\n\n  requestQueue: Array<{ action: StarMeshAction, resolve: () => void, reject: (error: Error) => void }> = []\n  stateStaging?: T\n  stagingActionId?: string\n\n  public get id (): string {\n    return this.myConnectionManager.id\n  }\n\n  constructor (myConnectionManager: ConnectionManager, initialState: T, reducer?: StarMeshReducer<T>) {\n    super()\n    this.reducer = reducer\n    this.initialState = clone(initialState)\n    this.myConnectionManager = myConnectionManager\n    this.initMyConnectionManagerListeners()\n    this.state = clone(initialState)\n  }\n\n  logs: unknown[][] = []\n\n  private log (...params: unknown[]): void {\n    console.log(...params)\n    this.logs.push(params)\n  }\n\n  private readonly networkErrorHandler = (error: Error): void => {\n    this.emit(StarMeshNetworkEvents.NETWORK_ERROR, { error })\n  }\n\n  public isHost (): boolean | undefined {\n    if (this.hostConnectionManager !== undefined) {\n      return true\n    } else if (this.meToHostConnection !== undefined) {\n      return false\n    } else {\n      return undefined\n    }\n  }\n\n  public sendToHost = async (pkgType: PkgType, data: unknown): Promise<ConnectionListenerPayload> => {\n    if (this.meToHostConnection === undefined) {\n      throw new Error('not connected to host')\n    }\n    return await this.myConnectionManager.sendPkg(this.meToHostConnection.id, pkgType, data)\n  }\n\n  public get myId (): string {\n    return this.myConnectionManager.id\n  }\n\n  private readonly initMyConnectionManagerListeners = (): void => {\n    this.myConnectionManager.onPkg(PkgType.MEMBER_CHANGE, ({ data }) => {\n      this.handleMemberChange(data).catch(this.networkErrorHandler)\n    })\n    this.myConnectionManager.onPkg(PkgType.SET_STATE, ({ data }) => {\n      this.emit(StarMeshNetworkEvents.STATE_CHANGE, { state: data as T })\n      this.state = data as T\n    })\n    this.myConnectionManager.onPkg(PkgType.DISPATCH, this.dispatchHandler)\n    this.myConnectionManager.onPkg(PkgType.CANCEL, ({ data }) => {\n      const id = (data as {id: string}).id\n      this.log('cancel staging', id, this.stagingActionId)\n      if (id === this.stagingActionId) {\n        this.stateStaging = undefined\n        this.stagingActionId = undefined\n      }\n    })\n    this.myConnectionManager.onPkg(PkgType.PROMOTE, () => {\n      if (this.stateStaging !== undefined) {\n        this.setState(this.stateStaging)\n        this.stateStaging = undefined\n      } else {\n        throw new Error('promote before staging')\n      }\n    })\n  }\n\n  public async joinOrHost (networkName: string): Promise<void> {\n    this.networkName = networkName\n    try {\n      this.log(`check if network ${networkName} exists, if not, create it`)\n      await this.host(networkName)\n      this.log(`created network ${networkName}`)\n      await this.join(networkName)\n    } catch (e) {\n      this.log(`network ${networkName} exists`)\n      await this.join(networkName)\n    }\n  }\n\n  private readonly host = async (networkName: string): Promise<void> => {\n    this.log(`hosting network ${networkName}`)\n    const hostConnection = await ConnectionManager.startPrefix(networkName)\n    this.log('created hostConnection')\n    const oldHost = this.hostId\n    this.hostId = this.id\n    this.hostConnectionManager = hostConnection\n    this.hostConnectionManager.on(ConnEvent.CONN_OPEN, ({ conn }) => {\n      if (conn !== undefined) {\n        this.log(`${conn.id ?? 'someone'} is joining the network, telling the rest about it and tell new joiner the member list`)\n        this.hostConnectionManager?.broadcastPkg(PkgType.MEMBER_CHANGE, {\n          host: this.hostId,\n          members: [...this.members, conn.id]\n        })\n          .catch(this.networkErrorHandler)\n        conn.sendPkg(PkgType.SET_STATE, clone(this.state)).catch(this.networkErrorHandler)\n      }\n    })\n    this.hostConnectionManager.on(ConnEvent.CONN_CLOSE, ({ conn }) => {\n      this.log(`${conn?.id ?? 'someone'} is leaving the network, telling the rest about it`)\n      this.hostConnectionManager?.broadcastPkg(PkgType.MEMBER_CHANGE, {\n        host: this.id,\n        members: this.members.filter(id => id !== conn?.id)\n      })\n        .catch(this.networkErrorHandler)\n    })\n    // if there are existing members, probably the members were connected to a disconnected host\n    // so update them to use the new host\n    if (this.members.length > 0) {\n      this.log('hostConnection trying to connect to all members and tell them to update member list')\n      const members = this.members.filter(n => n !== oldHost)\n      await Promise.all(members.map(async (id: string): Promise<Connection> => await hostConnection?.connect(id))).catch(console.log)\n      await hostConnection.broadcastPkg(PkgType.MEMBER_CHANGE, {\n        host: this.id,\n        members\n      })\n      this.log('hostConnection connected to all members')\n    }\n  }\n\n  private readonly join = async (networkName: string): Promise<void> => {\n    this.log('joining network ', networkName)\n    this.meToHostConnection = await this.myConnectionManager.connectPrefix(networkName)\n    this.log('connected to network')\n    this.meToHostConnection.on(ConnEvent.CONN_CLOSE, ({ conn }) => {\n      this.log(`lost connection with ${conn?.id ?? 'some peer'}`)\n      if (this.members.length > 1) {\n        if (this.networkName !== undefined && !this.myConnectionManager.isClosed() && this.members.filter(n => n !== this.hostId)[0] === this.id) {\n          this.log('taking over the host role')\n          this.host(this.networkName).catch(this.networkErrorHandler)\n        }\n      }\n    })\n    this.log('waiting for member list')\n    while (this.members.length === 0) {\n      await pause(100)\n    }\n    this.log('received member list, connecting to other members')\n    while (!this.members.reduce((flag: boolean, member) => flag && undefined !== this.myConnectionManager.connections.find(({ id }) => id === member), true)) {\n      await pause(100)\n    }\n    this.log('all members connected')\n  }\n\n  private readonly handleMemberChange = async (data: unknown): Promise<void> => {\n    if (isMemberChangePayload(data)) {\n      this.emit(StarMeshNetworkEvents.HOST_CHANGE, { host: data.host })\n      if (data.members.length === this.members.length && this.members.reduce((f: boolean, c) => f && data.members.includes(c), true)) {\n        return\n      }\n      this.hostId = data.host\n      const oldList = [...this.members]\n      const newList = data.members\n      this.members = [...newList]\n      // connect to new member\n      const memberJoining = newList.filter(n => !oldList.includes(n))\n      const memberLeaving = oldList.filter(n => !newList.includes(n))\n      try {\n        await Promise.all(memberJoining.map(async n => {\n          return await this.myConnectionManager.connect(n)\n        }))\n        // disconnect leave member\n        memberLeaving.forEach(n => {\n          this.myConnectionManager.disconnect(n)\n        })\n      } catch (e) {\n        this.emit(StarMeshNetworkEvents.NETWORK_ERROR, e)\n        console.log(e)\n      }\n      if (memberJoining.length > 0 || memberLeaving.length > 0) {\n        this.emit(StarMeshNetworkEvents.MEMBERS_CHANGE, { members: this.members })\n      }\n      if (memberJoining.length > 0) {\n        this.emit(StarMeshNetworkEvents.MEMBERS_JOIN, { members: memberJoining })\n      }\n      if (memberLeaving.length > 0) {\n        this.emit(StarMeshNetworkEvents.MEMBERS_LEFT, { members: memberLeaving })\n      }\n    } else {\n      throw new Error('wrong member change payload')\n    }\n  }\n\n  public setReducer = (reducer: StarMeshReducer<T>): void => {\n    this.reducer = reducer\n  }\n\n  public dispatch = async (action: StarMeshAction): Promise<void> => {\n    this.log('dispatch', action)\n    const queueThisAction = async (): Promise<void> => await new Promise((resolve, reject) => {\n      this.requestQueue.push({ action, resolve, reject })\n    })\n    if (this.activeAction !== undefined) {\n      return await queueThisAction()\n    }\n    const actionId = v4()\n    this.activeAction = action\n    const responses = await Promise.all(this.members.map(async (id) => await this.myConnectionManager.sendPkg(id, PkgType.DISPATCH, { ...action, actionId })))\n    let gotBusyError = false\n    const gotValidationErrors: string[] = []\n    responses.forEach(({ data, conn }) => {\n      if (data !== undefined && data !== true) {\n        if (typeof data === 'string') {\n          this.log(`${conn?.id ?? 'someone'} response error ${data}`)\n          if (data === NETWORK_STATE_BUSY_ERROR) {\n            gotBusyError = true\n          } else {\n            gotValidationErrors.push(data)\n          }\n        }\n      }\n    })\n    let error\n    let promise = Promise.resolve()\n    if (gotValidationErrors.length > 0) {\n      this.activeAction = undefined\n      await Promise.all(this.members.map(async (id) => await this.myConnectionManager.sendPkg(id, PkgType.CANCEL, { id: actionId })))\n      const filtered = uniq(gotValidationErrors)\n      if (filtered.length === 1) {\n        error = new Error(filtered[0])\n      } else {\n        error = new Error(`Multiple Errors: ${filtered.join(',')}`)\n      }\n    } else if (gotBusyError) {\n      this.activeAction = undefined\n      await Promise.all(this.members.map(async (id) => await this.myConnectionManager.sendPkg(id, PkgType.CANCEL, { id: actionId })))\n      promise = pause(500).then(async () => await this.dispatch(action))\n    } else {\n      await Promise.all(this.members.map(async (id) => await this.myConnectionManager.sendPkg(id, PkgType.PROMOTE, {})))\n      this.activeAction = undefined\n    }\n    {\n      const { action, resolve, reject } = this.requestQueue.shift() ?? {}\n      if (action !== undefined && resolve !== undefined && reject !== undefined) {\n        this.dispatch(action).then(resolve).catch(reject)\n      }\n    }\n    if (error !== undefined) {\n      return await Promise.reject(error)\n    }\n    return await promise\n  }\n\n  public dispatchLocal = async (action: StarMeshAction): Promise<void> => {\n    if (this.reducer === undefined) {\n      this.emit(StarMeshNetworkEvents.NETWORK_ERROR, { error: new Error('no reducer defined') })\n      throw new Error('no reducer defined')\n    }\n    const newState = this.reducer(this.state, action, this.id)\n    this.setState(newState)\n    return await Promise.resolve()\n  }\n\n  private readonly dispatchHandler = ({ conn, data, ack }: ConnectionListenerPayload): void => {\n    if (this.reducer === undefined) {\n      this.emit(StarMeshNetworkEvents.NETWORK_ERROR, { error: new Error('no reducer defined') })\n      ack?.('no reducer defined')\n    } else if (conn === undefined) {\n      this.emit(StarMeshNetworkEvents.NETWORK_ERROR, { error: new Error('no conn') })\n      ack?.('no conn')\n    } else {\n      if (this.stateStaging !== undefined) {\n        ack?.(NETWORK_STATE_BUSY_ERROR)\n      } else {\n        try {\n          const action = data as StarMeshAction\n          this.stateStaging = this.reducer(this.state, action, conn.id)\n          this.stagingActionId = action.actionId as string\n          ack?.(true)\n        } catch (e: unknown) {\n          ack?.((e as Error).message)\n        }\n      }\n    }\n  }\n\n  private readonly setState = (newState: T): void => {\n    this.state = newState\n    this.emit(StarMeshNetworkEvents.STATE_CHANGE, { state: newState })\n  }\n\n  public leave = (): void => {\n    this.networkName = undefined\n    this.hostConnectionManager?.destroy()\n    this.meToHostConnection?.close()\n    this.emit(StarMeshNetworkEvents.MEMBERS_LEFT, { members: this.members })\n    this.emit(StarMeshNetworkEvents.MEMBERS_CHANGE, { members: [] })\n    this.meToHostConnection = undefined\n    this.hostConnectionManager = undefined\n    this.state = clone(this.initialState)\n    this.members = []\n    this.hostId = undefined\n  }\n}\n","import { ECSYThreeEntity, ECSYThreeObject3D, ECSYThreeWorld, initialize, WebGLRendererSystem } from 'ecsy-three'\nimport {\n  AmbientLight,\n  Clock,\n  DirectionalLight,\n  Group,\n  Mesh,\n  MeshStandardMaterial,\n  Object3D,\n  PerspectiveCamera,\n  sRGBEncoding,\n  Vector2,\n  Vector3,\n  VSMShadowMap,\n  WebGLRenderer\n} from 'three'\nimport TreeSystem from './systems/TreeSystem'\nimport TweenSystem from './systems/TweenSystem'\nimport { disposeObj3D } from '../3d/helpers'\nimport TreeComponent from './components/TreeComponent'\nimport TweenComponent from './components/TweenComponent'\nimport AxialCoordsComponent from './components/AxialCoordsComponent'\nimport {\n  AMBIENT_COLOR, CAMERA_INITIAL_POSITION,\n  INITIAL_SUN_ORIENTATION,\n  MODELS,\n  SKY_COLOR,\n  SUN_ANGLE,\n  SUN_COLOR, SUN_ROTATION_DURATION,\n  SUN_SEGMENT_POSITION_Y,\n  SUN_SEGMENT_POSITION_Z,\n  TAU,\n  TILE_SIZE,\n  TREE_GROWTH_DURATION\n} from '../3d/constants'\nimport { getObject } from '../3d/assets'\nimport TileComponent from './components/TileComponent'\nimport AxialCoordsSystem from './systems/AxialCoordsSystem'\nimport TileSystem from './systems/TileSystem'\nimport SunOrientationTagComponent from './components/SunOrientationTagComponent'\nimport SunOrientationSystem from './systems/SunOrientationSystem'\nimport dat from 'dat.gui'\nimport { Axial } from '../3d/Coordinates/Axial'\nimport { LEAF_CIRCLES, sunSegmentMesh } from '../3d/extraObjects'\nimport Stats from 'stats.js'\nimport GameWorldMessages from './types/GameWorldMessages'\nimport { TileInfo } from './types/TileInfo'\nimport TouchSystem from './systems/TouchSystem'\nimport { RendererComposerSystem } from './systems/RendererComposerSystem'\nimport RendererComposerComponent from './components/RendererComposerComponent'\nimport SelectableComponent from './components/SelectableComponent'\nimport SelectionSystem from './systems/SelectionSystem'\nimport { createTree } from './entities/tree'\nimport TweenObjectProperties from './types/TweenObjectProperties'\nimport { applyNumber, applyVector3 } from './easing/applyEasing'\nimport jelly from './easing/3d/jelly'\nimport TweenTargetComponent from './components/TweenTargetComponent'\nimport { Entity } from 'ecsy'\nimport easeInOut from './easing/1d/easeInOut'\nimport DelayedActionComponent from './components/DelayedActionComponent'\nimport DelayedActionSystem from './systems/DelayedActionSystem'\n\nexport default class GameWorld {\n  gui: dat.GUI\n  stats: Stats\n\n  hasStarted = false\n  messages: Record<string, unknown[]> = {}\n\n  world: ECSYThreeWorld\n  renderer: WebGLRenderer\n\n  camera!: PerspectiveCamera\n  cameraTiltObj!: Object3D\n  cameraRotationObj!: Object3D\n\n  sunOrientationRad = INITIAL_SUN_ORIENTATION\n\n  sceneEntity!: ECSYThreeEntity\n  gameEntity!: ECSYThreeEntity\n  tileEntities: Map<string, ECSYThreeEntity> = new Map<string, ECSYThreeEntity>()\n  sunManagerEntity!: Entity\n\n  // ray casting selections\n  mouseScreenPosition = new Vector2()\n  hasMouseMoved = false\n  willSelectObject = false\n  activeObject?: Object3D & ECSYThreeObject3D\n  hoverObject?: Object3D & ECSYThreeObject3D\n\n  sceneHasUpdated = false\n\n  activeObjectChangeHandlers: Array<() => void> = []\n\n  constructor () {\n    this.stats = new Stats()\n    this.gui = new dat.GUI()\n    this.renderer = new WebGLRenderer({ antialias: true })\n    this.world = new ECSYThreeWorld({ entityPoolSize: 1000 })\n    document.body.appendChild(this.stats.dom)\n    window.addEventListener('load', () => {\n      this.init()\n    })\n  }\n\n  public dispose (): void {\n    this.destroyGUI()\n    this.world.stop()\n    this.tileEntities.clear()\n    disposeObj3D(this.sceneEntity?.getObject3D())\n    this.sunOrientationRad = 0\n    this.hasStarted = false\n    this.activeObjectChangeHandlers.splice(0)\n    console.log('end')\n  }\n\n  public init (): void {\n    if (this.hasStarted) return\n    console.log('start')\n    this.hasStarted = true\n\n    this.initGUI()\n\n    const clock = new Clock()\n    const {\n      camera,\n      sceneEntity\n    } = initialize(this.world, {\n      renderer: this.renderer,\n      animationLoop: () => {\n        this.stats.begin()\n        this.world.execute(clock.getDelta(), clock.elapsedTime)\n        this.stats.end()\n      }\n    })\n    this.camera = camera\n    this.sceneEntity = sceneEntity\n\n    this.initRenderer()\n    this.initECS()\n    this.initScene()\n\n    this.sunManagerEntity = this.world\n      .createEntity('sunManager')\n      .addComponent(TweenTargetComponent, { ref: this })\n      .addComponent(TweenComponent)\n\n    Promise.all(Object.values(MODELS).map(getObject)).then(() => {\n      this.sceneHasUpdated = true\n    }).catch(console.error)\n\n    this.world.play()\n  }\n\n  private destroyGUI (): void {\n    this.gui.destroy()\n    this.gui = new dat.GUI()\n  }\n\n  private initGUI (): void {\n    // const sunControl = this.gui.add(this, 'sunOrientationRad', 0, 2 * Math.PI)\n    // sunControl.name('Sun orientation')\n    // sunControl.step(0.01)\n  }\n\n  private initECS (): void {\n    this.world.registerComponent(TreeComponent)\n    this.world.registerComponent(TweenComponent)\n    this.world.registerComponent(AxialCoordsComponent)\n    this.world.registerComponent(TileComponent)\n    this.world.registerComponent(SunOrientationTagComponent)\n    this.world.registerComponent(RendererComposerComponent)\n    this.world.registerComponent(SelectableComponent)\n    this.world.registerComponent(TweenTargetComponent)\n    this.world.registerComponent(DelayedActionComponent)\n\n    this.world.unregisterSystem(WebGLRendererSystem)\n    this.world.registerSystem(RendererComposerSystem, { priority: 999, gameWorld: this })\n\n    this.world.registerSystem(DelayedActionSystem, { gameWorld: this })\n    this.world.registerSystem(AxialCoordsSystem, { gameWorld: this })\n    this.world.registerSystem(TileSystem, { gameWorld: this })\n    this.world.registerSystem(TreeSystem, { gameWorld: this })\n    this.world.registerSystem(TweenSystem, { gameWorld: this })\n    this.world.registerSystem(SunOrientationSystem, { gameWorld: this })\n    this.world.registerSystem(TouchSystem, { gameWorld: this })\n    this.world.registerSystem(SelectionSystem, { gameWorld: this })\n  }\n\n  private initRenderer (): void {\n    this.renderer.shadowMap.enabled = true\n    this.renderer.shadowMap.type = VSMShadowMap\n    this.renderer.setClearColor(SKY_COLOR)\n    this.renderer.outputEncoding = sRGBEncoding\n  }\n\n  private initScene (): void {\n    this.camera.position.set(0, 0, CAMERA_INITIAL_POSITION)\n    this.camera.fov = 40\n\n    this.sceneEntity.getObject3D()?.remove(this.camera)\n\n    const cameraTiltObj = new Object3D()\n    cameraTiltObj.name = 'cameraTilt'\n    cameraTiltObj.rotation.x = -0.4\n    cameraTiltObj.add(this.camera)\n    this.cameraTiltObj = cameraTiltObj\n\n    const cameraRotationObj = new Object3D()\n    cameraRotationObj.name = 'cameraRotation'\n    cameraRotationObj.add(cameraTiltObj)\n    this.cameraRotationObj = cameraRotationObj\n\n    const cameraFolder = this.gui.addFolder('Camera')\n\n    cameraFolder.add(this.camera.position, 'z', 20, 300, 1).name('zoom')\n    // cameraFolder.add(cameraTiltObj.rotation, 'x', -Math.PI / 2, 0, 0.01).name('tilt')\n    // cameraFolder.add(cameraRotationObj.rotation, 'y', 0, TAU, 0.01).name('rotation')\n    cameraFolder.open()\n\n    this.world.createEntity()\n      .addObject3DComponent(cameraRotationObj, this.sceneEntity)\n\n    const ambientLight = new AmbientLight(AMBIENT_COLOR, 0.5)\n    const sun = new DirectionalLight(SUN_COLOR, 1.2)\n    sun.position.set(0, Math.sin(SUN_ANGLE) * 150, 150)\n    sun.castShadow = true\n    sun.shadow.camera.visible = true\n    sun.shadow.bias = -0.001\n    sun.shadow.radius = 2\n    sun.shadow.camera.near = 50\n    sun.shadow.camera.far = 300\n    sun.shadow.camera.top = -100\n    sun.shadow.camera.bottom = 50\n    sun.shadow.camera.left = -100\n    sun.shadow.camera.right = 100\n    sun.shadow.mapSize.set(2 ** 9, 2 ** 9)\n    const sunContainer = new Group()\n    sunContainer.name = 'sun'\n    sunContainer.add(sun)\n\n    const sky = new DirectionalLight(0xFFFFFF, 0.2)\n    sky.name = 'sky'\n    sky.position.y = 100\n    // sky.castShadow = true\n    // sky.shadow.bias = -0.001\n    // sky.shadow.radius = 128\n    // sky.shadow.camera.near = 10\n    // sky.shadow.camera.far = 150\n    // sky.shadow.camera.top = -30\n    // sky.shadow.camera.bottom = 30\n    // sky.shadow.camera.left = -30\n    // sky.shadow.camera.right = 30\n    // sky.shadow.mapSize.set(2 ** 13, 2 ** 13)\n\n    const commonLights = new Group()\n    commonLights.name = 'commonLights'\n    commonLights.add(ambientLight, sky)\n\n    const floorObj = new Object3D()\n    getObject(MODELS.LANDSCAPE).then(obj => floorObj.add(obj.clone())).catch(console.error)\n    floorObj.name = 'floor'\n\n    this.world\n      .createEntity()\n      .addObject3DComponent(floorObj, this.sceneEntity)\n\n    this.world\n      .createEntity()\n      .addObject3DComponent(commonLights, this.sceneEntity)\n\n    this.world\n      .createEntity()\n      .addObject3DComponent(sunContainer, this.sceneEntity)\n      .addComponent(SunOrientationTagComponent)\n\n    const game = new Group()\n    game.name = 'Game'\n\n    this.gameEntity = this.world\n      .createEntity()\n      .addObject3DComponent(game, this.sceneEntity)\n      .addComponent(DelayedActionComponent)\n\n    this.generateGrid()\n\n    const sunSegmentWrapperObj = new Object3D()\n    sunSegmentWrapperObj.name = 'sunSegmentWrapper'\n    const sunSegmentObj = new Object3D()\n    sunSegmentObj.name = 'sugSegment'\n    sunSegmentObj.position.y = SUN_SEGMENT_POSITION_Y\n    sunSegmentObj.position.z = SUN_SEGMENT_POSITION_Z\n    sunSegmentObj.rotation.y = Math.PI\n    sunSegmentObj.add(sunSegmentMesh)\n    sunSegmentWrapperObj.add(sunSegmentObj)\n\n    this.world\n      .createEntity('sunSegment')\n      .addObject3DComponent(sunSegmentWrapperObj, this.gameEntity)\n      .addComponent(SunOrientationTagComponent)\n  }\n\n  private generateGrid (): void {\n    const boardObj = new Object3D()\n    boardObj.name = 'gameBoard'\n\n    const boardEntity = this.world\n      .createEntity()\n      .addObject3DComponent(boardObj, this.gameEntity)\n\n    Axial.origin.range(3).forEach(axial => {\n      const tileContainer = new Group()\n      tileContainer.name = 'tileContainer-' + axial.toString()\n      const tileEntity = this.world\n        .createEntity()\n        .addObject3DComponent(tileContainer, boardEntity)\n        .addComponent(AxialCoordsComponent, { axial })\n        .addComponent(TileComponent)\n      tileEntity\n        .addComponent(SelectableComponent, { refEntity: tileEntity })\n      this.tileEntities.set(axial.toString(), tileEntity)\n    })\n\n    getObject(MODELS.RING)\n      .then(ring => {\n        this.tileEntities.forEach(entity => {\n          const ringContainerObj = new Object3D()\n          ringContainerObj.name = 'ringContainer'\n          const ringClone = ring.clone()\n          const mesh = ringClone.children.find((o): o is Mesh => o instanceof Mesh)\n          // Assuming material exists and is a MeshStandardMaterial\n          const originalMaterial = mesh?.material\n          const axialComp = entity.getComponent(AxialCoordsComponent)\n          if (mesh !== undefined && originalMaterial instanceof MeshStandardMaterial && axialComp !== undefined) {\n            const material = originalMaterial.clone()\n            mesh.material = material\n            const axial = axialComp.axial\n            mesh.material.name = 'tileRing-' + axial.toString()\n            const tileComp = entity.getMutableComponent(TileComponent)\n            if (tileComp !== undefined) {\n              tileComp.material = material\n            }\n            const distFromOrigin = axial.tileDistance(Axial.origin)\n            const leafObj = LEAF_CIRCLES[3 - distFromOrigin].clone()\n            if (distFromOrigin > 0) {\n              const cartesian = axial.toCartesian(TILE_SIZE)\n              const atan = Math.atan(cartesian.x / cartesian.y)\n              leafObj.rotation.y = cartesian.y < 0 ? atan : (atan + Math.PI)\n            }\n            ringContainerObj.add(ringClone, leafObj)\n            entity.getObject3D()?.add(ringContainerObj)\n          } else {\n            console.error('Cannot find standard material inside ring object')\n          }\n          this.sceneHasUpdated = true\n        })\n      })\n      .catch(console.error)\n  }\n\n  /**\n   * Send and receive messages between main game logic and ECS\n   * @param target Recipient\n   * @param message Message to recipient\n   */\n  public send (target: GameWorldMessages, message: unknown): void {\n    const queue = this.messages[target] ?? []\n\n    if (this.messages[target] === undefined) {\n      this.messages[target] = queue\n    }\n\n    queue.push(message)\n  }\n\n  /**\n   * Set the display at the tile, may\n   * remove it if color or growStage is undefined\n   * create a new tree if that location dont have tree\n   * grow the tree if that location have tree\n   * @param axial\n   * @param color\n   * @param growthStage\n   */\n  public setTile (axial: Axial, { color, growthStage }: Partial<TileInfo> = {}): void {\n    const treeEntity = this.tileEntities.get(axial.toString())?.getComponent(TileComponent)?.treeEntity\n    const treeComponent = treeEntity?.getMutableComponent(TreeComponent)\n    if (treeComponent !== undefined) {\n      if (growthStage !== undefined) {\n        treeComponent.growthStage = growthStage\n      } else if (treeEntity !== undefined) {\n        this.removeTree(axial)\n      }\n    } else {\n      if (color !== undefined && growthStage !== undefined) {\n        createTree(this, { color, growthStage, axial })\n      }\n    }\n  }\n\n  public setRayDirection (directionType: number): void {\n    // rotate clock-wise\n    const from = this.sunOrientationRad % TAU\n    const to = Math.floor(from / TAU) * TAU + (INITIAL_SUN_ORIENTATION + directionType * Math.PI / 3) % TAU\n    const realTo = to > from ? to - TAU : to\n    console.log(from, realTo)\n    this.sunManagerEntity\n      .getComponent<TweenComponent<TweenObjectProperties<GameWorld, 'sunOrientationRad'>>>(TweenComponent)?.tweens\n      .push({\n        duration: SUN_ROTATION_DURATION,\n        from,\n        func: applyNumber(easeInOut),\n        loop: 1,\n        prop: 'sunOrientationRad',\n        to: realTo,\n        value: 0\n      })\n  }\n\n  public getActiveEntity (): ECSYThreeEntity | undefined {\n    return this.activeObject?.entity?.getComponent(SelectableComponent)?.refEntity\n  }\n\n  public getActiveAxial (): Axial | undefined {\n    return this.getActiveEntity()?.getComponent(AxialCoordsComponent)?.axial\n  }\n\n  public resetBoard (): void {\n    Axial.origin.range(3).forEach(axial => {\n      this.removeTree(axial)\n    })\n    this.setRayDirection(0)\n  }\n\n  public onActiveObjectChange (handler: () => void): void {\n    this.activeObjectChangeHandlers.push(handler)\n  }\n\n  private removeTree (axial: Axial): void {\n    // animate tree removal\n    const linkedTileComponent = this.tileEntities.get(axial.toString())?.getMutableComponent(TileComponent)\n    const treeEntity = linkedTileComponent?.treeEntity\n    if (treeEntity !== undefined) {\n      treeEntity\n        .getComponent<TweenComponent<TweenObjectProperties<Object3D, 'scale'>>>(TweenComponent)\n        ?.tweens\n        ?.push({\n          duration: TREE_GROWTH_DURATION,\n          from: new Vector3(1, 1, 1),\n          func: applyVector3(jelly),\n          loop: 1,\n          prop: 'scale',\n          to: new Vector3(0, 0, 0),\n          value: 0\n        })\n      DelayedActionComponent.setTimeout(\n        this.gameEntity,\n        () => {\n          treeEntity.remove()\n          if (linkedTileComponent !== undefined) {\n            linkedTileComponent.treeEntity = undefined\n          }\n        },\n        TREE_GROWTH_DURATION\n      )\n    }\n  }\n}\n","export const pause = async (timeout: number): Promise<void> => await new Promise(resolve => {\n  setTimeout(() => {\n    resolve()\n  }, timeout)\n})\n","export const NETWORK_STATE_BUSY_ERROR = 'NetworkStateBusyError'\n\nexport class NetworkStateBusyError extends Error {\n  type = NETWORK_STATE_BUSY_ERROR\n}\n","import { Room, RoomActionTypes } from '../lib/Room'\nimport { Observable } from '../lib/Observable'\nimport GameWorld from './GameWorld'\nimport { StarMeshAction, StarMeshNetworkEvents, StarMeshReducer } from '../lib/StarMeshNetwork'\nimport { GameState } from './types/GameState'\nimport { getInitialState } from './getInitialState'\nimport { Axial } from '../3d/Coordinates/Axial'\nimport { ACTION_COST_GROW, ACTION_COST_PURCHASE, ACTION_COST_SEED, Color, GrowthStage } from '../3d/constants'\nimport { TileInfo } from './types/TileInfo'\nimport { clone } from 'ramda'\nimport { isTreeGrowthStage } from './isTreeGrowthStage'\n\nexport enum GameEvent {\n  UPDATE_GAME_STATE,\n  GAME_OVER,\n  ACTIVE_OBJECT_CHANGED\n}\n\nexport enum GameActions {\n  GROW_TREE,\n  END_TURN,\n  PLANT_SEED,\n  PURCHASE,\n}\n\nexport type Coords = [number, number]\n\nexport interface GameEventPayload {\n  data: unknown\n}\n\nexport class Game extends Observable<typeof GameEvent, GameEventPayload> {\n  room: Room\n  gameWorld = new GameWorld()\n\n  public get started (): boolean {\n    return this.room.started\n  }\n\n  public get state (): GameState | undefined {\n    return this.room.network.state.game\n  }\n\n  public static initialState (players: number): GameState {\n    return getInitialState(players)\n  }\n\n  public get me (): string {\n    return this.room.p(this.room.myId)\n  }\n\n  public get mi (): Color {\n    return Number.parseInt(this.me)\n  }\n\n  public get nPlayers (): number {\n    return this.room.playerIds.length\n  }\n\n  constructor (room: Room) {\n    super()\n    this.room = room\n    this.room.network.on(StarMeshNetworkEvents.STATE_CHANGE, ({ state }) => {\n      this.emit(GameEvent.UPDATE_GAME_STATE, { data: state?.game })\n    })\n    this.gameWorld.onActiveObjectChange(() => {\n      this.emit(GameEvent.ACTIVE_OBJECT_CHANGED, { data: { activeAxial: this.gameWorld.getActiveAxial() } })\n    })\n  }\n\n  public start (_gameState: GameState): void {\n    this.gameWorld.resetBoard()\n  }\n\n  public rejoin (gameState: GameState): void {\n    Object.entries(gameState.board).forEach(([axialString, tileInfo]) => {\n      if (tileInfo.color !== undefined && tileInfo.growthStage !== undefined) {\n        this.setTile(gameState, Axial.fromString(axialString), tileInfo)\n      }\n    })\n    this.setRayDirection(gameState, gameState.rayDirection)\n  }\n\n  public stop (payload: unknown): void {\n    this.emit(GameEvent.GAME_OVER, { data: payload })\n  }\n\n  public async endTurn (): Promise<void> {\n    return await this.dispatch({\n      action: GameActions.END_TURN,\n      payload: []\n    })\n  }\n\n  public endTurnHandler (gameState: GameState, _playerId: number): GameState {\n    gameState.turn++\n    gameState.dirtyTiles = []\n    if (gameState.turn === this.nPlayers) {\n      if (gameState.preparingRound > 0) {\n        gameState.preparingRound--\n        if (gameState.preparingRound === 0) {\n          gameState.rayDirection = 1\n          gameState.revolutionLeft++\n        }\n      }\n      if (gameState.preparingRound === 0) {\n        gameState.rayDirection = (gameState.rayDirection + 5) % 6\n        if (gameState.rayDirection === 0) {\n          gameState.rayDirection = 0\n          gameState.revolutionLeft--\n        }\n        gameState = this.setRayDirection(gameState, gameState.rayDirection)\n      }\n      gameState.turn = 0\n      if (gameState.revolutionLeft <= 0) {\n        return this.endGameCalculation(gameState)\n      }\n      if (gameState.preparingRound === 0) {\n        gameState = this.photosynthesis(gameState)\n      }\n    }\n    return gameState\n  }\n\n  public photosynthesis (gameState: GameState): GameState {\n    const shadows: { [axial: string]: GrowthStage } = {}\n    const direction: number = gameState.rayDirection\n    Object.entries(gameState.board).forEach(([axialString, tile]) => {\n      if (isTreeGrowthStage(tile.growthStage)) {\n        let axial = Axial.fromString(axialString)\n        for (let distance = 0; distance < tile.growthStage; distance++) {\n          axial = axial.add(Axial.neighbors[direction])\n          shadows[axial.toString()] = Math.max(shadows[axial.toString()] ?? 0, tile.growthStage)\n        }\n      }\n    })\n    Object.entries(gameState.board).forEach(([axialString, tile]) => {\n      if (isTreeGrowthStage(tile.growthStage)) {\n        if (tile.color !== undefined && tile.growthStage > (shadows[axialString] ?? 0)) {\n          gameState.playerInfo[tile.color].lightPoint += tile.growthStage as number\n          gameState.playerInfo[tile.color].lightPoint = Math.min(gameState.playerInfo[tile.color].lightPoint, 20)\n        }\n      }\n    })\n    return gameState\n  }\n\n  public endGameCalculation (gameState: GameState): GameState {\n    let winningsPlayerIds: string[] = []\n    let winningScore = 0\n    gameState.playerInfo.forEach((info, id) => {\n      info.score += Math.floor(info.lightPoint / 3)\n      info.lightPoint = 0\n      if (info.score > winningScore) {\n        winningScore = info.score\n        winningsPlayerIds = [id.toString()]\n      } else if (info.score === winningScore) {\n        winningsPlayerIds.push(id.toString())\n      }\n    })\n    gameState.gameOver = `${winningsPlayerIds.map(i => this.room.whoami(i)).join(', ')} ${winningsPlayerIds.length === 1 ? 'wins' : 'win'}`\n    return { ...gameState }\n  }\n\n  public async growTree (axial: Axial): Promise<void> {\n    return await this.dispatch({\n      action: GameActions.GROW_TREE,\n      payload: axial.toString()\n    })\n  }\n\n  public growTreeHandler (gameState: GameState, playerId: number, axial: Axial): GameState {\n    if (!(axial.toString() in gameState.board)) {\n      throw new Error(`${axial.toString()} is not in game board`)\n    }\n    if (gameState.dirtyTiles.includes(axial.toString())) {\n      throw new Error('Cannot act on same tile twice')\n    }\n    if (gameState.preparingRound > 0) {\n      if (gameState.board[axial.toString()].growthStage !== undefined) {\n        throw new Error('Already occupied')\n      }\n      if (gameState.board[axial.toString()].leaves !== 1) {\n        throw new Error('First round can only grow tree on tile with 1 leaf')\n      }\n      --gameState.playerInfo[playerId].availableArea[GrowthStage.SHORT]\n      gameState = this.setTile(gameState, axial, { color: playerId, growthStage: GrowthStage.SHORT })\n      gameState = this.endTurnHandler(gameState, playerId)\n    } else {\n      if (gameState.board[axial.toString()].color !== playerId) {\n        throw new Error('You can only grow trees that belong to you')\n      }\n\n      const existingStage = gameState.board[axial.toString()].growthStage\n      if (existingStage === undefined) {\n        throw new Error('Please use growSeed method to plant a seed')\n      }\n\n      if (gameState.playerInfo[playerId].lightPoint < ACTION_COST_GROW[existingStage]) {\n        throw new Error(`Not enough light point, needed ${ACTION_COST_GROW[existingStage]}, but only have ${gameState.playerInfo[playerId].lightPoint}`)\n      }\n      if (existingStage !== GrowthStage.TALL && gameState.playerInfo[playerId].availableArea[existingStage + 1 as GrowthStage] <= 0) {\n        throw new Error(`Not enough ${GrowthStage[existingStage + 1]}, you need to buy it with light points before growing`)\n      }\n      gameState.playerInfo[playerId].lightPoint -= ACTION_COST_GROW[existingStage]\n      if (existingStage === GrowthStage.TALL) {\n        gameState = this.resetTile(gameState, axial)\n        gameState = this.returnTree(gameState, playerId, GrowthStage.TALL)\n        gameState = this.obtainToken(gameState, playerId, axial)\n      } else {\n        gameState.playerInfo[playerId].availableArea[existingStage + 1 as GrowthStage]--\n        gameState = this.setTile(gameState, axial, { color: playerId, growthStage: existingStage + 1 })\n        gameState = this.returnTree(gameState, playerId, existingStage)\n      }\n      gameState.dirtyTiles.push(axial.toString())\n    }\n    return gameState\n  }\n\n  public async plantSeed (source: Axial, target: Axial): Promise<void> {\n    return await this.dispatch({\n      action: GameActions.PLANT_SEED,\n      payload: [source.toString(), target.toString()]\n    })\n  }\n\n  public plantSeedHandler (gameState: GameState, playerId: number, source: Axial, target: Axial): GameState {\n    if (!(source.toString() in gameState.board)) {\n      throw new Error(`${source.toString()} is not in game board`)\n    }\n    if (!(target.toString() in gameState.board)) {\n      throw new Error(`${target.toString()} is not in game board`)\n    }\n    if (gameState.preparingRound > 0) {\n      throw new Error('Cannot plant seed at preparing round')\n    }\n    if (gameState.playerInfo[playerId].availableArea[GrowthStage.SEED] <= 0) {\n      throw new Error('Not enough available seed, you need to use light point to purchase more')\n    }\n    if (gameState.dirtyTiles.includes(source.toString()) || gameState.dirtyTiles.includes(target.toString())) {\n      throw new Error('Cannot act on same tile twice')\n    }\n    const tileInfo: TileInfo = gameState.board[source.toString()]\n    if (!isTreeGrowthStage(tileInfo.growthStage)) {\n      throw new Error('Source tile needed to be a tree')\n    }\n    if (tileInfo.color !== playerId) {\n      throw new Error('Cannot use other\\'s tree as source')\n    }\n    if (source.tileDistance(target) > tileInfo.growthStage) {\n      throw new Error('Seed is too far from tree')\n    }\n    if (gameState.playerInfo[playerId].lightPoint < ACTION_COST_SEED) {\n      throw new Error(`Need ${ACTION_COST_SEED} light points, but only got ${gameState.playerInfo[playerId].lightPoint}`)\n    }\n    gameState.dirtyTiles.push(source.toString(), target.toString())\n    gameState.playerInfo[playerId].lightPoint -= ACTION_COST_SEED\n    gameState.playerInfo[playerId].availableArea[GrowthStage.SEED]--\n    gameState = this.setTile(gameState, target, { color: playerId, growthStage: GrowthStage.SEED })\n    return gameState\n  }\n\n  public async purchase (stage: GrowthStage): Promise<void> {\n    return await this.dispatch({\n      action: GameActions.PURCHASE,\n      payload: stage\n    })\n  }\n\n  public haveSlot (gameState: GameState, playerId: number, stage: GrowthStage): boolean {\n    return gameState.playerInfo[playerId].playerBoard[stage].reduce((flag, current) => flag || !current, false)\n  }\n\n  public static nextPurchase (gameState: GameState, playerId: number, stage: GrowthStage): { cost: number, purchaseIndex: number } {\n    let purchaseIndex: number\n    for (purchaseIndex = 0; purchaseIndex < gameState.playerInfo[playerId].playerBoard[stage].length; purchaseIndex++) {\n      if (gameState.playerInfo[playerId].playerBoard[stage][purchaseIndex]) {\n        break\n      }\n    }\n    return {\n      purchaseIndex,\n      cost: ACTION_COST_PURCHASE[stage][purchaseIndex]\n    }\n  }\n\n  public purchaseHandler (gameState: GameState, playerId: number, stage: GrowthStage): GameState {\n    if (gameState.preparingRound > 0) {\n      throw new Error('Cannot purchase at preparing round')\n    }\n    const { purchaseIndex, cost } = Game.nextPurchase(gameState, playerId, stage)\n    if (gameState.playerInfo[playerId].lightPoint < cost) {\n      throw new Error(`Not enough light point to purchase ${GrowthStage[stage]}, ${cost.toString()} needed but only have ${gameState.playerInfo[playerId].lightPoint}`)\n    }\n    gameState.playerInfo[playerId].lightPoint -= cost\n    gameState.playerInfo[playerId].playerBoard[stage][purchaseIndex] = false\n    gameState.playerInfo[playerId].availableArea[stage]++\n    return gameState\n  }\n\n  public dispatch = async (action: StarMeshAction): Promise<void> => {\n    if (this.mi !== this.state?.turn) {\n      throw new Error('not your turn')\n    }\n    await this.room.network.dispatch({\n      action: RoomActionTypes.GAME_EVENT,\n      payload: action\n    })\n  }\n\n  public errorHandler = (e: Error): void => {\n    console.log(e)\n  }\n\n  public reducer: StarMeshReducer<GameState> = (prevState, { action, payload }, connId) => {\n    const playerId = this.room.pi(connId)\n    if (prevState.turn !== playerId) {\n      throw new Error('not your turn')\n    }\n    const gameState = clone(prevState)\n    switch (action) {\n      case GameActions.END_TURN: {\n        return this.endTurnHandler(gameState, playerId)\n      }\n      case GameActions.GROW_TREE: {\n        if (typeof payload !== 'string') {\n          throw new Error('invalid payload')\n        }\n        const axial = Axial.fromString(payload)\n        return this.growTreeHandler(gameState, playerId, axial)\n      }\n      case GameActions.PLANT_SEED: {\n        if (!(Array.isArray(payload) && payload.length === 2 && typeof payload[0] === 'string' && typeof payload[1] === 'string')) {\n          throw new Error('invalid payload')\n        }\n        const source = Axial.fromString(payload[0])\n        const target = Axial.fromString(payload[1])\n        return this.plantSeedHandler(gameState, playerId, source, target)\n      }\n      case GameActions.PURCHASE: {\n        if (typeof payload !== 'number') {\n          throw new Error('invalid payload')\n        }\n        const stage = payload as GrowthStage\n        return this.purchaseHandler(gameState, playerId, stage)\n      }\n    }\n    return prevState\n  }\n\n  public setTile (gameState: GameState, axial: Axial, tileInfo: Partial<TileInfo>): GameState {\n    gameState.board[axial.toString()].growthStage = tileInfo.growthStage\n    gameState.board[axial.toString()].color = tileInfo.color\n    this.gameWorld.setTile(axial, tileInfo)\n    return gameState\n  }\n\n  private resetTile (gameState: GameState, axial: Axial): GameState {\n    gameState.board[axial.toString()].color = undefined\n    gameState.board[axial.toString()].growthStage = undefined\n    this.gameWorld.setTile(axial)\n    return gameState\n  }\n\n  private returnTree (gameState: GameState, playerId: number, stage: GrowthStage): GameState {\n    for (let i = 0; i < gameState.playerInfo[playerId].playerBoard[stage].length; i++) {\n      if (!gameState.playerInfo[playerId].playerBoard[stage][i]) {\n        gameState.playerInfo[playerId].playerBoard[stage][i] = true\n        break\n      }\n    }\n    return gameState\n  }\n\n  public nextToken (gameState: GameState, axial: Axial): { leaves: number, score: number } {\n    for (let leaves = gameState.board[axial.toString()].leaves; leaves >= 1; leaves--) {\n      const scoreToken = gameState.scoreTokens[leaves]\n      const score = scoreToken[0]\n      if (score !== undefined) {\n        return {\n          leaves,\n          score\n        }\n      }\n    }\n    return {\n      leaves: 0, score: 0\n    }\n  }\n\n  private obtainToken (gameState: GameState, playerId: number, axial: Axial): GameState {\n    const { leaves } = this.nextToken(gameState, axial)\n    const amount = gameState.scoreTokens[leaves].shift()\n    gameState.playerInfo[playerId].score += amount ?? 0\n    return gameState\n  }\n\n  private setRayDirection (gameState: GameState, rayDirection: number): GameState {\n    gameState.rayDirection = rayDirection\n    this.gameWorld.setRayDirection(rayDirection)\n    return gameState\n  }\n}\n","import { clone } from 'ramda'\nimport { Color, GrowthStage } from '../3d/constants'\nimport { PlayerInfo } from './types/PlayerInfo'\nimport { GameState } from './types/GameState'\nimport { TileMap } from './types/TileMap'\nimport HexCube from '../3d/Coordinates/HexCube'\n\nconst getInitialPlayerInfo = (color: Color): PlayerInfo => clone({\n  lightPoint: 0,\n  score: 0,\n  color,\n  availableArea: {\n    [GrowthStage.SEED]: 2,\n    [GrowthStage.SHORT]: 4,\n    [GrowthStage.MID]: 1,\n    [GrowthStage.TALL]: 0\n  },\n  playerBoard: {\n    [GrowthStage.SEED]: [true, true, true, true],\n    [GrowthStage.SHORT]: [true, true, true, true],\n    [GrowthStage.MID]: [true, true, true],\n    [GrowthStage.TALL]: [true, true]\n  }\n})\n\nconst getInitialBoard = (): TileMap => {\n  const map: TileMap = {}\n  new HexCube(0, 0, 0).range(3).forEach(hexCube => {\n    const i = hexCube.tileDistance(HexCube.origin)\n    map[hexCube.toAxial().toString()] = {\n      leaves: 4 - i as 1 | 2 | 3 | 4\n    }\n  })\n  return map\n}\n\nexport const getInitialState = (players: number): GameState => {\n  const state: GameState = {\n    preparingRound: 2,\n    dirtyTiles: [],\n    turn: 0,\n    rayDirection: 0,\n    totalRevolutions: 3,\n    revolutionLeft: 3,\n    board: getInitialBoard(),\n    scoreTokens: {\n      1: [14, 14, 13, 13, 13, 12, 12, 12, 12],\n      2: [17, 16, 16, 14, 14, 13, 13, 13],\n      3: [19, 18, 18, 17, 17],\n      4: [22, 21, 20]\n    },\n    playerInfo: [],\n    photosynthesisHints: []\n  }\n  for (let id = 0; id < players; id++) {\n    state.playerInfo[id] = getInitialPlayerInfo(id)\n  }\n  if (players === 2) {\n    state.scoreTokens[4] = []\n  }\n  return state\n}\n","import { GrowthStage } from '../3d/constants'\n\nexport const isTreeGrowthStage = (stage: GrowthStage | undefined): stage is (GrowthStage.SHORT | GrowthStage.MID | GrowthStage.TALL) => {\n  return stage !== undefined && [GrowthStage.SHORT, GrowthStage.MID, GrowthStage.TALL].includes(stage)\n}\n","import { ConnectionManager } from './ConnectionManager'\nimport { Observable } from './Observable'\nimport { Game } from '../Game/Game'\nimport { StarMeshEventPayload, StarMeshNetwork, StarMeshNetworkEvents, StarMeshReducer } from './StarMeshNetwork'\nimport { clone } from 'ramda'\nimport { GameState } from '../Game/types/GameState'\n\nconst CH = 'ABCDEFGHJKLMNOPQRSTUVWXYZ'\n\nconst generateRoomCode = (): string => {\n  return [0, 0, 0, 0].map(() => CH[Math.floor(Math.random() * CH.length)]).join('')\n}\n\nexport enum RoomActionTypes {\n  JOIN,\n  LEAVE,\n  RENAME,\n  START_GAME,\n  END_GAME,\n  GAME_EVENT,\n}\n\nexport enum RoomEvents {\n  SET_PLAYERS,\n  SET_HOST,\n  START_GAME,\n  ERROR,\n  END_GAME,\n  LEAVE_ROOM,\n}\n\nexport interface RoomEventPayload {\n  data: unknown\n}\n\nexport interface PlayersDict {\n  [id: string]: string\n}\n\nexport interface RoomState {\n  players: PlayersDict\n  minPlayers: number\n  maxPlayers: number\n  game?: GameState\n  idDict?: PlayersDict\n  nameDict?: PlayersDict\n}\n\nconst initialState = Object.freeze({\n  maxPlayers: 4,\n  minPlayers: 2,\n  players: {}\n})\n\nexport class Room extends Observable<typeof RoomEvents, RoomEventPayload> {\n  network: StarMeshNetwork<RoomState>\n  manager: ConnectionManager\n  game: Game\n\n  public get state (): RoomState {\n    return this.network.state\n  }\n\n  public get hostPlayerId (): string | undefined {\n    return this.network.hostId\n  }\n\n  public get roomCode (): string | undefined {\n    return this.network.networkName\n  }\n\n  public get myId (): string {\n    return this.network.id\n  }\n\n  public get players (): PlayersDict {\n    return this.state.players\n  }\n\n  public get playerIds (): string[] {\n    return Object.keys(this.players)\n  }\n\n  /**\n   * given peerjs id return in game player id or\n   * given in game player id return peerjs id\n   * @param id\n   */\n  public p (id: string | number): string {\n    if (this.state.idDict === undefined) {\n      console.trace('Game not started yet')\n      throw new Error('Game not started yet')\n    }\n    return this.state.idDict[id]\n  }\n\n  /**\n   * given conn id return in game player id in integer\n   * @param id\n   */\n  public pi (id: string): number {\n    if (this.state.idDict === undefined) {\n      console.trace('Game not started yet')\n      throw new Error('Game not started yet')\n    }\n    return Number.parseInt(this.state.idDict[id])\n  }\n\n  /**\n   *  given name, return in game player id\n   * @param name\n   */\n  public n (name: string): string {\n    if (this.state.nameDict === undefined) {\n      console.trace('Game not started yet')\n      throw new Error('Game not started yet')\n    }\n    return this.state.nameDict[name]\n  }\n\n  /**\n   * Given game player id, return name\n   * @param id\n   */\n  public whoami (id: string): string {\n    if (this.state.idDict === undefined) {\n      console.trace('Game not started yet')\n      throw new Error('Game not started yet')\n    }\n    const idDictElement = this.state.idDict[id]\n    if (idDictElement === undefined) {\n      throw new Error(`Id ${id} not in game`)\n    }\n    return this.state.players[idDictElement]\n  }\n\n  public get started (): boolean {\n    return this.state.game !== undefined && this.state.game.gameOver === undefined\n  }\n\n  public static getName (roomState: RoomState, id: number): string {\n    if (roomState.idDict !== undefined && roomState.players !== undefined) {\n      return roomState.players[roomState.idDict[id]]\n    } else {\n      return ''\n    }\n  }\n\n  constructor (manager?: ConnectionManager) {\n    super()\n    this.manager = manager ?? new ConnectionManager()\n    this.network = new StarMeshNetwork<RoomState>(this.manager, clone(initialState), this.networkReducer)\n    this.network.on(StarMeshNetworkEvents.MEMBERS_LEFT, ({ members }) => {\n      if (members !== undefined) {\n        members.forEach(id => {\n          this.network.dispatchLocal({\n            action: RoomActionTypes.LEAVE,\n            payload: id\n          }).catch(this.errorHandler)\n        })\n      }\n    })\n    this.network.on(StarMeshNetworkEvents.HOST_CHANGE, ({ host }) => {\n      if (host !== undefined) {\n        this.emit(RoomEvents.SET_HOST, { data: host })\n      }\n    })\n    this.game = new Game(this)\n  }\n\n  public create = async (myName: string, roomCode?: string): Promise<string> => {\n    const code = roomCode === undefined || roomCode === '' ? generateRoomCode() : roomCode\n    await this.join(myName, code)\n    return code\n  }\n\n  public join = async (myName: string, roomCode: string): Promise<void> => {\n    if (roomCode === '') {\n      throw new Error('Room name is required')\n    }\n    console.log(`joining ${roomCode}`)\n    await this.network.joinOrHost(roomCode)\n    await this.network.dispatch({\n      action: RoomActionTypes.JOIN,\n      payload: myName\n    }).catch(e => {\n      this.leaveRoom()\n      throw e\n    })\n  }\n\n  public joinOrCreate = this.join\n\n  private readonly errorHandler = ({ error }: StarMeshEventPayload<RoomState>): void => {\n    console.log(error)\n    this.emit(RoomEvents.ERROR, { data: error })\n  }\n\n  public rename = async (name: string): Promise<void> => {\n    return await this.network.dispatch({\n      action: RoomActionTypes.RENAME,\n      payload: name\n    })\n  }\n\n  public leaveRoom = (): void => {\n    this.network.leave()\n    this.emit(RoomEvents.SET_HOST, { data: undefined })\n    this.emit(RoomEvents.LEAVE_ROOM, { data: undefined })\n  }\n\n  public startGame = async (): Promise<void> => {\n    const idDict: PlayersDict = {}\n    const nameDict: PlayersDict = {}\n    Object.entries(this.players).forEach(([id, name], k) => {\n      idDict[id] = k.toString()\n      idDict[k] = id\n      nameDict[name] = k.toString()\n    })\n    return await this.network.dispatch({\n      action: RoomActionTypes.START_GAME,\n      payload: {\n        idDict,\n        nameDict\n      }\n    })\n  }\n\n  public endGame = async (message: string): Promise<void> => {\n    return await this.network.dispatch({\n      action: RoomActionTypes.END_GAME,\n      payload: message\n    })\n  }\n\n  private readonly networkReducer: StarMeshReducer<RoomState> = (prevState, { action, payload }, connId) => {\n    const setName = (): void => {\n      if (typeof payload !== 'string') throw new Error('Invalid payload')\n      if (this.started) {\n        if (this.n(payload) === undefined) {\n          throw new Error(`Room '${this.roomCode ?? ''}' has started game`)\n        } else if (prevState.idDict !== undefined && prevState.nameDict !== undefined) {\n          const pid = this.n(payload)\n          prevState.idDict[connId] = pid\n          prevState.idDict[pid] = connId\n          prevState.nameDict[payload] = pid\n        }\n      }\n      if (Object.values(prevState.players).includes(payload)) {\n        throw new Error(`Name '${payload}' already taken`)\n      }\n      prevState.players = { ...prevState.players, [connId]: payload }\n      this.emit(RoomEvents.SET_PLAYERS, {\n        data: {\n          ...prevState.players\n        }\n      })\n      if (prevState.game !== undefined) {\n        this.game.rejoin(prevState.game)\n      }\n    }\n    switch (action) {\n      case RoomActionTypes.JOIN:\n        if (Object.keys(prevState.players).length + 1 > prevState.maxPlayers) {\n          throw new Error(`Room '${this.roomCode ?? ''}' is already full`)\n        }\n        setName()\n        return { ...prevState }\n      case RoomActionTypes.RENAME:\n        setName()\n        return { ...prevState }\n      case RoomActionTypes.LEAVE: {\n        const { [payload as string]: u, ...players } = this.players\n        prevState.players = players\n        this.emit(RoomEvents.SET_PLAYERS, {\n          data: {\n            ...prevState.players\n          }\n        })\n        return { ...prevState }\n      }\n      case RoomActionTypes.START_GAME: {\n        if (this.playerIds.length < this.state.minPlayers) {\n          throw new Error('Not enough players, required 2')\n        }\n        const typed = payload as { idDict: PlayersDict, nameDict: PlayersDict }\n        prevState.game = Game.initialState(this.playerIds.length)\n        prevState.idDict = clone(typed.idDict)\n        prevState.nameDict = clone(typed.nameDict)\n        this.game?.start(prevState.game)\n        this.emit(RoomEvents.START_GAME, { data: this.game })\n        return { ...prevState }\n      }\n      case RoomActionTypes.END_GAME: {\n        prevState.idDict = undefined\n        prevState.nameDict = undefined\n        if (prevState.game !== undefined) {\n          prevState.game.gameOver = payload as string\n        }\n        this.game.stop(payload)\n        this.emit(RoomEvents.END_GAME, { data: payload })\n        return { ...prevState }\n      }\n      case RoomActionTypes.GAME_EVENT: {\n        if (this.started && prevState.game !== undefined) {\n          if (prevState.game.gameOver !== undefined) {\n            throw new Error('Game over')\n          }\n          try {\n            prevState.game = this.game?.reducer(prevState.game, payload as Record<string, unknown>, connId)\n          } catch (e) {\n            console.trace(e)\n            throw e\n          }\n          return { ...prevState }\n        } else {\n          throw new Error('Game not started')\n        }\n      }\n    }\n    return prevState\n  }\n}\n","import { createContext, useContext } from 'react'\nimport { Room } from './Room'\n\nexport const globalRoom = new Room()\nexport const RoomContext = createContext(globalRoom)\nexport const useRoom = (): Room => useContext(RoomContext)\n","import React, { FunctionComponent } from 'react'\nimport { Box } from '@theme-ui/components'\nimport PropTypes, { InferProps } from 'prop-types'\n\nconst propTypes = {\n  sx: PropTypes.object\n}\n\nexport const Card: FunctionComponent<InferProps<typeof propTypes>> = (props) => (\n  <Box\n    {...props}\n    sx={{\n      py: 4, px: 5, backgroundColor: 'background', boxShadow: 2, borderRadius: 3, ...props.sx\n    }}\n  />\n)\n\nCard.propTypes = propTypes\n","import React, { FunctionComponent, useEffect, useState } from 'react'\nimport { Flex, Heading, Text } from '@theme-ui/components'\nimport Input from './common/Input'\nimport PropTypes from 'prop-types'\nimport Button from './common/Button'\nimport Well from './common/Well'\nimport { useRoom } from '../lib/RoomContext'\nimport { AppState } from './App'\nimport { Card } from './common/Card'\n\nconst propTypes = {\n  setState: PropTypes.func.isRequired\n}\n\nexport const Home: FunctionComponent<PropTypes.InferProps<typeof propTypes>> = ({ setState }) => {\n  const room = useRoom()\n  const [name, setName] = useState('')\n  const [roomCode, setRoomCode] = useState(window.location.hash.substring(2))\n  const [error, setError] = useState('')\n  const [message, setMessage] = useState('')\n  const [loading, setLoading] = useState(false)\n  const pushRoomCodeToHistory = (roomCode?: string): void => {\n    let title = 'Photosynthesis'\n    if (roomCode !== undefined) {\n      title = `${roomCode} - Photosynthesis`\n    }\n    window.history.pushState({\n      roomCode: roomCode\n    }, title, `#/${roomCode ?? ''}`)\n    window.document.title = title\n  }\n  const createRoom = (): void => {\n    setMessage('Creating Room...')\n    setLoading(true)\n    room.create(name, roomCode)\n      .then(() => {\n        setError('')\n        setState(AppState.ROOM)\n        pushRoomCodeToHistory(room.roomCode)\n      })\n      .catch((e: { type: string }) => {\n        if (e.type === 'unavailable-id') {\n          setError(`Room ${roomCode} already exists`)\n        } else {\n          setError('Error when creating room')\n        }\n        console.error(e)\n      })\n      .finally(() => {\n        setMessage('')\n        setLoading(false)\n      })\n  }\n  const joinRoom = (): void => {\n    setMessage('Joining Room...')\n    setLoading(true)\n    room.join(name, roomCode)\n      .then(() => {\n        setError('')\n        pushRoomCodeToHistory(roomCode)\n        if (room.started) {\n          setState(AppState.GAME)\n        } else {\n          setState(AppState.ROOM)\n        }\n      })\n      .catch((e: Error) => {\n        setError(e.message)\n        console.error(e)\n      })\n      .finally(() => {\n        setMessage('')\n        setLoading(false)\n      })\n  }\n  useEffect(() => {\n    const listener = ({ state }: { state?: { roomCode: string } }): void => {\n      setRoomCode(state?.roomCode ?? '')\n      if (state === null || state?.roomCode === '') {\n        setState(AppState.HOME)\n      }\n    }\n    window.addEventListener('popstate', listener)\n    window.history.replaceState({ roomCode: window.location.hash.substring(2) }, 'Photosynthesis')\n    return () => {\n      window.removeEventListener('popstate', listener)\n    }\n  }, [setState])\n  return (\n    <Card>\n      <Flex sx={{ flexDirection: 'column' }}>\n        <Heading>Welcome to Photosynthesis</Heading>\n        {\n          error !== '' && (\n            <Well variant='danger'>{error}</Well>\n          )\n        }\n        <Input\n          fullwidth={true}\n          disabled={loading}\n          label='Name'\n          onChange={({ target }) => setName?.((target as HTMLInputElement).value)}\n          value={name}\n        />\n        <Input\n          fullwidth={true}\n          disabled={loading}\n          label='Room'\n          onChange={({ target }) => setRoomCode?.((target as HTMLInputElement).value.toUpperCase())}\n          value={roomCode}\n        />\n        <Flex mt={3}>\n          <Button sx={{ flex: 1 }} disabled={loading || name === ''} variant='warning' onClick={createRoom}>\n            New Room\n          </Button>\n          <Button\n            sx={{ flex: 1 }}\n            disabled={loading || name === '' || roomCode === ''}\n            ml={3}\n            variant='primary'\n            onClick={joinRoom}>\n            Join Room\n          </Button>\n        </Flex>\n        <Text>{message}</Text>\n      </Flex>\n    </Card>\n  )\n}\n\nHome.propTypes = propTypes\n","import React, { FunctionComponent } from 'react'\nimport { Flex, Text, FlexProps } from '@theme-ui/components'\nimport PropTypes, { InferProps } from 'prop-types'\nimport Icon from './Icon'\n\nconst iconTextProps = {\n  path: PropTypes.string.isRequired,\n  children: PropTypes.node.isRequired,\n  size: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.oneOfType([\n      PropTypes.number,\n      PropTypes.string\n    ])),\n    PropTypes.number,\n    PropTypes.string\n  ]),\n  color: PropTypes.any,\n  reverse: PropTypes.bool,\n  iconMargin: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.oneOfType([\n      PropTypes.number,\n      PropTypes.string\n    ])),\n    PropTypes.number,\n    PropTypes.string\n  ])\n}\n\nexport interface IconTextProps extends InferProps<typeof iconTextProps> {\n  color?: string | ((x: unknown) => string) | null\n}\n\nconst IconText: FunctionComponent<IconTextProps & FlexProps> = ({\n  children,\n  color,\n  path,\n  size,\n  reverse = false,\n  iconMargin = 2,\n  ...otherProps\n}) => {\n  const reverse_ = reverse ?? false\n  return (\n    <Flex sx={{ alignItems: 'center', flexDirection: reverse_ ? 'row-reverse' : 'row' }} {...otherProps}>\n      <Icon\n        size={size}\n        path={path}\n        color={color}\n        sx={{\n          fillOpacity: color === 'transparent' ? 0 : 1,\n          path: {\n            fill: color\n          }\n        }}\n      />\n      {' '}\n      <Text\n        sx={{\n          flex: 1,\n          color,\n          fontSize: size,\n          [reverse_ ? 'mr' : 'ml']: iconMargin\n        }}>\n        {children}\n      </Text>\n    </Flex>\n  )\n}\n\nIconText.propTypes = iconTextProps\n\nIconText.defaultProps = {\n  reverse: false\n}\n\nexport default IconText\n","import { useThemeUI } from '@theme-ui/core'\nimport Modal from 'react-modal'\nimport PropTypes from 'prop-types'\nimport { Box } from '@theme-ui/components'\nimport { shortTransition } from '../../theme/transitions'\n\nconst Dialog = props => {\n  const { theme } = useThemeUI()\n\n  return (\n    <Modal\n      ariaHideApp={false}\n      isOpen={props.isOpen}\n      onRequestClose={() => !props.isStatic && props.onClose()}\n      contentLabel={props.contentLabel}\n      style={{\n        overlay: {\n          backgroundColor: 'fgPales.0',\n          zIndex: 200,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          padding: theme.space[2],\n          overflowY: 'auto'\n        }\n      }}\n      sx={{\n        minWidth: ['100%', '250px'],\n        maxWidth: typeof props.size === 'number' && theme.breakpoints[props.size],\n        outline: 'none',\n        opacity: 0,\n        margin: 'auto',\n        fontFamily: 'body',\n        lineHeight: 'body',\n        ...shortTransition(['opacity']),\n        '&.ReactModal__Content--after-open': {\n          opacity: 1\n        },\n        '&.ReactModal__Content--before-close': {\n          opacity: 0\n        }\n      }}>\n      <Box\n        {...props}\n        sx={{\n          backgroundColor: 'bgs.1',\n          boxShadow: 2,\n          borderRadius: 1\n        }}\n      />\n    </Modal>\n  )\n}\n\nDialog.propTypes = {\n  isOpen: PropTypes.bool.isRequired,\n  onClose: PropTypes.func,\n  contentLabel: PropTypes.string,\n  setIsOpen: PropTypes.func,\n  isStatic: PropTypes.bool,\n  size: PropTypes.number\n}\n\nDialog.defaultProps = {\n  size: 0\n}\n\nexport default Dialog\n","import Dialog from './Dialog'\nimport { Box, Flex, Heading, Text } from '@theme-ui/components'\nimport Button from './Button'\nimport PropTypes from 'prop-types'\nimport { always } from 'ramda'\n\nconst ConfirmDialog = props => {\n  const close = typeof props.onClose === 'function'\n    ? props.onClose\n    : always(undefined)\n  const action = typeof props.onAction === 'function'\n    ? props.onAction\n    : always(undefined)\n  const run = x => () => {\n    close()\n    action(x)\n  }\n  return (\n    <Dialog\n      isStatic\n      {...{\n        isOpen: props.isOpen,\n        onClose: run(false),\n        contentLabel: props.contentLabel,\n        setIsOpen: props.setIsOpen,\n        size: props.size\n      }}>\n      <Box p={[4, 3]} pb={2}>\n        <Heading variant='subheading'>{props.title}</Heading>\n        <Text>{props.children}</Text>\n      </Box>\n      <Flex\n        p={[3, 2]}\n        sx={{\n          alignItems: 'center',\n          justifyContent: 'flex-end'\n        }}>\n        {!props.hideNoChoice && <Button onClick={run(false)}>{props.noText}</Button>}\n        <Button variant='primary' ml={2} onClick={run(true)}>{props.yesText}</Button>\n      </Flex>\n    </Dialog>\n  )\n}\n\nConfirmDialog.propTypes = {\n  isOpen: PropTypes.bool.isRequired,\n  onClose: PropTypes.func,\n  onAction: PropTypes.func,\n  contentLabel: PropTypes.string,\n  setIsOpen: PropTypes.func,\n  noText: PropTypes.string,\n  yesText: PropTypes.string,\n  children: PropTypes.node.isRequired,\n  title: PropTypes.string,\n  hideNoChoice: PropTypes.bool,\n  size: PropTypes.number\n}\n\nConfirmDialog.defaultProps = {\n  noText: 'No',\n  yesText: 'Yes',\n  title: 'Confirm',\n  hideNoChoice: false\n}\n\nexport default ConfirmDialog\n","import React, { FunctionComponent } from 'react'\nimport ConfirmDialog from './ConfirmDialog'\nimport PropTypes from 'prop-types'\n\nconst propTypes = {\n  isOpen: PropTypes.bool.isRequired,\n  onClose: PropTypes.func,\n  contentLabel: PropTypes.string,\n  setIsOpen: PropTypes.func,\n  yesText: PropTypes.string,\n  children: PropTypes.node.isRequired,\n  title: PropTypes.string,\n  size: PropTypes.number\n}\n\nconst AlertDialog: FunctionComponent<PropTypes.InferProps<typeof propTypes>> = props => (\n  <ConfirmDialog {...props} hideNoChoice>{props.children}</ConfirmDialog>\n)\nAlertDialog.propTypes = propTypes\n\nAlertDialog.defaultProps = {\n  title: 'Alert',\n  yesText: 'OK'\n}\n\nexport default AlertDialog\n","import React, { Context, createContext, FunctionComponent, useContext, useState } from 'react'\nimport AlertDialog from './AlertDialog'\n\nexport interface AlertMessage {\n  title: string\n  message: string | Element\n}\n\nexport type AlertFunction = (s: string | AlertMessage) => void\n\nexport const withAlertQueue = (WrappedComponent: FunctionComponent): FunctionComponent => {\n  const AlertWrapper: FunctionComponent = props => {\n    const [queue, setQueue] = useState<AlertMessage[]>([])\n\n    const popAlert = (): void => {\n      setQueue(queue.slice(1))\n    }\n\n    const queueAlert: AlertFunction = (s: string | AlertMessage): void => {\n      const message: AlertMessage = typeof s === 'string' ? { title: 'Alert', message: s } : s\n      setQueue(queue.concat([message]))\n    }\n\n    const alertNodes = queue.map((message, i) => (\n      <AlertDialog key={i} isOpen={i === 0} title={message.title} onClose={popAlert}>\n        {message.message}\n      </AlertDialog>\n    ))\n\n    return (\n      <AlertContext.Provider value={queueAlert}>\n        <WrappedComponent {...props}/>\n        {alertNodes}\n      </AlertContext.Provider>\n    )\n  }\n\n  return AlertWrapper\n}\n\nexport const useAlert = (): AlertFunction => useContext(AlertContext)\nexport const AlertContext: Context<AlertFunction> = createContext<AlertFunction>(window.alert)\nAlertContext.displayName = 'AlertContext'\n","import React, { FunctionComponent, useEffect, useState } from 'react'\nimport { Divider, Flex, Heading } from '@theme-ui/components'\nimport Input from './common/Input'\nimport PropTypes from 'prop-types'\nimport Button from './common/Button'\nimport { useRoom } from '../lib/RoomContext'\nimport { PlayersDict, RoomEvents } from '../lib/Room'\nimport IconText from './common/IconText'\nimport { mdiAccount, mdiCrown } from '@mdi/js'\nimport { AppState } from './App'\nimport { Game } from '../Game/Game'\nimport { useAlert } from './common/AlertContext'\nimport { Card } from './common/Card'\n\nconst propTypes = {\n  setState: PropTypes.func.isRequired\n}\n\nexport const Room: FunctionComponent<PropTypes.InferProps<typeof propTypes>> = ({ setState }) => {\n  const room = useRoom()\n  const [players, setPlayers] = useState<PlayersDict>({})\n  const [host, setHost] = useState('')\n  const alert = useAlert()\n  const name = players[room.myId] ?? ''\n  const rename = room.rename\n  useEffect(() => {\n    const id1 = room.on(RoomEvents.SET_PLAYERS, ({ data }) => setPlayers(data as PlayersDict))\n    const id2 = room.on(RoomEvents.SET_HOST, ({ data }) => setHost(data as string))\n    const id3 = room.on(RoomEvents.START_GAME, ({ data: game }) => {\n      setState(AppState.GAME, game as Game)\n    })\n    const id4 = room.on(RoomEvents.LEAVE_ROOM, () => {\n      setState(AppState.HOME)\n    })\n    return () => {\n      room.off(RoomEvents.SET_PLAYERS, id1)\n      room.off(RoomEvents.SET_HOST, id2)\n      room.off(RoomEvents.START_GAME, id3)\n      room.off(RoomEvents.LEAVE_ROOM, id4)\n    }\n  }, [room, setState])\n  const startGame = (): void => {\n    room?.startGame().catch((e: Error) => {\n      console.log(e)\n      alert(e.message)\n    })\n  }\n  return (\n    <Card>\n      <Flex sx={{ flexDirection: 'column' }}>\n        <Heading>{room.roomCode}</Heading>\n        <Input\n          label='My Name'\n          value={name}\n          onChange={async ({ target }: InputEvent) => {\n            await rename((target as HTMLInputElement)?.value ?? '')\n          }}\n        />\n        <Divider my={3}/>\n        <Flex sx={{ flexDirection: 'column' }}>\n          {\n            Object.entries(players).map(([id, name]) => (\n              id === host\n                ? <IconText key={id} path={mdiCrown}>{name}{id === room.myId && ' (me)'}</IconText>\n                : <IconText key={id} path={mdiAccount}>{name}{id === room.myId && ' (me)'}</IconText>\n            ))\n          }\n        </Flex>\n        <Divider my={3}/>\n        <Flex>\n          <Button\n            sx={{ flex: 1 }}\n            variant='warning'\n            onClick={room.leaveRoom}>\n            Back\n          </Button>\n          <Button\n            sx={{ flex: 1, visibility: (host === room.myId ? null : 'hidden') }}\n            ml={3}\n            variant='primary'\n            onClick={host === room.myId ? startGame : undefined}>\n            Start\n          </Button>\n        </Flex>\n      </Flex>\n    </Card>\n  )\n}\n\nRoom.propTypes = propTypes\n","import React, { createContext, FunctionComponent, useContext, useEffect, useState } from 'react'\nimport { Game, GameEvent } from './Game'\nimport PropTypes from 'prop-types'\nimport { globalRoom, useRoom } from '../lib/RoomContext'\nimport { GameState } from './types/GameState'\n\nexport const GameContext = createContext<[Game, GameState | undefined, string | undefined]>([globalRoom.game, undefined, undefined])\nexport const useGame = (): [Game, GameState | undefined, string | undefined] => useContext(GameContext)\n\nexport const GameContextProvider: FunctionComponent = (props) => {\n  const game = useRoom().game\n  const [gameState, setGameState] = useState<GameState | undefined>(undefined)\n  const [gameOver, setGameOver] = useState<string | undefined>(undefined)\n  useEffect(() => {\n    setGameState(undefined)\n    game.on(GameEvent.UPDATE_GAME_STATE, ({ data }) => {\n      const state = data as GameState\n      setGameOver(state?.gameOver)\n      setGameState({ ...state })\n    })\n    game.on(GameEvent.GAME_OVER, ({ data }) => setGameOver(data as string))\n  }, [game])\n  return <GameContext.Provider value={[game, gameState, gameOver]} {...props} />\n}\n\nGameContextProvider.propTypes = {\n  value: PropTypes.any\n}\n","import React, { FunctionComponent, useEffect, useRef, useState } from 'react'\nimport PropTypes, { InferProps } from 'prop-types'\nimport { Box, BoxProps } from '@theme-ui/components'\nimport { SLOW, transition } from '../../theme/transitions'\n\nconst OPEN = 0b001\nconst DURING = 0b010\nconst BEFORE = 0b100\n\nconst collapsibleProps = {\n  isOpen: PropTypes.bool.isRequired,\n  children: PropTypes.node.isRequired,\n  hideOnly: PropTypes.bool,\n  noInitialTransition: PropTypes.bool\n}\n\nexport type CollapsibleProps = InferProps<typeof collapsibleProps>\n\nconst Collapsible: FunctionComponent<CollapsibleProps & BoxProps> = ({ isOpen, children, hideOnly, noInitialTransition, ...boxProps }) => {\n  const ref = useRef<HTMLDivElement>(null)\n  const [scrollHeight, setScrollHeight] = useState(0)\n  const [isVisible, setVisible] = useState(isOpen)\n  const [transitionState, setTransitionState] = useState<number>(isOpen ? OPEN : 0)\n  const [isMounted, setMounted] = useState(false)\n  const [init, setInit] = useState(!(noInitialTransition ?? false))\n\n  useEffect(() => {\n    setTimeout(() => setInit(true), SLOW * 1000)\n  }, [])\n\n  const updateScrollHeight = (): void => {\n    if (ref?.current !== null) {\n      setScrollHeight(ref.current.scrollHeight)\n    }\n  }\n\n  useEffect(() => {\n    if (isOpen) {\n      setVisible(true)\n    }\n    setTransitionState(isOpen ? BEFORE | OPEN : BEFORE & ~OPEN)\n  }, [isOpen])\n\n  useEffect(() => {\n    if (isMounted) {\n      updateScrollHeight()\n      if ((transitionState & BEFORE) > 0) {\n        setTransitionState(transitionState & ~BEFORE | DURING)\n      } else if ((transitionState & DURING) > 0) {\n        setTimeout(() => {\n          if (isMounted) {\n            if (transitionState === (DURING & ~OPEN)) {\n              setVisible(false)\n            }\n            setTransitionState(transitionState & ~DURING)\n          }\n        }, SLOW * 1000)\n      }\n    }\n  }, [isMounted, transitionState])\n\n  useEffect(() => {\n    setMounted(true)\n    return () => {\n      setMounted(false)\n    }\n  }, [])\n\n  const height = (transitionState === (DURING | OPEN)) || (transitionState === (BEFORE & ~OPEN))\n    ? scrollHeight.toString() + 'px'\n    : (transitionState === (BEFORE | OPEN)) || (transitionState === (DURING & ~OPEN))\n        ? '0px'\n        : undefined\n\n  return (\n    <Box\n      ref={ref}\n      sx={{\n        height,\n        overflowY: (transitionState & (DURING | BEFORE)) > 0 ? 'hidden' : undefined,\n        ...(init ? transition(SLOW, ['height']) : {})\n      }}\n      {...boxProps}>\n      {hideOnly ?? false\n        ? (\n          <Box sx={{ display: isVisible ? 'block' : 'none' }}>\n            {children}\n          </Box>\n          )\n        : (isVisible ? children : null)}\n    </Box>\n  )\n}\n\nCollapsible.propTypes = collapsibleProps\n\nCollapsible.defaultProps = {\n  noInitialTransition: false\n}\n\nexport default Collapsible\n","import React, { forwardRef, FunctionComponent, useEffect, useState } from 'react'\nimport PropTypes, { InferProps } from 'prop-types'\nimport Well from './Well'\nimport { Box, BoxOwnProps, BoxProps, Flex } from '@theme-ui/components'\nimport Icon from './Icon'\nimport { mdiChevronDown } from '@mdi/js'\nimport { transition } from '../../theme/transitions'\nimport Collapsible from './Collapsible'\nimport { baseWell } from '../../theme/wells'\nimport { isDefined } from '../../utils/componentHelpers'\n\nconst collapsibleWellProps = {\n  defaultOpen: PropTypes.bool,\n  children: PropTypes.node.isRequired,\n  header: PropTypes.node.isRequired,\n  setController: PropTypes.func,\n  noPad: PropTypes.bool,\n  reverseHeader: PropTypes.bool,\n  headerSx: PropTypes.object,\n  hideOnly: PropTypes.bool,\n  onOpen: PropTypes.func,\n  open: PropTypes.bool,\n  color: PropTypes.string\n}\n\nexport interface CollapsibleWellController {\n  show: () => void\n  hide: () => void\n  toggle: () => void\n}\n\nexport interface CollapsibleWellProps extends InferProps<typeof collapsibleWellProps> {\n  color?: string | undefined\n  setController?: ((controller: CollapsibleWellController) => void) | null\n}\n\nconst CollapsibleWell: FunctionComponent<CollapsibleWellProps & BoxOwnProps> = forwardRef<HTMLDivElement, CollapsibleWellProps & BoxProps>(\n  (\n    { defaultOpen, children, header, noPad, setController, hideOnly, reverseHeader, headerSx, onOpen, ...boxProps },\n    ref\n  ) => {\n    const [isOpen, setOpen] = useState(defaultOpen ?? false)\n\n    useEffect(() => {\n      if (isDefined(setController)) {\n        setController({\n          show: () => setOpen(true),\n          hide: () => setOpen(false),\n          toggle: () => setOpen(!isOpen)\n        })\n      }\n    }, [isOpen, setController])\n\n    useEffect(() => {\n      if (isOpen) {\n        onOpen?.()\n      }\n    }, [isOpen, onOpen])\n\n    return (\n      <Well\n        ref={ref}\n        {...boxProps}\n        sx={{ p: [0, 0, 0, 0], ...(boxProps.sx) }}>\n        <Flex\n          onClick={() => setOpen(!isOpen)}\n          sx={{\n            px: baseWell.px,\n            py: baseWell.py,\n            ':hover': {\n              backgroundColor: 'highlight'\n            },\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            flexDirection: reverseHeader ?? false ? 'row-reverse' : 'row',\n            ...headerSx\n          }}>\n          {header}\n          <Icon\n            path={mdiChevronDown}\n            sx={{\n              ...transition(0.3, ['transform']),\n              transform: isOpen ? 'rotate(180deg)' : undefined\n            }}\n          />\n        </Flex>\n        <Collapsible isOpen={isOpen} hideOnly={hideOnly}>\n          <Box\n            className='collapsible-content'\n            px={noPad ?? false ? undefined : baseWell.px}\n            py={noPad ?? false ? undefined : baseWell.py}\n            sx={{\n              borderTopColor: 'border',\n              borderTopWidth: '1px',\n              borderTopStyle: 'solid'\n            }}>\n            {children}\n          </Box>\n        </Collapsible>\n      </Well>\n    )\n  }\n)\n\nCollapsibleWell.propTypes = collapsibleWellProps\n\nCollapsibleWell.displayName = 'CollapsibleWell'\n\nexport default CollapsibleWell\n","export default __webpack_public_path__ + \"static/media/token1.d3903231.png\";","export default __webpack_public_path__ + \"static/media/token2.686baae1.png\";","export default __webpack_public_path__ + \"static/media/token3.9d69a577.png\";","export default __webpack_public_path__ + \"static/media/token4.791c829c.png\";","import React, { FunctionComponent } from 'react'\nimport PropTypes, { InferProps } from 'prop-types'\nimport { Box, BoxOwnProps } from '@theme-ui/components'\nimport { IMAGE_SIZE_CSS } from '../../3d/constants'\n\nconst propTypes = {\n  disabled: PropTypes.bool,\n  onClick: PropTypes.func,\n  path: PropTypes.string.isRequired,\n  children: PropTypes.node,\n  sx: PropTypes.object\n}\n\nexport const Image: FunctionComponent<InferProps<typeof propTypes & BoxOwnProps>> = ({ disabled, onClick, path, children, sx }) => {\n  return (\n    <Box\n      onClick={() => { onClick?.() }}\n      sx={{\n        width: IMAGE_SIZE_CSS,\n        height: IMAGE_SIZE_CSS,\n        backgroundImage: `url(${path})`,\n        backgroundSize: 'auto 100%',\n        textAlign: 'center',\n        lineHeight: IMAGE_SIZE_CSS,\n        color: 'white.0',\n        boxShadow: 1,\n        borderRadius: '50%',\n        ...sx\n      }}>\n      <Box\n        sx={{\n          width: '100%',\n          height: '100%',\n          borderRadius: '50%',\n          ':hover': disabled !== true\n            ? {\n                backgroundColor: 'highlight',\n                cursor: (onClick !== undefined ? 'pointer' : undefined)\n              }\n            : undefined,\n          backgroundColor: disabled === true ? 'muted' : undefined\n        }}>\n        {\n          children\n        }\n      </Box>\n    </Box>\n  )\n}\n\nImage.propTypes = propTypes\n","import React, { VFC } from 'react'\nimport PropTypes, { InferProps } from 'prop-types'\nimport { Badge } from '@theme-ui/components'\nimport { ThemeDerivedStyles, ThemeUICSSObject } from '@theme-ui/css'\n\nconst propTypes = {\n  count: PropTypes.number.isRequired,\n  sx: PropTypes.object as PropTypes.Requireable<ThemeUICSSObject | ThemeDerivedStyles>\n}\n\nexport const CountBadge: VFC<InferProps<typeof propTypes>> = ({ count, sx }) => {\n  return (\n    <Badge\n      variant={count > 0 ? 'primary' : 'danger'}\n      sx={sx ?? undefined}>\n      {count}\n    </Badge>\n  )\n}\n\nCountBadge.propTypes = propTypes\n","import React, { FunctionComponent, useEffect, useState } from 'react'\nimport PropTypes, { InferProps } from 'prop-types'\nimport { Box } from '@theme-ui/components'\nimport { Image } from './Image'\nimport { IMAGE_SIZE, IMAGE_SIZE_CSS } from '../../3d/constants'\nimport { SLOW, transition } from '../../theme/transitions'\nimport Hammer from 'react-hammerjs'\nimport { CountBadge } from './CountBadge'\n\nconst propTypes = {\n  stack: PropTypes.arrayOf(PropTypes.node).isRequired,\n  enabled: PropTypes.arrayOf(PropTypes.bool.isRequired),\n  imgPath: PropTypes.string.isRequired,\n  onClick: PropTypes.func,\n  badge: PropTypes.number\n}\n\nexport const ImageStack: FunctionComponent<InferProps<typeof propTypes>> = ({ stack, imgPath, badge, enabled, onClick }) => {\n  const [hovering, setHovering] = useState(false)\n  useEffect(() => {\n    const listener = (): void => setHovering(false)\n    window.addEventListener('touchend', listener)\n    window.addEventListener('touchcancel', listener)\n    return () => {\n      window.removeEventListener('touchend', listener)\n      window.removeEventListener('touchcancel', listener)\n    }\n  }, [setHovering])\n  return (\n    <Hammer\n      onTap={(e: HammerInput) => {\n        e.preventDefault()\n        setHovering(false)\n      }}\n      onPress={(e: HammerInput) => {\n        e.preventDefault()\n        setHovering(true)\n      }}\n      onPressUp={(e: HammerInput) => {\n        setHovering(false)\n        e.preventDefault()\n      }}>\n      <Box\n        onMouseEnter={() => setHovering(true)}\n        onMouseLeave={() => setHovering(false)}\n        unselectable={'on'}\n        sx={{ position: 'relative', width: IMAGE_SIZE_CSS, height: IMAGE_SIZE_CSS }}\n        onContextMenu={e => {\n          setHovering(false)\n          e.preventDefault()\n        }}\n        m={1}>\n        {(stack.length > 0 ? stack : ['-']).map((content, k) => (\n          <Box\n            key={k}\n            sx={{\n              position: 'absolute',\n              bottom: hovering ? `${k * (IMAGE_SIZE + 4)}px` : '0px',\n              zIndex: stack.length - k,\n              pb: '4px',\n              ...transition(SLOW, ['bottom'])\n            }}>\n            <Image\n              path={imgPath}\n              disabled={content === '-' || enabled?.[k] === false}\n              onClick={k === 0 && enabled?.[k] !== false ? onClick : undefined}>\n              {\n                // enabled?.[k] === false ? '-' : ''\n              }\n              {content}\n            </Image>\n          </Box>\n        ))}\n        {badge !== undefined && badge !== null && (\n          <CountBadge\n            count={badge}\n            sx={{\n              position: 'absolute',\n              right: 0,\n              bottom: 0,\n              zIndex: stack.length + 1\n            }}\n          />)}\n      </Box>\n    </Hammer>\n  )\n}\n\nImageStack.propTypes = propTypes\n","import React, { FunctionComponent } from 'react'\nimport PropTypes, { InferProps } from 'prop-types'\nimport token1 from '../assets/images/tokens/token1.png'\nimport token2 from '../assets/images/tokens/token2.png'\nimport token3 from '../assets/images/tokens/token3.png'\nimport token4 from '../assets/images/tokens/token4.png'\nimport { ImageStack } from './common/ImageStack'\n\nconst tokenImages = ['', token1, token2, token3, token4]\n\nconst propTypes = {\n  stack: PropTypes.arrayOf(PropTypes.number).isRequired,\n  leaves: PropTypes.number.isRequired\n}\n\nexport const getScoreTokenImageByLeaves = (leaves: number): string => {\n  return tokenImages[leaves]\n}\n\nexport const ScoreTokenStack: FunctionComponent<InferProps<typeof propTypes>> = ({ stack, leaves }) => {\n  const tokenImage = getScoreTokenImageByLeaves(leaves)\n  return (\n    <ImageStack stack={stack} imgPath={tokenImage} badge={stack.length}/>\n  )\n}\n\nScoreTokenStack.propTypes = propTypes\n","import React from 'react'\nimport { Flex } from '@theme-ui/components'\nimport PropTypes from 'prop-types'\n\nconst ButtonGroup = ({ children, ...props }) => {\n  const cc = React.Children.toArray(children)\n  return <Flex sx={{ alignItems: 'flex-end' }} {...props}>{\n    cc.map((child, k) => {\n      const borderLeft = k === 0 ? {} : ({ borderBottomLeftRadius: 0, borderTopLeftRadius: 0 })\n      const borderRight = k === cc.length - 1 ? {} : ({ borderBottomRightRadius: 0, borderTopRightRadius: 0 })\n      return React.cloneElement(child, { sx: { ...borderLeft, ...borderRight } })\n    })\n  }</Flex>\n}\n\nButtonGroup.propTypes = {\n  children: PropTypes.node\n}\n\nexport default ButtonGroup\n","export default __webpack_public_path__ + \"static/media/sun.b0ca195e.svg\";","import React, { FunctionComponent } from 'react'\nimport PropTypes, { InferProps } from 'prop-types'\nimport { Box, Flex } from '@theme-ui/components'\nimport sun from '../assets/images/sun.svg'\nimport { ThemeDerivedStyles, ThemeUICSSObject } from '@theme-ui/css'\n\nconst propTypes = {\n  children: PropTypes.node,\n  sx: PropTypes.object as PropTypes.Requireable<ThemeUICSSObject | ThemeDerivedStyles>\n}\n\nexport const SunlightTag: FunctionComponent<InferProps<typeof propTypes>> = ({ children, sx }) => {\n  return (\n    <Flex sx={sx ?? undefined}>\n      <Box>\n        <img alt='sun icon' style={{ maxHeight: '24px' }} src={sun}/>\n      </Box>\n      <Box sx={{ lineHeight: '24px' }}>\n        {children}\n      </Box>\n    </Flex>\n  )\n}\n\nSunlightTag.propTypes = propTypes\n","import React, { FC } from 'react'\nimport sun from '../assets/images/sun.svg'\nimport { Box } from '@theme-ui/components'\nimport { Theme } from '@theme-ui/css'\nimport { SxProp } from '@theme-ui/core'\n\ninterface SunlightBadgeProps extends SxProp {\n  size?: number | string\n  myPoints: number\n  className?: string\n}\n\nexport const SunlightBadge: FC<SunlightBadgeProps> = ({ children, size = '24px', myPoints, className }) => {\n  return (\n    <Box\n      className={className}\n      sx={{\n        boxSizing: 'content-box',\n        backgroundImage: `url(${sun})`,\n        backgroundSize: 'auto 100%',\n        textAlign: 'center',\n        width: size,\n        height: size,\n        lineHeight: size,\n        color: (myPoints ?? Infinity) >= (children ?? -Infinity) ? 'white.0' : 'red.0',\n        textShadow: (theme: Theme) => `\n            -1px -1px 1px ${theme.colors?.sunTagShadow as string},\n            1px -1px 1px ${theme.colors?.sunTagShadow as string},\n            -1px 1px 1px ${theme.colors?.sunTagShadow as string},\n            1px 1px 1px ${theme.colors?.sunTagShadow as string}`,\n        fontSize: 1,\n        fontWeight: 'bolder'\n      }}>\n      {children}\n    </Box>\n  )\n}\n","export default __webpack_public_path__ + \"static/media/seedBlue.a94e41ee.png\";","export default __webpack_public_path__ + \"static/media/shortBlue.73056e66.png\";","export default __webpack_public_path__ + \"static/media/midBlue.77094c0e.png\";","export default __webpack_public_path__ + \"static/media/tallBlue.c4de3db8.png\";","export default __webpack_public_path__ + \"static/media/seedGreen.63212337.png\";","export default __webpack_public_path__ + \"static/media/shortGreen.de62bc33.png\";","export default __webpack_public_path__ + \"static/media/midGreen.64339637.png\";","export default __webpack_public_path__ + \"static/media/tallGreen.fe39512a.png\";","export default __webpack_public_path__ + \"static/media/seedOrange.cda5f0ce.png\";","export default __webpack_public_path__ + \"static/media/shortOrange.13be468c.png\";","export default __webpack_public_path__ + \"static/media/midOrange.e0443e61.png\";","export default __webpack_public_path__ + \"static/media/tallOrange.37dd8f99.png\";","export default __webpack_public_path__ + \"static/media/seedYellow.733a13b8.png\";","export default __webpack_public_path__ + \"static/media/shortYellow.a15af630.png\";","export default __webpack_public_path__ + \"static/media/midYellow.1b6cf970.png\";","export default __webpack_public_path__ + \"static/media/tallYellow.ed752832.png\";","import React, { FunctionComponent, useMemo } from 'react'\nimport PropTypes, { InferProps } from 'prop-types'\nimport { ImageStack } from './common/ImageStack'\nimport { ACTION_COST_PURCHASE, Color, GrowthStage } from '../3d/constants'\nimport { SunlightBadge } from './SunlightBadge'\n\nimport seedBlue from '../assets/images/tokens/seedBlue.png'\nimport shortBlue from '../assets/images/tokens/shortBlue.png'\nimport midBlue from '../assets/images/tokens/midBlue.png'\nimport tallBlue from '../assets/images/tokens/tallBlue.png'\n\nimport seedGreen from '../assets/images/tokens/seedGreen.png'\nimport shortGreen from '../assets/images/tokens/shortGreen.png'\nimport midGreen from '../assets/images/tokens/midGreen.png'\nimport tallGreen from '../assets/images/tokens/tallGreen.png'\n\nimport seedOrange from '../assets/images/tokens/seedOrange.png'\nimport shortOrange from '../assets/images/tokens/shortOrange.png'\nimport midOrange from '../assets/images/tokens/midOrange.png'\nimport tallOrange from '../assets/images/tokens/tallOrange.png'\n\nimport seedYellow from '../assets/images/tokens/seedYellow.png'\nimport shortYellow from '../assets/images/tokens/shortYellow.png'\nimport midYellow from '../assets/images/tokens/midYellow.png'\nimport tallYellow from '../assets/images/tokens/tallYellow.png'\n\nconst TREE_TOKENS_BLUE = {\n  [GrowthStage.SEED]: seedBlue,\n  [GrowthStage.SHORT]: shortBlue,\n  [GrowthStage.MID]: midBlue,\n  [GrowthStage.TALL]: tallBlue\n}\n\nconst TREE_TOKENS_GREEN = {\n  [GrowthStage.SEED]: seedGreen,\n  [GrowthStage.SHORT]: shortGreen,\n  [GrowthStage.MID]: midGreen,\n  [GrowthStage.TALL]: tallGreen\n}\n\nconst TREE_TOKENS_ORANGE = {\n  [GrowthStage.SEED]: seedOrange,\n  [GrowthStage.SHORT]: shortOrange,\n  [GrowthStage.MID]: midOrange,\n  [GrowthStage.TALL]: tallOrange\n}\n\nconst TREE_TOKENS_YELLOW = {\n  [GrowthStage.SEED]: seedYellow,\n  [GrowthStage.SHORT]: shortYellow,\n  [GrowthStage.MID]: midYellow,\n  [GrowthStage.TALL]: tallYellow\n}\n\nconst TREE_TOKENS = {\n  [Color.BLUE]: TREE_TOKENS_BLUE,\n  [Color.GREEN]: TREE_TOKENS_GREEN,\n  [Color.ORANGE]: TREE_TOKENS_ORANGE,\n  [Color.YELLOW]: TREE_TOKENS_YELLOW\n}\n\nconst propTypes = {\n  canBuy: PropTypes.arrayOf(PropTypes.bool.isRequired).isRequired,\n  growthStage: PropTypes.number.isRequired,\n  color: PropTypes.number.isRequired,\n  onClick: PropTypes.func,\n  myPoints: PropTypes.number.isRequired\n}\n\nexport const getTreeImageByColorGrowthStage = (color: Color, growthStage: GrowthStage): string => TREE_TOKENS[color][growthStage]\n\nexport const TreeTokenStack: FunctionComponent<InferProps<typeof propTypes>> = ({ canBuy, growthStage, color, onClick, myPoints }) => {\n  const [stack, enabled] = useMemo(() => {\n    const stack = canBuy.map((_, k) => (\n      <SunlightBadge\n        key={k}\n        myPoints={myPoints}\n        sx={{\n          top: 0,\n          right: '-4px',\n          position: 'absolute'\n        }}>\n        {ACTION_COST_PURCHASE[growthStage as GrowthStage][k]}\n      </SunlightBadge>\n    ))\n    const enabled = [...canBuy]\n    if (!canBuy[0]) {\n      const k = canBuy.indexOf(true)\n      if (k !== -1) {\n        const tag = stack.splice(k, 1)\n        enabled[0] = true\n        enabled[k] = false\n        return [[tag, ...stack], enabled]\n      }\n    }\n    return [stack, enabled]\n  }, [canBuy, growthStage, myPoints])\n  return (\n    <ImageStack\n      stack={stack}\n      enabled={enabled}\n      imgPath={getTreeImageByColorGrowthStage(color, growthStage)}\n      onClick={onClick}\n      badge={canBuy.filter(s => s).length}\n    />\n  )\n}\n\nTreeTokenStack.propTypes = propTypes\n","import { Box, Flex, Grid } from '@theme-ui/components'\nimport Button from './common/Button'\nimport { ACTION_COST_GROW, ACTION_COST_SEED, GrowthStage } from '../3d/constants'\nimport CollapsibleWell from './common/CollapsibleWell'\nimport React, { FunctionComponent, useEffect, useState } from 'react'\nimport { GameState } from '../Game/types/GameState'\nimport { Room, RoomState } from '../lib/Room'\nimport PropTypes from 'prop-types'\nimport { PlayerInfo } from '../Game/types/PlayerInfo'\nimport { ScoreTokenStack } from './ScoreTokenStack'\nimport ButtonGroup from './common/ButtonGroup'\nimport { SunlightTag } from './SunlightTag'\nimport { getTreeImageByColorGrowthStage, TreeTokenStack } from './TreeTokenStack'\nimport { ImageStack } from './common/ImageStack'\nimport { InteractionState } from './GamePlayer'\nimport { Game, GameActions } from '../Game/Game'\nimport { SunlightBadge } from './SunlightBadge'\n\ninterface props {\n  mi: number | undefined // my player id\n  roomState: RoomState\n  interactionStateReducer: (patch: Partial<InteractionState>) => void\n}\n\nconst propTypes = {\n  mi: PropTypes.number,\n  roomState: PropTypes.any.isRequired,\n  interactionStateReducer: PropTypes.func.isRequired\n}\n\nexport const Panel: FunctionComponent<props> = ({ mi, roomState, interactionStateReducer }) => {\n  const gameState: GameState | undefined = roomState.game\n  const [activePlayerId, setActivePlayerId] = useState(mi)\n  useEffect(() => {\n    if (mi !== undefined) {\n      setActivePlayerId(mi)\n    }\n  }, [mi])\n  const playerInfo: PlayerInfo | undefined = gameState?.playerInfo[activePlayerId ?? -1]\n  const clickToPurchase = (growthStage: GrowthStage): void => {\n    interactionStateReducer({ growthStage, action: GameActions.PURCHASE })\n  }\n  const clickToEndTurn = (): void => {\n    interactionStateReducer({ action: GameActions.END_TURN })\n  }\n  const handlerAvailableTokenClick = (growthStage: GrowthStage): void => {\n    if (growthStage === GrowthStage.SEED) {\n      interactionStateReducer({ action: GameActions.PLANT_SEED })\n    } else {\n      interactionStateReducer({ action: GameActions.GROW_TREE, growthStage: growthStage - 1 })\n    }\n  }\n  const id2Name = (id: number): string => Room.getName(roomState, id)\n  return (\n    <CollapsibleWell\n      header={gameState !== undefined ? `Current turn: ${id2Name(gameState.turn)}` : 'Board'}\n      sx={{ m: 0, bg: 'bgPales.0', maxHeight: '100vh' }}\n      defaultOpen={true}>\n      {gameState !== undefined && <Flex sx={{ flexWrap: 'wrap', justifyContent: 'space-around' }}>\n        <Box>\n          <Box>Score Tokens</Box>\n          <Flex>\n            {\n              Object.entries(gameState.scoreTokens).map(([leaves, stack]) => (\n                <ScoreTokenStack key={leaves} leaves={Number.parseInt(leaves)} stack={stack}/>\n              ))\n            }\n          </Flex>\n        </Box>\n        <Box>\n          <Flex sx={{ justifyContent: 'space-between' }}>\n            <ButtonGroup>\n              {Object.entries(roomState.nameDict ?? {}).map(([name, id]) => (\n                <Button\n                  key={id}\n                  variant={id !== activePlayerId?.toString() ? 'normal' : 'primary'}\n                  onClick={() => setActivePlayerId(Number.parseInt(id))}>\n                  {name}\n                </Button>\n              ))}\n              <Button onClick={() => console.log(roomState)}>O</Button>\n            </ButtonGroup>\n            {gameState.turn === mi && <Button onClick={clickToEndTurn} disabled={gameState.preparingRound > 0}>End Turn</Button>}\n          </Flex>\n          {playerInfo !== undefined && <Box>\n            <Grid columns={2}>\n              <SunlightTag>{playerInfo.lightPoint ?? ''}</SunlightTag>\n              <Box>Score: {playerInfo.score}</Box>\n            </Grid>\n            <Grid columns={[1, null, 2]}>\n              <Box>\n                <Box>Available:</Box>\n                <Flex>{Object.entries(playerInfo.availableArea).map(([growthStage, amount]) => {\n                  const cost = Number.parseInt(growthStage) === GrowthStage.SEED ? ACTION_COST_SEED : ACTION_COST_GROW[Number.parseInt(growthStage) - 1 as GrowthStage]\n                  return (\n                    <Box key={growthStage} sx={{ position: 'relative' }}>\n                      <ImageStack\n                        key={growthStage}\n                        onClick={(activePlayerId === mi && playerInfo.lightPoint >= cost && (gameState.preparingRound <= 0 || growthStage === GrowthStage.SHORT.toString())) ? () => handlerAvailableTokenClick(Number.parseInt(growthStage)) : undefined}\n                        imgPath={getTreeImageByColorGrowthStage(playerInfo.color, Number.parseInt(growthStage))}\n                        enabled={amount === 0 ? [false] : undefined}\n                        stack={new Array(Math.max(1, amount)).fill(<SunlightBadge\n                          myPoints={playerInfo.lightPoint}\n                          sx={{\n                            top: 0,\n                            right: '-4px',\n                            position: 'absolute'\n                          }}>\n                          {cost}\n                        </SunlightBadge>)}\n                        badge={amount}\n                      />\n                    </Box>\n                  )\n                })}\n                </Flex>\n              </Box>\n              <Box>\n                <Box>Purchase:</Box>\n                <Flex>\n                  {\n                    Object.entries(playerInfo.playerBoard).map(([growStage, canBuy]) => (\n                      <TreeTokenStack\n                        key={growStage}\n                        onClick={activePlayerId === mi && activePlayerId !== undefined && playerInfo.lightPoint >= Game.nextPurchase(gameState, activePlayerId, Number.parseInt(growStage)).cost ? () => clickToPurchase(Number.parseInt(growStage)) : undefined}\n                        growthStage={Number.parseInt(growStage)}\n                        color={playerInfo.color}\n                        canBuy={canBuy}\n                        myPoints={playerInfo.lightPoint}\n                      />\n                    ))\n                  }\n                </Flex>\n              </Box>\n            </Grid>\n          </Box>}\n        </Box>\n      </Flex>}\n    </CollapsibleWell>\n  )\n}\n\nPanel.propTypes = propTypes\n","import React, { FunctionComponent, useCallback, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { Box, Flex } from '@theme-ui/components'\nimport { Image } from './common/Image'\nimport { getTreeImageByColorGrowthStage } from './TreeTokenStack'\nimport { ACTION_COST_GROW, ACTION_COST_SEED, GROWTH_STAGE_NAME, GrowthStage } from '../3d/constants'\nimport { Game, GameActions, GameEvent } from '../Game/Game'\nimport { getScoreTokenImageByLeaves } from './ScoreTokenStack'\nimport { Card } from './common/Card'\nimport { InteractionState } from './GamePlayer'\nimport { Axial } from '../3d/Coordinates/Axial'\nimport { SunlightBadge } from './SunlightBadge'\nimport Button from './common/Button'\nimport { ImageStack } from './common/ImageStack'\nimport { useAlert } from './common/AlertContext'\n\nconst propTypes = {\n  game: PropTypes.any.isRequired,\n  interactionState: PropTypes.any.isRequired,\n  interactionStateReducer: PropTypes.func.isRequired\n}\n\ninterface Props {\n  interactionState: InteractionState\n  interactionStateReducer: (patch: Partial<InteractionState> | undefined) => void\n  game: Game\n}\n\nexport const Popper: FunctionComponent<Props> = ({ interactionState, game, interactionStateReducer }) => {\n  const isMyTile = (axial: Axial): boolean => game.started && game.state?.board[axial.toString()].color === game.mi\n  const growthStageOfTile: GrowthStage | undefined = game.started ? game.state?.board[interactionState?.axial?.toString() ?? '']?.growthStage : undefined\n  const domElement = game.gameWorld.renderer.domElement.parentElement\n  const alert = useAlert()\n  const axialUpdateHandler = useCallback(({ data }) => {\n    const axial = (data as { activeAxial?: Axial }).activeAxial\n    if (axial === undefined) {\n      interactionStateReducer(undefined)\n    } else {\n      interactionStateReducer({ axial })\n    }\n  }, [interactionStateReducer])\n\n  useEffect(() => {\n    const id = game.on(GameEvent.ACTIVE_OBJECT_CHANGED, axialUpdateHandler)\n\n    return () => {\n      game.off(GameEvent.ACTIVE_OBJECT_CHANGED, id)\n    }\n  }, [axialUpdateHandler, game])\n\n  useEffect(() => {\n    const listener = (event: TouchEvent | MouseEvent): void => {\n      const popperCoord: [number, number] = [0, 0]\n      if (event instanceof MouseEvent) {\n        popperCoord[0] = event.clientX\n        popperCoord[1] = event.clientY\n      } else {\n        popperCoord[0] = event.changedTouches[0].pageX\n        popperCoord[1] = event.changedTouches[0].pageY\n      }\n      interactionStateReducer({ popperCoord: popperCoord })\n    }\n    domElement?.addEventListener('click', listener)\n    return () => {\n      domElement?.removeEventListener('click', listener)\n    }\n  }, [domElement, game.gameWorld, interactionStateReducer])\n\n  if (interactionState.axial === undefined || game.state === undefined || interactionState.popperCoord === undefined) {\n    return null\n  }\n  if (!game.started) {\n    return null\n  }\n  const playerInfo = game.state.playerInfo[game.mi]\n  const errorHandler = (e: Error): void => {\n    alert(e.message)\n  }\n  const purchase = (growthStage: GrowthStage): void => {\n    game.purchase(growthStage).catch(errorHandler)\n  }\n  const plantInitialTreeButton = (\n    <Box>\n      <Box>Plant initial tree</Box>\n      <Image\n        path={getTreeImageByColorGrowthStage(game.mi, GrowthStage.SHORT)}\n        onClick={() => interactionStateReducer({ action: GameActions.GROW_TREE })}\n      />\n    </Box>\n  )\n  const iHaveSeed = playerInfo.availableArea[GrowthStage.SEED] >= 1\n  const purchaseSeedCost = Game.nextPurchase(game.state, game.mi, GrowthStage.SEED).cost\n  const plantSeedButton = (\n    <Box m={1}>\n      <Box>Seed</Box>\n      <ImageStack\n        imgPath={getTreeImageByColorGrowthStage(game.mi, GrowthStage.SEED)}\n        stack={[<SunlightBadge\n          key={1}\n          myPoints={playerInfo.lightPoint}\n          sx={{ position: 'absolute', top: 0, right: '-4px' }}>{ACTION_COST_SEED}</SunlightBadge>]}\n        badge={playerInfo.availableArea[GrowthStage.SEED]}\n        onClick={() => interactionStateReducer({ action: GameActions.PLANT_SEED })}\n        enabled={[iHaveSeed && playerInfo.lightPoint >= ACTION_COST_SEED]}\n      />\n      {!iHaveSeed && (<Box sx={{ position: 'relative' }}>\n        <Button\n          variant='normal-pill-sm'\n          mt={2}\n          onClick={() => purchase(GrowthStage.SEED)}\n          disabled={purchaseSeedCost === undefined || playerInfo.lightPoint < purchaseSeedCost}>\n          {purchaseSeedCost === undefined ? 'N/A' : 'Buy'}\n        </Button>\n        <SunlightBadge\n          myPoints={playerInfo.lightPoint}\n          sx={{ position: 'absolute', right: 0, top: 0 }}>\n          {purchaseSeedCost}\n        </SunlightBadge>\n      </Box>)}\n    </Box>\n  )\n  const iHaveNextTree = growthStageOfTile !== undefined && playerInfo.availableArea[growthStageOfTile + 1 as GrowthStage] > 0\n  const purchaseNextStageCost = growthStageOfTile !== undefined && growthStageOfTile !== GrowthStage.TALL ? Game.nextPurchase(game.state, game.mi, growthStageOfTile + 1).cost : Infinity\n  const growTreeButton = growthStageOfTile !== undefined && growthStageOfTile !== GrowthStage.TALL && (\n    <Box m={1}>\n      {game.haveSlot(game.state, game.mi, growthStageOfTile)\n        ? <Box>Grow</Box>\n        : <Box\n          title={`No empty slots on your purchase board. Proceed and you will say bye bye to your lovely ${GROWTH_STAGE_NAME[growthStageOfTile]}. So think carefully.`}\n          sx={{ color: 'yellow.0' }}>\n          Grow\n        </Box>}\n      <ImageStack\n        imgPath={getTreeImageByColorGrowthStage(game.mi, growthStageOfTile + 1)}\n        stack={[<SunlightBadge\n          key={1}\n          myPoints={playerInfo.lightPoint}\n          sx={{ position: 'absolute', top: 0, right: '-4px' }}>{ACTION_COST_GROW[growthStageOfTile]}</SunlightBadge>]}\n        badge={playerInfo.availableArea[growthStageOfTile + 1 as GrowthStage]}\n        onClick={() => interactionStateReducer({ action: GameActions.GROW_TREE })}\n        enabled={[iHaveNextTree && playerInfo.lightPoint >= ACTION_COST_GROW[growthStageOfTile]]}\n      />\n      {!iHaveNextTree &&\n      <Box sx={{ position: 'relative' }}>\n        <Button\n          variant='normal-pill-sm'\n          mt={2}\n          onClick={() => purchase(growthStageOfTile + 1)}\n          disabled={purchaseNextStageCost === undefined || playerInfo.lightPoint < purchaseNextStageCost}>\n          {purchaseNextStageCost === undefined ? 'N/A' : 'Buy'}\n        </Button>\n        <SunlightBadge\n          myPoints={playerInfo.lightPoint}\n          sx={{ position: 'absolute', right: 0, top: 0 }}>\n          {purchaseNextStageCost}\n        </SunlightBadge>\n      </Box>}\n    </Box>\n  )\n  const nextToken = game.nextToken(game.state, interactionState.axial)\n  const harvestButton = growthStageOfTile !== undefined && growthStageOfTile === GrowthStage.TALL && (\n    <Box m={1}>\n      <Box>Harvest</Box>\n      <ImageStack\n        stack={[<Box key={1} sx={{ position: 'relative' }}>\n          <SunlightBadge\n            myPoints={playerInfo.lightPoint}\n            sx={{ position: 'absolute', right: '-4px' }}>{ACTION_COST_GROW[growthStageOfTile]}</SunlightBadge>\n          <Box>\n            {nextToken.score}\n          </Box>\n        </Box>]}\n        imgPath={getScoreTokenImageByLeaves(nextToken.leaves)}\n        onClick={() => interactionStateReducer({ action: GameActions.GROW_TREE })}\n        enabled={[playerInfo.lightPoint >= ACTION_COST_GROW[GrowthStage.TALL]]}\n      />\n    </Box>\n  )\n  return (\n    <Card\n      sx={{\n        p: 2,\n        position: 'fixed',\n        left: `${interactionState.popperCoord?.[0].toString() ?? '0'}px`,\n        top: `${interactionState.popperCoord?.[1].toString() ?? '0'}px`,\n        backgroundColor: 'bgPales.0',\n        zIndex: 1\n      }}>\n      {interactionState.axial.toString()}\n      {\n        (game.state.preparingRound > 0\n          ? (growthStageOfTile === undefined && plantInitialTreeButton)\n          : (\n            <Flex sx={{ justifyItems: 'space-around' }}>\n              {(isMyTile(interactionState.axial) || growthStageOfTile === undefined) && plantSeedButton}\n              {growthStageOfTile !== undefined && isMyTile(interactionState.axial) && (\n                growthStageOfTile === GrowthStage.TALL ? harvestButton : growTreeButton\n              )}\n            </Flex>))\n      }\n    </Card>\n  )\n}\n\nPopper.propTypes = propTypes\n","import React, { Context, createContext, FunctionComponent, useCallback, useContext, useState } from 'react'\nimport ConfirmDialog from './ConfirmDialog'\n\nexport interface ConfirmMessage {\n  title: string\n  message: string | Element\n}\n\nexport interface Confirm {\n  message: ConfirmMessage\n  resolve: (result: boolean) => void\n}\n\nexport type ConfirmFunction = (s: string) => Promise<boolean>\n\nexport const withConfirmQueue = (WrappedComponent: FunctionComponent): FunctionComponent => {\n  const ConfirmWrapper: FunctionComponent = props => {\n    const [queue, setQueue] = useState<Confirm[]>([])\n\n    const popAlert = (): void => {\n      setQueue(queue.slice(1))\n    }\n\n    const queueConfirm: ConfirmFunction = useCallback(async (s: string | ConfirmMessage): Promise<boolean> => {\n      const message: ConfirmMessage = typeof s === 'string' ? { title: 'Alert', message: s } : s\n      return await new Promise((resolve) => {\n        setQueue(queue.concat([{ message, resolve }]))\n      })\n    }, [queue])\n\n    const confirmNodes = queue.map(({ message, resolve }, i) => (\n      <ConfirmDialog\n        key={i}\n        isOpen={i === 0}\n        title={message.title}\n        onAction={resolve}\n        onClose={popAlert}>\n        {message.message}\n      </ConfirmDialog>\n    ))\n\n    return (\n      <ConfirmContext.Provider value={queueConfirm}>\n        <WrappedComponent {...props}/>\n        {confirmNodes}\n      </ConfirmContext.Provider>\n    )\n  }\n\n  return ConfirmWrapper\n}\n\nexport const useConfirm = (): ConfirmFunction => useContext(ConfirmContext)\nconst defaultConfirm: ConfirmFunction = async (message) => await new Promise((resolve) => resolve(window.confirm(message)))\nexport const ConfirmContext: Context<ConfirmFunction> = createContext<ConfirmFunction>(defaultConfirm)\nConfirmContext.displayName = 'ConfirmContext'\n","import React, { FunctionComponent } from 'react'\nimport PropTypes, { InferProps } from 'prop-types'\nimport { Box, BoxProps, Flex } from '@theme-ui/components'\nimport { Color, COLOR_VALUES, GrowthStage } from '../../3d/constants'\nimport { useGame } from '../../Game/GameContext'\nimport { darken, lighten, transparentize } from 'polished'\nimport { useColorMode } from '@theme-ui/color-modes'\nimport { reverse } from 'ramda'\nimport IconText from '../common/IconText'\nimport { mdiLeaf, mdiWhiteBalanceSunny } from '@mdi/js'\nimport { SLOW, transition } from '../../theme/transitions'\nimport { colorsFromPlayerColor } from '../../utils/colors'\n\nconst stationProps = {\n  playerColor: PropTypes.number.isRequired as PropTypes.Validator<Color>\n}\n\ntype StationIndicatorProps = InferProps<typeof stationProps>\n\nconst GROWTH_STAGE_SYMBOLS: { [k in GrowthStage]: string } = {\n  [GrowthStage.SEED]: '',\n  [GrowthStage.SHORT]: 'S',\n  [GrowthStage.MID]: 'M',\n  [GrowthStage.TALL]: 'L'\n}\n\nconst GROWTH_STAGE_SIZES: { [k in GrowthStage]: number[] } = {\n  [GrowthStage.SEED]: [8, 10],\n  [GrowthStage.SHORT]: [8, 10],\n  [GrowthStage.MID]: [11, 15],\n  [GrowthStage.TALL]: [17, 25]\n}\n\n// 6, 8, 4, 2\n\nconst StationIndicator: FunctionComponent<StationIndicatorProps & BoxProps> = ({ playerColor, ...boxProps }) => {\n  const [colorMode] = useColorMode()\n  const [game] = useGame()\n  if (game.state === undefined) {\n    return null\n  }\n  const playerName = game.room.whoami(playerColor.toString())\n  const playerInfo = game.state.playerInfo[playerColor]\n  const { sx, ...otherProps } = boxProps\n  const color = '#' + COLOR_VALUES[playerColor].toString(16)\n  const [bg, text] = colorsFromPlayerColor(colorMode, playerColor)\n\n  return (\n    <Flex\n      sx={{\n        width: 'calc(25vw - 8px)',\n        mx: '4px',\n        maxWidth: '150px',\n        flexDirection: 'column',\n        bg: 'bgs.2',\n        borderRadius: 2,\n        padding: 1,\n        color: 'text',\n        boxShadow: 1,\n        ...transition(SLOW, ['transform']),\n        transform: playerColor === game.state.turn ? 'translateY(8px)' : 'translateY(30px)',\n        pointerEvents: 'all',\n        cursor: 'pointer',\n        ...sx\n      }}\n      {...otherProps}>\n      <Box\n        sx={{\n          textAlign: 'center',\n          background: `linear-gradient(to right, ${darken(0.05)(bg)}, ${lighten(0.05)(bg)})`,\n          fontWeight: 'bold',\n          padding: 1\n        }}>\n        {playerName}\n      </Box>\n      <Flex\n        px={2}\n        py={1}\n        sx={{\n          boxShadow: 'inset 0 3px 6px rgba(0, 0, 0, 0.3)',\n          background: `linear-gradient(to bottom, ${darken(0.15)(bg)}, ${darken(0.1)(bg)})`,\n          flexDirection: 'row',\n          '> *': { flex: 1 }\n        }}>\n        <IconText path={mdiWhiteBalanceSunny} color='text' mr={2} size={['12px', '16px']} iconMargin={[1, 2]}>{playerInfo.lightPoint}</IconText>\n        <IconText path={mdiLeaf} color='text' size={['12px', '16px']} iconMargin={[1, 2]}>{playerInfo.score}</IconText>\n      </Flex>\n      <Flex\n        sx={{\n          flexDirection: 'column',\n          lineHeight: 1,\n          backgroundImage: `radial-gradient(farthest-side at bottom, ${transparentize(0.8)(color)}, transparent)`,\n          backgroundSize: '200% 60%',\n          backgroundRepeat: 'no-repeat',\n          backgroundPosition: 'bottom',\n          backgroundColor: 'bgs.1',\n          color: 'text',\n          boxShadow: 'inset 0 3px 6px rgba(0, 0, 0, 0.3)',\n          alignItems: 'center',\n          fontSize: ['12px', '16px']\n        }}>\n        <Flex\n          pt={2}\n          pb={1}\n          sx={{\n            flexDirection: 'column',\n            textAlign: 'center',\n            width: '100%'\n          }}>\n          <Flex\n            sx={{\n              flexDirection: 'row',\n              alignItems: 'center',\n              '> *': { flex: 1 },\n              color: text\n            }}>\n            {Object.keys(playerInfo.availableArea).map((key) => (\n              <Box key={key}>{GROWTH_STAGE_SYMBOLS[Number.parseInt(key) as GrowthStage]}</Box>\n            ))}\n          </Flex>\n          <Flex\n            sx={{\n              flexDirection: 'row',\n              alignItems: 'center',\n              '> *': { flex: 1 }\n            }}>\n            {Object.entries(playerInfo.availableArea).map(([key, number]) => (\n              <Box key={key} sx={{ color: number > 0 ? text : 'muted' }}>{number}</Box>\n            ))}\n          </Flex>\n        </Flex>\n        <Flex\n          sx={{\n            flexDirection: 'row',\n            alignItems: 'stretch',\n            justifyContent: 'space-between',\n            padding: '4px',\n            pb: '30px',\n            borderWidth: '1px',\n            borderStyle: 'solid',\n            borderColor: text,\n            borderTopLeftRadius: 1,\n            borderTopRightRadius: 1,\n            borderBottom: 'none',\n            maxWidth: ['72px', '86px'],\n            width: 'calc(100% - 8px)'\n          }}>\n          {Object.entries(playerInfo.playerBoard).map(([key, slots]) => {\n            const growthStage = Number.parseInt(key) as GrowthStage\n            const size = GROWTH_STAGE_SIZES[growthStage]\n            return (\n              <Flex\n                key={key}\n                sx={{\n                  flexDirection: 'column',\n                  justifyContent: 'space-between'\n                }}>\n                {reverse(slots).map((isAvailable, i) => (\n                  <Box\n                    key={i}\n                    sx={{\n                      margin: ['1px', '2px'],\n                      width: size,\n                      height: size,\n                      borderRadius: '100%',\n                      borderColor: text,\n                      borderWidth: '1px',\n                      borderStyle: 'solid',\n                      backgroundColor: isAvailable ? text : 'transparent'\n                    }}\n                  />\n                ))}\n              </Flex>\n            )\n          })}\n        </Flex>\n      </Flex>\n    </Flex>\n  )\n}\n\nStationIndicator.propTypes = stationProps\n\nexport default StationIndicator\n","import React, { FunctionComponent } from 'react'\nimport PropTypes, { InferProps } from 'prop-types'\nimport { Box } from '@theme-ui/components'\nimport { SLOW, transition } from '../../theme/transitions'\n\nconst DEPTH = 6\n\nconst tokenProps = {\n  url: PropTypes.string.isRequired,\n  isActive: PropTypes.bool,\n  size: PropTypes.number.isRequired\n}\n\nconst Token: FunctionComponent<InferProps<typeof tokenProps>> = ({ url, isActive = false, size }) => (\n  <Box\n    className={isActive === true ? 'isActive' : undefined}\n    sx={{\n      position: 'relative',\n      width: `${size}px`,\n      height: `${size}px`,\n      transformOrigin: '50% 0',\n      ...transition(SLOW, ['transform']),\n      ':hover, &.isActive': {\n        '&': {\n          transform: 'rotateX(30deg)'\n        },\n        '.depth': {\n          transform: 'translateY(0px)'\n        },\n        '.gloss': {\n          backgroundPosition: '0 0'\n        }\n      }\n    }}>\n    <Box\n      className='depthContainer'\n      sx={{\n        position: 'absolute',\n        overflow: 'hidden',\n        top: '50%',\n        height: `${size / 2 + DEPTH}px`,\n        left: 0,\n        right: 0\n      }}>\n      <Box\n        className='depth'\n        sx={{\n          left: 0,\n          right: 0,\n          height: '100%',\n          transform: `translateY(${-DEPTH}px)`,\n          backgroundImage: 'linear-gradient(to right, #FFD784 0%, #6A5643 3%, #6A5643 97%, #FFD784 100%)',\n          borderBottomLeftRadius: `${size}px`,\n          borderBottomRightRadius: `${size}px`,\n          ...transition(SLOW, ['transform'])\n        }}\n      />\n    </Box>\n    <Box\n      sx={{\n        position: 'absolute',\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 0,\n        backgroundImage: `url(${url})`,\n        backgroundColor: '#E1B774',\n        backgroundSize: 'cover',\n        borderRadius: '100%',\n        boxShadow: 'inset 0 2px 3px rgba(255, 255, 255, 0.5), inset 0 -2px 3px rgba(0, 0, 0, 0.3)'\n      }}>\n      <Box\n        className='gloss'\n        sx={{\n          ...transition(SLOW, ['background-position']),\n          position: 'absolute',\n          left: 0,\n          right: 0,\n          top: 0,\n          bottom: 0,\n          borderRadius: '100%',\n          backgroundImage: 'linear-gradient(to bottom, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 50%)',\n          backgroundRepeat: 'repeat-x',\n          backgroundSize: '200% 200%',\n          backgroundPosition: '0 100%'\n        }}\n      />\n    </Box>\n  </Box>\n)\n\nToken.propTypes = tokenProps\n\nexport default Token\n","import React, { FunctionComponent } from 'react'\nimport PropTypes, { InferProps, Validator } from 'prop-types'\nimport { Box, Flex, Heading } from '@theme-ui/components'\nimport { ACTION_COST_GROW, ACTION_COST_PURCHASE, ACTION_COST_SEED, Color, GrowthStage } from '../../3d/constants'\nimport { useGame } from '../../Game/GameContext'\nimport { Room } from '../../lib/Room'\nimport { useColorMode } from '@theme-ui/color-modes'\nimport { colorsFromPlayerColor } from '../../utils/colors'\nimport { ImageStack } from '../common/ImageStack'\nimport { getTreeImageByColorGrowthStage } from '../TreeTokenStack'\nimport { SunlightBadge } from '../SunlightBadge'\nimport { GameActions } from '../../Game/Game'\nimport { InteractionState } from '../GamePlayer'\nimport { darken } from 'polished'\nimport IconText from '../common/IconText'\nimport { mdiLeaf, mdiWhiteBalanceSunny } from '@mdi/js'\nimport { reverse } from 'ramda'\nimport { TreeSlot } from './TreeSlot'\n\nconst GROWTH_STAGE_SIZES: { [k in GrowthStage]: number[] } = {\n  [GrowthStage.SEED]: [45, 50],\n  [GrowthStage.SHORT]: [45, 50],\n  [GrowthStage.MID]: [65, 76],\n  [GrowthStage.TALL]: [98, 115]\n}\n\nconst stationProps = {\n  playerColor: PropTypes.number.isRequired as Validator<Color>,\n  interactionStateReducer: PropTypes.func.isRequired as Validator<(patch: Partial<InteractionState>) => void>\n}\n\ntype StationProps = InferProps<typeof stationProps>\n\nconst Station: FunctionComponent<StationProps> = ({ playerColor, interactionStateReducer }) => {\n  const [game] = useGame()\n  const [colorMode] = useColorMode()\n\n  const state = game.state\n  if (state === undefined) {\n    return null\n  }\n\n  const [bg, text] = colorsFromPlayerColor(colorMode, playerColor)\n\n  const playerInfo = state.playerInfo[playerColor]\n  const isMine = game.mi === playerColor\n  const possessiveNoun = isMine ? 'My' : (Room.getName(game.room.state, playerColor) + '\\'s')\n\n  const handlerAvailableTokenClick = (growthStage: GrowthStage): void => {\n    if (growthStage === GrowthStage.SEED) {\n      interactionStateReducer({ action: GameActions.PLANT_SEED })\n    } else {\n      interactionStateReducer({ action: GameActions.GROW_TREE, growthStage: growthStage - 1 })\n    }\n  }\n\n  return (\n    <Flex\n      sx={{\n        position: 'absolute',\n        bottom: 0,\n        right: 0,\n        width: '100vw',\n        maxWidth: ['320px', '380px'],\n        flexDirection: 'column',\n        borderTopLeftRadius: 2,\n        backgroundColor: 'bgPales.0'\n      }}>\n      <Box\n        mt={2}\n        ml={3}\n        sx={{\n          color: text,\n          fontSize: 4,\n          textShadow: '0 3px 6px rgba(0, 0, 0, 0.2)'\n        }}>{possessiveNoun} Station</Box>\n      <Flex\n        px={3}\n        py={1}\n        sx={{\n          boxShadow: 'inset 0 3px 6px rgba(0, 0, 0, 0.3)',\n          background: `linear-gradient(to bottom, ${darken(0.15)(bg)}, ${darken(0.1)(bg)})`,\n          flexDirection: 'row',\n          '> *': { flex: 1 }\n        }}>\n        <IconText\n          path={mdiWhiteBalanceSunny}\n          color='text'\n          mr={2}\n          size={['16px', '20px']}\n          iconMargin={2}>\n          {playerInfo.lightPoint}\n        </IconText>\n        <IconText\n          path={mdiLeaf}\n          color='text'\n          size={['16px', '20px']}\n          iconMargin={2}>\n          {playerInfo.score}\n        </IconText>\n      </Flex>\n      <Flex\n        mt={2}\n        sx={{\n          position: 'relative',\n          flexDirection: 'column'\n        }}>\n        <Heading mb={1} variant='subheading' ml={3}>Available</Heading>\n        <Flex ml={3}>{Object.entries(playerInfo.availableArea).map(([growthStage, amount]) => {\n          const cost = Number.parseInt(growthStage) === GrowthStage.SEED ? ACTION_COST_SEED : ACTION_COST_GROW[Number.parseInt(growthStage) - 1 as GrowthStage]\n          return (\n            <Box key={growthStage} sx={{ position: 'relative' }}>\n              <ImageStack\n                key={growthStage}\n                onClick={(isMine && playerInfo.lightPoint >= cost && (state.preparingRound <= 0 || growthStage === GrowthStage.SHORT.toString())) ? () => handlerAvailableTokenClick(Number.parseInt(growthStage)) : undefined}\n                imgPath={getTreeImageByColorGrowthStage(playerInfo.color, Number.parseInt(growthStage))}\n                enabled={amount === 0 ? [false] : undefined}\n                stack={new Array(Math.max(1, amount)).fill(\n                  <SunlightBadge\n                    myPoints={playerInfo.lightPoint}\n                    sx={{\n                      top: 0,\n                      right: '-4px',\n                      position: 'absolute'\n                    }}>\n                    {cost}\n                  </SunlightBadge>\n                )}\n                badge={amount}\n              />\n            </Box>\n          )\n        })}\n        </Flex>\n      </Flex>\n      <Flex\n        sx={{\n          position: 'relative',\n          flexDirection: 'column'\n        }}>\n        <Heading mb={1} variant='subheading' ml={3}>Player Board</Heading>\n        <Flex\n          sx={{\n            flexDirection: 'row',\n            alignItems: 'stretch',\n            justifyContent: 'space-between',\n            padding: '4px',\n            pb: '30px',\n            ml: 2,\n            borderWidth: '1px',\n            borderStyle: 'solid',\n            borderColor: text,\n            borderTopLeftRadius: 1,\n            borderRight: 'none',\n            borderBottom: 'none'\n          }}>\n          {Object.entries(playerInfo.playerBoard).map(([key, slots]) => {\n            const growthStage = Number.parseInt(key) as GrowthStage\n            const size = GROWTH_STAGE_SIZES[growthStage]\n            return (\n              <Flex\n                key={key}\n                sx={{\n                  flexDirection: 'column',\n                  justifyContent: 'space-between'\n                }}>\n                {reverse(slots).map((isAvailable, i, arr) => (\n                  <TreeSlot\n                    key={i}\n                    size={size}\n                    color={playerColor}\n                    growthStage={growthStage}\n                    isAvailable={isAvailable}\n                    costingPoints={ACTION_COST_PURCHASE[growthStage][arr.length - 1 - i]}\n                    myPoints={playerInfo.lightPoint}\n                  />\n                ))}\n              </Flex>\n            )\n          })}\n        </Flex>\n      </Flex>\n    </Flex>\n  )\n}\n\nStation.propTypes = stationProps\n\nexport default Station\n","import React, { FunctionComponent, useCallback, useMemo, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport { useGame } from '../Game/GameContext'\nimport { Box, Flex, Heading, Text } from '@theme-ui/components'\nimport { AppState } from './App'\nimport { useRoom } from '../lib/RoomContext'\nimport { Panel } from './Panel'\nimport { Axial } from '../3d/Coordinates/Axial'\nimport { COLOR_VALUES, GROWTH_STAGE_NAME, GrowthStage } from '../3d/constants'\nimport { GameActions } from '../Game/Game'\nimport { useAlert } from './common/AlertContext'\nimport { Popper } from './Popper'\nimport { Card } from './common/Card'\nimport { SLOW, transition } from '../theme/transitions'\nimport Button from './common/Button'\nimport { useConfirm } from './common/ConfirmContext'\nimport StationHUD from './playerStation/StationHUD'\n\nconst propTypes = {\n  setState: PropTypes.func.isRequired\n}\n\nexport interface InteractionState {\n  source?: Axial\n  target?: Axial\n  growthStage?: GrowthStage\n  popperCoord?: [number, number]\n  axial?: Axial\n  action?: GameActions\n}\n\nexport const GamePlayer: FunctionComponent<PropTypes.InferProps<typeof propTypes>> = ({ setState }) => {\n  const [game] = useGame()\n  const room = useRoom()\n  const confirm = useConfirm()\n  const [interactionState, setInteractionState] = useState<InteractionState>({})\n  const interactionStateReducer = (patch: Partial<InteractionState> | undefined): void => {\n    let newState = patch === undefined ? {} : { ...interactionState, ...patch }\n    if (newState.action === GameActions.PLANT_SEED && newState.popperCoord !== undefined) {\n      if (game.state?.board[newState.axial?.toString() ?? '']?.growthStage === undefined) {\n        newState = { ...newState, target: newState.axial, popperCoord: undefined }\n      } else {\n        newState = { ...newState, source: newState.axial, popperCoord: undefined }\n      }\n    }\n    if (newState.action === GameActions.PURCHASE && newState.growthStage !== undefined) {\n      console.log('purchase')\n      game.purchase(newState.growthStage).catch(errorHandler)\n      newState = {}\n    }\n    if (newState.action === GameActions.END_TURN) {\n      console.log('end turn')\n      game.endTurn().catch(errorHandler)\n      newState = {}\n    }\n    if (newState.action === GameActions.PLANT_SEED && newState.source !== undefined && newState.target !== undefined) {\n      console.log('plant seed')\n      game.plantSeed(newState.source, newState.target).catch(errorHandler)\n      newState = {}\n    }\n    if (newState.action === GameActions.GROW_TREE && newState.axial !== undefined) {\n      console.log('grow tree')\n      const growthStageOfTile: GrowthStage | undefined = game.state?.board[newState.axial.toString()]?.growthStage\n      console.log('have slot', growthStageOfTile !== undefined, game.state !== undefined, growthStageOfTile !== undefined && game.state !== undefined && !game.haveSlot(game.state, game.mi, growthStageOfTile))\n      if (growthStageOfTile !== undefined && game.state !== undefined && !game.haveSlot(game.state, game.mi, growthStageOfTile)) {\n        confirm(`No empty slots on your purchase board. Proceed and lose your ${GROWTH_STAGE_NAME[growthStageOfTile]}`)\n          .then((yes) => {\n            if (yes && newState.axial !== undefined) {\n              game.growTree(newState.axial).catch(errorHandler)\n            }\n            setInteractionState({})\n          }).catch(errorHandler)\n      } else {\n        game.growTree(newState.axial).catch(errorHandler)\n        newState = {}\n      }\n    }\n    setInteractionState(newState)\n  }\n  const alert = useAlert()\n  const errorHandler = useCallback((e: Error) => {\n    console.log(e)\n    alert(e.message)\n  }, [alert])\n  const isPreparationRound = (game.state?.preparingRound ?? 1) > 0\n  const hintText: string = useMemo(() => {\n    if (interactionState.action !== undefined) {\n      switch (interactionState.action) {\n        case GameActions.GROW_TREE:\n          return !isPreparationRound && interactionState.axial === undefined ? `Select a ${interactionState.growthStage !== undefined ? GROWTH_STAGE_NAME[interactionState.growthStage] : 'tree'} to grow` : ''\n        case GameActions.PLANT_SEED:\n          if (interactionState.source === undefined) {\n            return 'Select a tree as seed source tree'\n          } else if (interactionState.target === undefined) {\n            return 'Select an empty tile to plant seed'\n          }\n      }\n    }\n    return ''\n  }, [isPreparationRound, interactionState])\n  const nextRound = (): void => {\n    game.gameWorld.resetBoard()\n    setState(AppState.ROOM)\n  }\n  const gameOver = game.state?.gameOver\n  const flag = gameOver !== undefined\n  return (\n    <>\n      <Box>\n        {game.started && (\n          <Box\n            sx={{\n              position: 'fixed',\n              top: 0,\n              right: 0,\n              left: 0,\n              bottom: 0,\n              pointerEvents: 'none',\n              boxShadow: (hintText !== '' ? `inset 0 0 100px #${COLOR_VALUES[game.mi].toString(16)}` : undefined),\n              ...transition(SLOW, ['box-shadow'])\n            }}\n          />)\n        }\n        <Heading sx={{ position: 'fixed', top: 0, width: '100%', textAlign: 'center' }}>{hintText}</Heading>\n        <Popper interactionState={interactionState} interactionStateReducer={interactionStateReducer} game={game}/>\n        <Card\n          sx={{\n            position: 'fixed',\n            top: (flag ? '50%' : '200%'),\n            left: '50%',\n            transform: 'translate(-50%, -50%)',\n            ...transition(SLOW, ['top'])\n          }}>\n          <Heading>Game Over</Heading>\n          <Text>{gameOver}</Text>\n          <Button variant='primary' mt={3} onClick={nextRound}>Next Round</Button>\n        </Card>\n        <Flex\n          sx={{\n            width: '100vw',\n            flexDirection: 'column',\n            justifyContent: 'space-between',\n            justifyItems: 'center',\n            position: 'absolute',\n            left: 0,\n            bottom: 0\n          }}>\n          <Panel\n            mi={game.started ? game.mi : undefined}\n            roomState={room.state}\n            interactionStateReducer={interactionStateReducer}\n          />\n        </Flex>\n      </Box>\n      {\n        process.env.NODE_ENV !== 'production'\n          ? (\n          <StationHUD interactionStateReducer={interactionStateReducer}/>\n            )\n          : null\n      }\n    </>\n  )\n}\n\nGamePlayer.propTypes = propTypes\n","import React, { FunctionComponent, useState } from 'react'\nimport NavBar from './NavBar'\nimport { transition } from '../theme/transitions'\nimport { Home } from './Home'\nimport { Room } from './Room'\nimport { GameContextProvider } from '../Game/GameContext'\nimport { GamePlayer } from './GamePlayer'\nimport { withAlertQueue } from './common/AlertContext'\nimport GameRenderer from './GameRenderer'\nimport { Box, Flex } from '@theme-ui/components'\nimport RevolutionCounter from './RevolutionCounter'\nimport { withConfirmQueue } from './common/ConfirmContext'\n\nexport enum AppState {\n  HOME,\n  ROOM,\n  GAME\n}\n\nconst App: FunctionComponent = () => {\n  const [state, setState] = useState(AppState.HOME)\n  return (\n    <Box>\n      <NavBar setState={setState} state={state}/>\n      <Box sx={{ width: '100vw', height: '100vh', overflow: 'hidden', position: 'relative' }}>\n        <GameContextProvider>\n          <GameRenderer/>\n          <Flex\n            sx={{\n              width: '100vw',\n              bottom: 0,\n              left: `${-(state - 2) * 100}%`,\n              position: 'absolute',\n              ...transition(0.3, ['left'], 'linear')\n            }}>\n            <GamePlayer setState={setState}/>\n          </Flex>\n          <Flex\n            sx={{\n              width: '100vw',\n              height: '100vh',\n              left: `${-(state - 1) * 100}%`,\n              justifyContent: 'center',\n              alignItems: 'center',\n              position: 'absolute',\n              ...transition(0.3, ['left'], 'linear')\n            }}>\n            <Room setState={setState}/>\n          </Flex>\n          <Flex\n            sx={{\n              width: '100vw',\n              height: '100vh',\n              left: `${-state * 100}%`,\n              justifyContent: 'center',\n              alignItems: 'center',\n              position: 'absolute',\n              ...transition(0.3, ['left'], 'linear')\n            }}>\n            <Home setState={setState}/>\n            {\n              // <TestPanel setState={setState}/>\n            }\n          </Flex>\n          <Box sx={{ position: 'fixed', top: '60px', left: '0' }}>\n            <RevolutionCounter/>\n          </Box>\n        </GameContextProvider>\n      </Box>\n    </Box>\n  )\n}\n\nexport default withConfirmQueue(withAlertQueue(App))\n","import React, { FunctionComponent, useEffect, useRef } from 'react'\nimport { Box } from '@theme-ui/components'\nimport { WebGLRendererSystem } from 'ecsy-three'\nimport { useGame } from '../Game/GameContext'\n\nconst GameRenderer: FunctionComponent = () => {\n  const ref = useRef<HTMLDivElement | null>(null)\n  const [game] = useGame()\n  const gameWorld = game.gameWorld\n\n  useEffect(() => {\n    const divElem = ref.current\n    if (divElem !== null) {\n      divElem.childNodes.forEach(child => {\n        divElem.removeChild(child)\n      })\n      divElem.appendChild(gameWorld.renderer.domElement)\n      gameWorld.world.getSystem(WebGLRendererSystem)?.onResize()\n    }\n  }, [ref, gameWorld.renderer.domElement, gameWorld.world])\n\n  return (\n    <Box\n      ref={ref}\n      sx={{\n        width: '100vw',\n        height: '100vh',\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n        canvas: {\n          width: '100%',\n          height: '100%'\n        }\n      }}\n    />\n  )\n}\n\nexport default GameRenderer\n","export default (x: number): number =>\n  x < 0.5 ? 8 * x * x * x * x : 1 - Math.pow(-2 * x + 2, 4) / 2\n","import { FunctionComponent, useMemo } from 'react'\nimport { Animate, HashMap, NodeGroup } from 'react-move'\nimport { SUN_ROTATION_DURATION, TAU } from '../3d/constants'\nimport { getColor } from '@theme-ui/color'\nimport { useThemeUI } from '@theme-ui/core'\nimport { Box, BoxProps } from '@theme-ui/components'\nimport { darken, lighten } from 'polished'\nimport { useGame } from '../Game/GameContext'\nimport easeInOut from '../Game/easing/1d/easeInOut'\nimport easeInOutQuart from '../Game/easing/1d/easeInOutQuart'\n\nconst getRemainingSlices = (elapsedRounds: number, circleIndex: number): number => {\n  if (elapsedRounds / 6 < circleIndex) {\n    return 6\n  } else if (elapsedRounds / 6 >= circleIndex + 1) {\n    return 0\n  } else {\n    return 6 - elapsedRounds % 6\n  }\n}\n\nconst isPieEnlarged = (elapsedRounds: number, circleIndex: number): boolean => {\n  return elapsedRounds / 6 >= circleIndex\n}\n\nconst getCoordinatesOnCircle = (percentageRemaining: number): { x: number, y: number } => {\n  return {\n    x: -Math.sin(TAU * percentageRemaining),\n    y: -Math.cos(TAU * percentageRemaining)\n  }\n}\n\nconst BORDER_WIDTH = 0.08\n\nconst RevolutionCounter: FunctionComponent<BoxProps> = ({\n  ...boxProps\n}) => {\n  const [game] = useGame()\n  const state = game.state\n  const preparingRounds = state?.preparingRound ?? 0\n  const isPreparation = preparingRounds > 0\n  const totalRounds = isPreparation ? 6 : (state?.totalRevolutions ?? 0) * 6\n  const elapsedRounds = isPreparation ? 6 - preparingRounds : totalRounds - (state?.revolutionLeft ?? 0) * 6 + (6 - (state?.rayDirection ?? 0)) % 6\n\n  // eslint-disable-next-line\n  const circleIndexes = useMemo(() => [...Array(Math.ceil(totalRounds / 6)).keys()], [elapsedRounds, totalRounds])\n  const { theme } = useThemeUI()\n\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n  const bg = getColor(theme, 'bgs.2') as string\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n  const accent = getColor(theme, isPreparation ? 'blue.0' : 'yellow.0') as string\n  const shadow = darken(0.1, bg)\n  const highlight = lighten(0.1, bg)\n  const { sx, ...otherBoxProps } = boxProps\n  // eslint-disable-next-line\n  const updateNodeGroup = (_: any, i: number): HashMap[] => [\n    {\n      remaining: [Math.min(0.9999, getRemainingSlices(elapsedRounds, i) / 6)],\n      timing: { duration: SUN_ROTATION_DURATION * 1000, ease: easeInOut }\n    },\n    {\n      scale: [isPieEnlarged(elapsedRounds, i) ? 1 : 0.3],\n      x: [isPieEnlarged(elapsedRounds, i) ? 0 : i - Math.floor((elapsedRounds) / 6) + 0.85],\n      timing: { duration: SUN_ROTATION_DURATION * 1000, ease: easeInOutQuart }\n    }\n  ]\n  return (\n    <Box\n      sx={{\n        text: {\n          fill: 'text'\n        },\n        userSelect: 'none',\n        ...sx\n      }}\n      {...otherBoxProps}>\n      <svg width={250} height={80} viewBox='0 0 6 2.2' shapeRendering='crisp-edges'>\n        <title>\n          {`${totalRounds - elapsedRounds}${isPreparation ? ' preparation' : ''} turns remaining`}\n        </title>\n        <defs>\n          <filter id='tintBlue'>\n            <feColorMatrix type='matrix' values='0 0 1 0.1 0 0 0.5 0.9 0.1 0 0 0 0.7 0.8 0 0 0 0 1 0'/>\n          </filter>\n          <filter id='shadow'>\n            <feDropShadow dx={0} dy={0.035} stdDeviation={0.05} floodOpacity={0.25}/>\n          </filter>\n          <clipPath id='frame'>\n            <circle cx={0} cy={0} r={1}/>\n          </clipPath>\n          <g id='hexBorderBase' clipPath='url(#frame)'>\n            <circle cx={0} cy={0} r={1} stroke='white' strokeWidth={BORDER_WIDTH * 2} fill='none'/>\n            <circle cx={0} cy={0} r={0.5} fill='white'/>\n            <g>\n              <rect\n                transform={`translate(${-BORDER_WIDTH / 2} 0)`}\n                y={-1}\n                width={BORDER_WIDTH}\n                height={2}\n                fill='white'\n              />\n            </g>\n            <g transform='rotate(60)'>\n              <rect\n                transform={`translate(${-BORDER_WIDTH / 2} 0)`}\n                y={-1}\n                width={BORDER_WIDTH}\n                height={2}\n                fill='white'\n              />\n            </g>\n            <g transform='rotate(120)'>\n              <rect\n                transform={`translate(${-BORDER_WIDTH / 2} 0)`}\n                y={-1}\n                width={BORDER_WIDTH}\n                height={2}\n                fill='white'\n              />\n            </g>\n          </g>\n          <mask id='hexBorder'>\n            <use xlinkHref='#hexBorderBase'/>\n          </mask>\n          <radialGradient id='containerFg' cx={0.5} cy={0} r={0.8} fx={0.5} fy={0.2}>\n            <stop\n              style={{ stopColor: highlight, stopOpacity: 1 }}\n              offset='0'\n            />\n            <stop\n              style={{ stopColor: shadow, stopOpacity: 1 }}\n              offset='1'\n            />\n          </radialGradient>\n          <radialGradient id='containerBg' cx={0.5} cy={1} r={1} fx={0.5} fy={0.8}>\n            <stop\n              style={{ stopColor: highlight, stopOpacity: 1 }}\n              offset='0'\n            />\n            <stop\n              style={{ stopColor: shadow, stopOpacity: 1 }}\n              offset='1'\n            />\n          </radialGradient>\n          <linearGradient\n            id='linearGradient2171'>\n            <stop\n              style={{ stopColor: '#fff9a9', stopOpacity: 0.37254903 }}\n              offset='0'\n              id='stop2165'\n            />\n            <stop\n              style={{ stopColor: '#ffef96', stopOpacity: 0.1021999 }}\n              offset='0.5'\n              id='stop2167'\n            />\n            <stop\n              style={{ stopColor: '#ffec63', stopOpacity: 0.00264023 }}\n              offset='0.75'\n              id='stop2173'\n            />\n            <stop\n              style={{ stopColor: '#ffea30', stopOpacity: 0 }}\n              offset='1'\n              id='stop2169'\n            />\n          </linearGradient>\n          <linearGradient\n            id='linearGradient2131'>\n            <stop\n              style={{ stopColor: '#fffded', stopOpacity: 0.81651807 }}\n              offset='0'\n              id='stop2127'\n            />\n            <stop\n              style={{ stopColor: '#fffcdf', stopOpacity: 0.53720075 }}\n              offset='0.5'\n              id='stop2137'\n            />\n            <stop\n              style={{ stopColor: '#ffffff', stopOpacity: 0 }}\n              offset='1'\n              id='stop2129'\n            />\n          </linearGradient>\n          <radialGradient\n            href='#linearGradient1018'\n            id='radialGradient1020'\n            cx='77.560883'\n            cy='67.446457'\n            fx='77.560883'\n            fy='67.446457'\n            r='64.468956'\n            gradientUnits='userSpaceOnUse'\n            gradientTransform='matrix(0.73371669,1.2708346,-1.0409322,0.60099607,93.712059,-58.333995)'\n          />\n          <linearGradient\n            id='linearGradient1018'>\n            <stop\n              style={{ stopColor: '#fff82e', stopOpacity: 1 }}\n              offset='0'\n              id='stop1014'\n            />\n            <stop\n              style={{ stopColor: '#ff8600', stopOpacity: 1 }}\n              offset='1'\n              id='stop1016'\n            />\n          </linearGradient>\n          <radialGradient\n            href='#linearGradient1820'\n            id='radialGradient1020-8'\n            cx='88.773727'\n            cy='63.517612'\n            fx='88.773727'\n            fy='63.517612'\n            r='64.468956'\n            gradientUnits='userSpaceOnUse'\n            gradientTransform='matrix(0.44201773,0.75138827,-0.74632483,0.43904328,100.8945,-1.9339557)'\n          />\n          <linearGradient\n            id='linearGradient1820'>\n            <stop\n              style={{ stopColor: '#fff4b4', stopOpacity: 0 }}\n              offset='0'\n              id='stop1816'\n            />\n            <stop\n              style={{ stopColor: '#f0ba5a', stopOpacity: 0 }}\n              offset='0.75'\n              id='stop1822'\n            />\n            <stop\n              style={{ stopColor: '#fff274', stopOpacity: 0.84705889 }}\n              offset='1'\n              id='stop1818'\n            />\n          </linearGradient>\n          <radialGradient\n            href='#linearGradient2131'\n            id='radialGradient2133'\n            cx='93.525307'\n            cy='68.181641'\n            fx='93.525307'\n            fy='68.181641'\n            r='44.625431'\n            gradientTransform='matrix(0.98276729,0.00528918,-0.00322951,0.60285783,2.0475808,25.053584)'\n            gradientUnits='userSpaceOnUse'\n          />\n          <radialGradient\n            href='#linearGradient2171'\n            id='radialGradient2133-3'\n            cx='93.525307'\n            cy='68.181641'\n            fx='93.525307'\n            fy='68.181641'\n            r='44.625431'\n            gradientTransform='matrix(0.61266046,0.00270719,-0.00201328,0.30856342,-104.25485,155.02083)'\n            gradientUnits='userSpaceOnUse'\n          />\n          <g\n            id='sun'\n            transform='scale(0.017896362) translate(-92.862984 -92.967812)'\n            filter={isPreparation ? 'url(#tintBlue)' : undefined}>\n            <g\n              id='layer3'>\n              <circle\n                fill='url(#radialGradient1020)'\n                fillOpacity='1'\n                id='path1012'\n                cx='92.862984'\n                cy='92.967812'\n                r='55.877277'\n              />\n            </g>\n            <g\n              id='layer6'>\n              <circle\n                fill='url(#radialGradient1020-8)'\n                fillOpacity='1'\n                id='path1012-2'\n                cx='92.862984'\n                cy='92.967812'\n                r='55.877277'\n              />\n            </g>\n            <g\n              id='layer7'>\n              <ellipse\n                fill='url(#radialGradient2133)'\n                fillOpacity='1'\n                id='path2125'\n                cx='93.247475'\n                cy='68.206581'\n                rx='44.625431'\n                ry='29.568932'\n              />\n              <ellipse\n                fill='url(#radialGradient2133-3)'\n                fillOpacity='1'\n                id='path2125-9'\n                cx='-47.400539'\n                cy='177.10806'\n                rx='27.819649'\n                ry='15.134401'\n                transform='matrix(0.68938617,-0.72439403,0.85105199,0.52508144,0,0)'\n              />\n            </g>\n          </g>\n        </defs>\n        <g transform='translate(1 1.05)'>\n          <circle cx={0} cy={0} r={1} fill='url(#containerBg)'/>\n          <NodeGroup\n            data={circleIndexes}\n            keyAccessor={(x: number) => x.toString()}\n            start={(_, i) => ({\n              remaining: Math.min(0.9999, getRemainingSlices(elapsedRounds, i) / 6),\n              scale: 0,\n              x: isPieEnlarged(elapsedRounds, i) ? 0 : i - Math.floor((elapsedRounds) / 6) + 0.85\n            })}\n            update={updateNodeGroup}\n            enter={updateNodeGroup}\n            leave={() => ({\n              scale: 0,\n              timing: { duration: SUN_ROTATION_DURATION * 1000, ease: easeInOutQuart }\n            })}>\n            {nodes => (\n              <g>\n                {nodes.map(({ key, state: { remaining, scale, x } }: { key: string, state: { remaining: number, scale: number, x: number } }) => {\n                  const isLargeArc = remaining >= 0.5 ? 1 : 0\n                  const { x: arcX, y: arcY } = getCoordinatesOnCircle(remaining)\n                  const maskId = `mask-${key}`\n                  return (\n                    <g key={key} transform={`translate(${x} 0) scale(${scale})`}>\n                      <defs>\n                        <clipPath id={maskId}>\n                          <path\n                            d={`M 0 -1 A 1 1 0 ${isLargeArc} 0 ${arcX.toString()} ${arcY.toString()} L 0 0 Z`}\n                          />\n                        </clipPath>\n                      </defs>\n                      <g clipPath={`url(#${maskId})`}>\n                        <use href='#sun'/>\n                      </g>\n                    </g>\n                  )\n                })}\n              </g>\n            )}\n          </NodeGroup>\n          <Animate\n            start={{\n              rotation: elapsedRounds * 60\n            }}\n            update={{\n              rotation: [elapsedRounds * 60],\n              timing: { duration: 2000, ease: easeInOut }\n            }}>\n            {({ rotation }) => {\n              return (\n                <path\n                  d='M 0 -1 A 1 1 0 0 0 -0.8660254037844386 -0.5000000000000001 L 0 0 Z'\n                  fill={accent}\n                  transform={`rotate(${60 + (rotation as number)})`}\n                />\n              )\n            }}\n          </Animate>\n          <use xlinkHref='#hexBorderBase' filter='url(#shadow)'/>\n          <g mask='url(#hexBorder)'>\n            <circle cx={0} cy={0} r={1} fill='url(#containerFg)'/>\n          </g>\n          <text fontSize={0.6} textAnchor='middle' dy={0.2}>\n            {totalRounds - elapsedRounds}\n          </text>\n        </g>\n      </svg>\n    </Box>\n  )\n}\n\nexport default RevolutionCounter\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.0/8 are considered localhost for IPv4.\n  /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/.exec(window.location.hostname)\n)\n\ninterface Config {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register (config?: Config): void {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    )\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        }).catch(console.error)\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW (swUrl: string, config?: Config): void {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller !== null) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config?.onUpdate !== undefined) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              config?.onSuccess?.(registration)\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker (swUrl: string, config?: Config): void {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && !contentType.includes('javascript'))\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          }).catch(console.error)\n        }).catch(console.error)\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister (): void {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister().catch(console.error)\n      })\n      .catch((error: Error) => {\n        console.error(error.message)\n      })\n  }\n}\n","import React, { VFC } from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './components/App'\nimport * as serviceWorker from './serviceWorker'\nimport { Global } from '@emotion/react'\nimport theme from './theme'\nimport { ThemeProvider } from '@theme-ui/core'\nimport { startLoad } from './3d/assets'\nimport { Theme } from '@theme-ui/css'\nimport { omit } from 'ramda'\nimport { ColorModeProvider } from '@theme-ui/color-modes'\n\nconst omitTheme = omit(['theme'])\n\nconst MyGlobal: VFC = () => (\n  <Global\n    styles={(theme: Theme) => ({\n      body: omitTheme(theme.styles?.body),\n      '*': omitTheme(theme.styles?.['*']),\n      a: omitTheme(theme.styles?.a)\n    })}\n  />\n)\n\nReactDOM.render(\n  <React.StrictMode>\n    <ThemeProvider theme={theme}>\n      <MyGlobal/>\n      <ColorModeProvider>\n        <App/>\n      </ColorModeProvider>\n    </ThemeProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\nstartLoad()\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}