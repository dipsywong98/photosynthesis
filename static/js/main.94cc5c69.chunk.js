(this.webpackJsonpphotosynthesis=this.webpackJsonpphotosynthesis||[]).push([[0],{67:function(e,t,n){e.exports=n(86)},72:function(e,t,n){},74:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=74},86:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(50),i=n.n(a),c=(n(72),n(6)),s=n(13),u=n(23),l=n(40),d=n(9),h=n(8),f=n.n(h),v=n(11),b=n(1),p=n(18),m=n(5),O=n(3),g=n(4),y=n(17),E=n(14),j=n(89),w=n(88);function k(e){return"function"===typeof e}var C,x,S=function(){function e(){Object(b.a)(this,e),this._onEventListeners={},this._onceEventListeners={}}return Object(m.a)(e,[{key:"on",value:function(e,t){var n=this._onEventListeners[e];void 0===n&&(n=this._onEventListeners[e]={});var r=Object(j.a)();return n[r]=t,r}},{key:"onMatch",value:function(e,t,n){return this.on(e,(function(e){k(n)?n(e)&&t(e):(Object(w.a)(n,e)||"object"===typeof n&&null!==n&&"_"in n&&Object.keys(n._).reduce((function(t,r){return t&&Object(w.a)(n._[r],e[r])}),!0))&&t(e)}))}},{key:"once",value:function(e,t){var n=this._onceEventListeners[e];void 0===n&&(n=this._onceEventListeners[e]={});var r=Object(j.a)();return n[r]=t,r}},{key:"onceMatch",value:function(e,t,n){return this.once(e,(function(e,r){k(n)?n(e)?t(e,r):null===r||void 0===r||r():Object(w.a)(n,e)||"object"===typeof n&&null!==n&&"_"in n&&Object.keys(n._).reduce((function(t,r){return t&&Object(w.a)(n._[r],e[r])}),!0)?t(e,r):null===r||void 0===r||r()}))}},{key:"until",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r=this,o=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:5e3,o.length>2?o[2]:void 0,e.next=4,new Promise((function(e,o){var a=window.setTimeout((function(){o(new Error(t.toString()+" timeout"))}),n);r.once(t,(function(t){window.clearTimeout(a),e(t)}))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"untilMatch",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){var r,o=this,a=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:5e3,a.length>3?a[3]:void 0,void 0!==n){e.next=4;break}throw new Error("expect undefined");case 4:return e.next=6,new Promise((function(e,a){var i=window.setTimeout((function(){a(new Error("".concat(t," ").concat(JSON.stringify(n)," timeout")))}),r);o.onceMatch(t,(function(t){window.clearTimeout(i),e(t)}),n)}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"off",value:function(e,t){var n,r,o,a;null===(n=this._onEventListeners)||void 0===n||(null===(r=n[e])||void 0===r||delete r[t]),null===(o=this._onceEventListeners)||void 0===o||(null===(a=o[e])||void 0===a||delete a[t])}},{key:"emit",value:function(e,t){var n,r,o,a,i,c,u=this;null===(n=Object.values(null!==(r=null===(o=this._onEventListeners)||void 0===o?void 0:o[e])&&void 0!==r?r:{}))||void 0===n||n.forEach((function(e){e(t)}));var l=[];null===(a=Object.entries(null!==(i=null===(c=this._onceEventListeners)||void 0===c?void 0:c[e])&&void 0!==i?i:{}))||void 0===a||a.forEach((function(e){var n=Object(s.a)(e,2),r=n[0],o=n[1],a=!1;o(t,(function(){a=!0})),a||l.push(r)})),l.forEach((function(t){u.off(e,t)}))}}]),e}();!function(e){e.ANY="*",e.PEER_OPEN="_open",e.PEER_CLOSE="_close",e.PEER_CONNECT="_connect",e.PEER_DISCONNECT="_disconnect",e.PEER_ERROR="_error",e.CONN_OPEN="open",e.CONN_CLOSE="close",e.CONN_DATA="data",e.CONN_ERROR="error",e.CONN_ACK="ack",e.CONN_PKG="pkg"}(C||(C={})),function(e){e.ALERT="alert",e.XD="xd",e[e.JOIN=0]="JOIN",e[e.MEMBER_CHANGE=1]="MEMBER_CHANGE",e[e.NEW_JOIN=2]="NEW_JOIN",e[e.ACK=3]="ACK",e[e.PLAYER_LEFT=4]="PLAYER_LEFT",e[e.CHANGE_HOST=5]="CHANGE_HOST",e[e.RENAME=6]="RENAME",e[e.START_GAME=7]="START_GAME",e[e.GAME_EVENT=8]="GAME_EVENT",e[e.UPDATE_GAME_STATE=9]="UPDATE_GAME_STATE",e[e.DISPATCH=10]="DISPATCH",e[e.SET_STATE=11]="SET_STATE"}(x||(x={}));var _=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(e,r){var o;return Object(b.a)(this,n),(o=t.call(this)).conn=void 0,o.manager=void 0,o.dataHandler=function(e){return function(t){var n=Object(s.a)(t,2),r=n[0],a=n[1];if(void 0!==a&&a._t!==x.ACK){var i,c=function(e){i=e};o.emit(C.CONN_DATA,{conn:Object(p.a)(o),data:a,ack:c}),"object"===typeof a&&void 0!==a._t&&o.emit(C.CONN_PKG,{conn:Object(p.a)(o),data:a.data,type:a._t,ack:c}),void 0!==e?e.send([r,{_t:x.ACK,data:i}]):void 0===i?o.dataHandler()([r,{_t:x.ACK,data:void 0}]):o.dataHandler()([r,{_t:x.ACK,data:i}])}else"object"===typeof a&&null!==a&&void 0!==a._t?o.emit(C.CONN_ACK,{conn:Object(p.a)(o),data:a.data,type:a._t,pid:r}):o.emit(C.CONN_ACK,{conn:Object(p.a)(o),data:a,pid:r})}},"self"!==e&&(o.conn=e,o.enrichConn(e)),o.manager=r,o}return Object(m.a)(n,[{key:"log",value:function(){var e;(e=this.manager).log.apply(e,arguments)}},{key:"id",get:function(){return void 0!==this.conn?this.conn.peer:this.manager.id}}]),Object(m.a)(n,[{key:"send",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,o=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(j.a)().split("-")[0],r=this.manager.untilMatch(C.CONN_ACK,(function(e){return e.pid===n})),void 0!==this.conn?this.conn.open?this.conn.send([n,t]):this.conn.on("open",(function(){var e;null===(e=o.conn)||void 0===e||e.send([n,t])})):this.dataHandler()([n,t]),e.next=5,r;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendPkg",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.send({data:n,_t:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e;null===(e=this.conn)||void 0===e||e.close(),this.emit(C.CONN_CLOSE,{conn:this})}},{key:"enrichConn",value:function(e){var t=this;return e.on("open",(function(){t.emit(C.CONN_OPEN,{conn:t})})),e.on("data",this.dataHandler(e)),e.on("error",(function(e){t.emit(C.CONN_ERROR,{conn:t,error:e})})),e.on("close",(function(){t.emit(C.CONN_CLOSE,{conn:t})})),e}},{key:"emit",value:function(e,t){Object(y.a)(Object(E.a)(n.prototype),"emit",this).call(this,e,t),this.manager.emit(e,t)}}]),n}(S),R=n(51),A=n.n(R),T=function(){function e(){var t=this;Object(b.a)(this,e),this.bufferSize=void 0,this.dataChannel=void 0,this.label="my label",this.metadata=void 0,this.open=!1,this.peer="peer",this.peerConnection=void 0,this.reliable=!0,this.serialization="binary",this.type="data",this.otherEnd=void 0,this.hostPeer=void 0,this.callbacks={},this.sent=[],window.setTimeout((function(){t.open=!0,t.trigger("open")}),1)}return Object(m.a)(e,[{key:"parse",value:function(){throw new Error("not implemented")}},{key:"stringify",value:function(e){throw new Error("not implemented")}},{key:"close",value:function(){var e=this;if(this.open){var t,n;if(this.open=!1,void 0!==this.hostPeer)this.hostPeer.connections=null===(t=this.hostPeer)||void 0===t?void 0:t.connections.filter((function(t){return t!==e}));if(void 0!==this.otherEnd)if(this.otherEnd.open=!1,void 0!==this.otherEnd.hostPeer)this.otherEnd.hostPeer.connections=null===(n=this.otherEnd.hostPeer)||void 0===n?void 0:n.connections.filter((function(t){return t!==e.otherEnd}));window.setTimeout((function(){var t;null===(t=e.otherEnd)||void 0===t||t.trigger("close"),e.trigger("close")}),1)}}},{key:"off",value:function(e,t,n){throw new Error("not implemented")}},{key:"on",value:function(e,t){e in this.callbacks||(this.callbacks[e]=[]),this.callbacks[e].push(t)}},{key:"trigger",value:function(e,t){var n;null===(n=this.callbacks[e])||void 0===n||n.forEach((function(e){e(t)}))}},{key:"send",value:function(e){var t;if(!this.open)throw new Error("Send data before opening");this.sent.push(e),Promise.resolve(null===(t=this.otherEnd)||void 0===t?void 0:t.trigger("data",e))}}]),e}(),N=function(){function e(){Object(b.a)(this,e),this.bufferSize=void 0,this.dataChannel=void 0,this.label="my label",this.metadata=void 0,this.open=!0,this.peer="peer",this.peerConnection=void 0,this.reliable=!0,this.serialization="binary",this.type="data",this.callbacks={},this.sent=[]}return Object(m.a)(e,[{key:"parse",value:function(){throw new Error("not implemented")}},{key:"stringify",value:function(e){return""}},{key:"close",value:function(){this.open=!1}},{key:"off",value:function(e,t,n){this.callbacks[e]=this.callbacks[e].filter((function(e){return e!==t}))}},{key:"trigger",value:function(e,t){var n;null===(n=this.callbacks[e])||void 0===n||n.forEach((function(e){return e(t)}))}},{key:"send",value:function(e){this.sent.push(e)}},{key:"answer",value:function(e,t){throw new Error("not implemented")}},{key:"on",value:function(e,t){e in this.callbacks||(this.callbacks[e]=[]),this.callbacks[e].push(t)}}]),e}(),M=function(){function e(t,n){var r=this;if(Object(b.a)(this,e),this.connections=[],this.destroyed=!1,this.disconnected=!1,this.id="some id",this.prototype=void 0,this.callbacks={},this.id=null!==t&&void 0!==t?t:Object(j.a)(),this.id in e.allPeers)throw new Error("Peer '".concat(this.id,"' already exist"));e.allPeers[this.id]=this,window.setTimeout((function(){r.trigger("open",r.id)}),1)}return Object(m.a)(e,[{key:"call",value:function(e,t,n){return new N}},{key:"connect",value:function(t,n){if(void 0===e.allPeers[t])throw new Error;var r=e.allPeers[t],o=new T,a=new T;return this.connections.push(o),r.connections.push(a),o.peer=t,a.peer=this.id,o.otherEnd=a,a.otherEnd=o,o.hostPeer=this,a.hostPeer=r,r.trigger("connection",a),o}},{key:"destroy",value:function(){this.destroyed=!0,this.connections.forEach((function(e){e.close()}));var t=e.allPeers,n=this.id,r=(t[n],Object(u.a)(t,[n].map(l.a)));e.allPeers=r}},{key:"disconnect",value:function(){this.disconnected=!0;var t=e.allPeers,n=this.id,r=(t[n],Object(u.a)(t,[n].map(l.a)));e.allPeers=r}},{key:"getConnection",value:function(e,t){var n;return null!==(n=this.connections.find((function(t){return t.peer===e})))&&void 0!==n?n:null}},{key:"listAllPeers",value:function(e){throw new Error("not implemented")}},{key:"off",value:function(e,t,n){throw new Error("not implemented")}},{key:"on",value:function(e,t){e in this.callbacks||(this.callbacks[e]=[]),this.callbacks[e].push(t)}},{key:"trigger",value:function(e,t){var n;null===(n=this.callbacks[e])||void 0===n||n.forEach((function(e){e(t)}))}},{key:"reconnect",value:function(){throw new Error("not implemented")}}]),e}();M.allPeers={};var P={peers:[],useFake:!1,make:function(e){var t,n,r,o=P.peers.shift();return void 0!==o?o:P.useFake?new M(e):void 0===Object({NODE_ENV:"production",PUBLIC_URL:"/photosynthesis",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PEER_HOST?new A.a(e):new A.a(e,{host:null!==(t=Object({NODE_ENV:"production",PUBLIC_URL:"/photosynthesis",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PEER_HOST)&&void 0!==t?t:"localhost",port:Number.parseInt(null!==(n=Object({NODE_ENV:"production",PUBLIC_URL:"/photosynthesis",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PEER_PORT)&&void 0!==n?n:"9000"),path:null!==(r=Object({NODE_ENV:"production",PUBLIC_URL:"/photosynthesis",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PEER_PATH)&&void 0!==r?r:"/peer"})}},H=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this)).id=void 0,r.peer=void 0,r.connections=[],r.closed=!1,r.log=function(){},r.onPeerOpenHandler=function(e){return function(t){r.id=t,r.emit(C.PEER_OPEN,{}),e.on("connection",r.onPeerConnectionHandler)}},r.onPeerConnectionHandler=function(e){r.log("connect",e.peer);var t=r.enrichConn(new _(e,Object(p.a)(r)));t.once(C.CONN_OPEN,(function(){r.emit(C.PEER_CONNECT,{conn:t})}))},r.peer=r.initPeer(e),r.id=r.peer.id,r.on(C.CONN_CLOSE,(function(e){var t=e.conn;void 0!==t&&(r.connections=r.connections.filter((function(e){return e.id!==t.id})))})),r}return Object(m.a)(n,[{key:"isClosed",value:function(){return this.closed||this.peer.disconnected}}],[{key:"prefixId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"creamy9tale000000"+e}},{key:"withPrefix",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new n(n.prefixId(e))}},{key:"startPrefix",value:function(){var e=Object(v.a)(f.a.mark((function e(){var t,r=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"",e.next=3,n.startAs(n.prefixId(t));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"startAs",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,r){var o=new n(t);o.once(C.PEER_OPEN,(function(){e(o)})),o.once(C.PEER_ERROR,(function(e){r(e.error)}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),Object(m.a)(n,[{key:"connect",value:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,o=this,a=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:5e3,void 0===(r=this.connections.find((function(e){return e.id===t})))){e.next=4;break}return e.abrupt("return",Promise.resolve(r));case 4:if(t!==this.id){e.next=6;break}return e.abrupt("return",this.enrichConn(new _("self",this)));case 6:return e.next=8,new Promise((function(e,r){var a=setTimeout((function(){}),n),i=o.once(C.PEER_ERROR,(function(e){var t=e.error;r(t)})),c=o.peer.connect(t),s=function(){var t=o.enrichConn(new _(c,o));o.off(C.CONN_ERROR,i),e(t),clearTimeout(a)};c.on("open",(function(){s()})),c.open&&s()}));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"connectPrefix",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connect(n.prefixId(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"broadcast",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.connections.map(function(){var e=Object(v.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.send(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"broadcastPkg",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.connections.map(function(){var e=Object(v.a)(f.a.mark((function e(r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.sendPkg(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"conn",value:function(e){var t=this.connections.find((function(t){return t.id===e}));if(void 0===t)throw new Error("connection lost with ".concat(e));return t}},{key:"send",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.conn(t).send(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendPkg",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.conn(t).sendPkg(n,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"initPeer",value:function(e){var t=this,n=P.make(e);return n.on("open",this.onPeerOpenHandler(n)),n.on("error",(function(e){t.emit(C.PEER_ERROR,{error:e})})),n.on("close",(function(){t.emit(C.PEER_CLOSE,{})})),n.on("disconnected",(function(){t.emit(C.PEER_DISCONNECT,{})})),n}},{key:"onPkg",value:function(e,t){return Object(y.a)(Object(E.a)(n.prototype),"onMatch",this).call(this,C.CONN_PKG,(function(n){var r=n.data,o=Object(u.a)(n,["data"]);t(Object(c.a)(Object(c.a)({},o),{},{data:r,type:e}))}),{_:{type:e}})}},{key:"oncePkg",value:function(e,t){return Object(y.a)(Object(E.a)(n.prototype),"onceMatch",this).call(this,C.CONN_PKG,(function(n){var r=n.data,o=Object(u.a)(n,["data"]);t(Object(c.a)(Object(c.a)({},o),{},{data:r,type:e}))}),{_:{type:e}})}},{key:"untilPkg",value:function(){var e=Object(v.a)(f.a.mark((function e(t,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}throw new Error("trying to subscribe undefined pkgType");case 2:return e.next=4,Object(y.a)(Object(E.a)(n.prototype),"untilMatch",this).call(this,C.CONN_PKG,{_:{type:t}},r,t).then((function(e){var n=e.data,r=Object(u.a)(e,["data"]);return Object(c.a)(Object(c.a)({},r),{},{data:n,type:t})}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"on",value:function(e,t){return Object(y.a)(Object(E.a)(n.prototype),"on",this).call(this,e,t)}},{key:"once",value:function(e,t){return Object(y.a)(Object(E.a)(n.prototype),"once",this).call(this,e,t)}},{key:"emit",value:function(e,t){var r=t.conn,o=Object(u.a)(t,["conn"]);this.log("emit",e,Object(c.a)(Object(c.a)({},o),void 0!==r?{conn:{id:null===r||void 0===r?void 0:r.id}}:{})),Object(y.a)(Object(E.a)(n.prototype),"emit",this).call(this,e,t)}},{key:"enrichConn",value:function(e){return this.connections.push(e),e}},{key:"disconnect",value:function(e){var t;null===(t=this.connections.find((function(t){return t.id===e})))||void 0===t||t.close()}},{key:"disconnectAll",value:function(){this.connections.map((function(e){return e.close()}))}},{key:"destroy",value:function(){this.closed=!0,this.peer.destroy(),this.disconnectAll()}},{key:"close",value:function(){this.closed=!0,this.peer.destroy(),this.disconnectAll()}}]),n}(S),G=n(16),D=n(2),I=n(22),L=n(7),W=function(e){null===e||void 0===e||e.traverse((function(e){if(e instanceof D.O){var t=e.geometry,n=e.material;void 0!==t&&t.dispose();var r=function(e){Object.keys(e).forEach((function(t){var n=e[t];n instanceof D.sb&&n.dispose()})),e.dispose()};void 0!==n&&(Array.isArray(n)?n.forEach(r):r(n))}}))},z=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(b.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).color=void 0,e.growthStage=void 0,e.seedObj=void 0,e.treeObj=void 0,e.topObj=void 0,e.trunkObj=void 0,e.shadeObj=void 0,e.shadeEntity=void 0,e}return Object(m.a)(n,[{key:"reset",value:function(){var e;W(this.topObj),W(this.trunkObj),W(this.treeObj),W(this.seedObj),this.seedObj=void 0,this.treeObj=void 0,this.topObj=void 0,this.trunkObj=void 0,null===(e=this.shadeEntity)||void 0===e||e.remove(),this.shadeEntity=void 0}}]),n}(L.a);z.schema={color:{type:L.d.Number},growthStage:{type:L.d.Number},treeObj:{type:L.d.Ref,default:void 0},topObj:{type:L.d.Ref,default:void 0},trunkObj:{type:L.d.Ref,default:void 0},shadeObj:{type:L.d.Ref,default:void 0},shadeEntity:{type:L.d.Ref,default:void 0},seedObj:{type:L.d.Ref,default:void 0}};var B,K,q,U,F,Y,V=n(59),J={BLUE_TOP:"blueTop",ORANGE_TOP:"orangeTop",YELLOW_TOP:"yellowTop",GREEN_TOP:"greenTop",TRUNK:"trunk",SHADE:"shade",ACORN:"acorn",PINE_CONE:"pineCone",MAPLE_SEED:"mapleSeed",BASSWOOD_SEED:"basswoodSeed",RING:"ring",LANDSCAPE:"landscape"};!function(e){e[e.BLUE=0]="BLUE",e[e.ORANGE=1]="ORANGE",e[e.YELLOW=2]="YELLOW",e[e.GREEN=3]="GREEN"}(F||(F={})),function(e){e[e.SEED=0]="SEED",e[e.SHORT=1]="SHORT",e[e.MID=2]="MID",e[e.TALL=3]="TALL"}(Y||(Y={}));var X=(B={},Object(d.a)(B,F.BLUE,J.BLUE_TOP),Object(d.a)(B,F.ORANGE,J.ORANGE_TOP),Object(d.a)(B,F.YELLOW,J.YELLOW_TOP),Object(d.a)(B,F.GREEN,J.GREEN_TOP),B),Q=(K={},Object(d.a)(K,F.BLUE,J.PINE_CONE),Object(d.a)(K,F.ORANGE,J.BASSWOOD_SEED),Object(d.a)(K,F.YELLOW,J.ACORN),Object(d.a)(K,F.GREEN,J.MAPLE_SEED),K),$=(q={},Object(d.a)(q,F.BLUE,1865705),Object(d.a)(q,F.ORANGE,1865705),Object(d.a)(q,F.YELLOW,15324444),Object(d.a)(q,F.GREEN,5499164),q),Z=[-18,-10.7,-5.63,0],ee=(Math.PI,U={},Object(d.a)(U,Y.SEED,{tree:{scale:[0,0,0]},seed:{scale:[1,1,1]}}),Object(d.a)(U,Y.SHORT,{tree:{scale:[.333,.333,.333]},seed:{scale:[0,0,0]}}),Object(d.a)(U,Y.MID,{tree:{scale:[.666,.666,.666]},seed:{scale:[0,0,0]}}),Object(d.a)(U,Y.TALL,{tree:{scale:[1,1,1]},seed:{scale:[0,0,0]}}),U),te={},ne={},re=0,oe=0,ae=function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=te[t])){e.next=13;break}if(re===oe){e.next=10;break}return o=null!==(r=ne[t])&&void 0!==r?r:[],void 0===ne[t]&&(ne[t]=o),e.next=7,new Promise((function(e,n){o.push({resolve:e,reject:n,modelName:t})}));case 7:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",Promise.reject(new Error("Model not found: "+t)));case 11:e.next=14;break;case 13:return e.abrupt("return",Promise.resolve(n));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return n}(L.c),ce=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(e,r){var o;if(Object(b.a)(this,n),(o=t.call(this,e,r)).gameWorld=void 0,void 0===(null===r||void 0===r?void 0:r.gameWorld))throw new Error("Game world must be provided");return o.gameWorld=null===r||void 0===r?void 0:r.gameWorld,o}return n}(G.a),se=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(b.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).axial=void 0,e}return n}(L.a);se.schema={axial:{type:L.d.Ref}};var ue=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(b.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).material=void 0,e.treeEntity=void 0,e}return n}(L.a);ue.schema={material:{type:L.d.Ref,default:void 0},treeEntity:{type:L.d.Ref,default:void 0}};var le=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"execute",value:function(e,t){var r,o,a,i=this;null===(r=this.queries.trees.added)||void 0===r||r.forEach((function(e){var t,r=e.getMutableComponent(z),o=e.getComponent(se),a=e.getObject3D();if(void 0!==r&&void 0!==a&&void 0!==o){var c=null===(t=i.gameWorld.tileEntities.get(o.axial.toString()))||void 0===t?void 0:t.getMutableComponent(ue);void 0!==c&&(c.treeEntity=e);var u=r.color;a.name="tree-"+e.id.toString()+"-"+F[u];var l=[ae(X[u]),ae(J.TRUNK),ae(Q[u]),ae(J.SHADE)];Promise.all(l).then((function(t){var o=t.map((function(e){return e.clone()})),c=Object(s.a)(o,3),u=c[0],l=c[1],d=c[2],h=new D.X;h.name="shadeContainer",h.add(t[3]),h.position.y=Z[r.growthStage];var f=i.world.createEntity().addComponent(G.c,{value:h}).addComponent(ie);r.shadeObj=h,r.shadeEntity=f;var v=new D.X;r.treeObj=v,v.name="tree",u.position.y=10,r.topObj=u,r.trunkObj=l,v.add(u,l),r.seedObj=d;var b=new D.X;b.name="plantContainer",b.rotation.y=Math.random()*Math.PI*2,b.add(v,d),a.add(b,h),n.updateGrowthStage(e)})).catch(console.error)}})),null===(o=this.queries.trees.changed)||void 0===o||o.forEach(n.updateGrowthStage.bind(this)),null===(a=this.queries.trees.removed)||void 0===a||a.forEach((function(e){var t,n=e.getComponent(z),r=e.getComponent(se);if(void 0!==n&&void 0!==r){var o=null===(t=i.gameWorld.tileEntities.get(r.axial.toString()))||void 0===t?void 0:t.getMutableComponent(ue);void 0!==o&&(o.treeEntity=void 0)}})),this.queries.trees.results.forEach((function(e){var t=e.getComponent(z);if(void 0!==t){var n=t.treeObj,r=t.seedObj;0===(null===n||void 0===n?void 0:n.scale.lengthSq())&&(n.visible=!1),0===(null===r||void 0===r?void 0:r.scale.lengthSq())&&(r.visible=!1)}}))}}],[{key:"updateGrowthStage",value:function(e){var t=e.getMutableComponent(z);if(void 0!==t){var n,r,o=t.treeObj,a=t.seedObj,i=t.shadeObj;if(void 0!==i&&(i.position.y=Z[t.growthStage]),void 0!==o)(n=o.scale).set.apply(n,Object(I.a)(ee[t.growthStage].tree.scale));if(void 0!==a)(r=a.scale).set.apply(r,Object(I.a)(ee[t.growthStage].seed.scale))}}}]),n}(ce);le.queries={trees:{components:[z,G.c],listen:{added:!0,removed:!0,changed:[z,se]}}};var de=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(b.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).loop=void 0,e.duration=void 0,e.value=void 0,e}return n}(L.a);de.schema={loop:{type:L.d.Number,default:1},duration:{type:L.d.Number},value:{type:L.d.Number,default:0}};var he=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(b.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).prop=void 0,e.from=void 0,e.to=void 0,e.func=void 0,e}return n}(L.a);he.schema={prop:{type:L.d.String},from:{type:L.d.Ref},to:{type:L.d.Ref},func:{type:L.d.Ref}};var fe=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"execute",value:function(e,t){var n,r;(null!==(n=null===(r=this.queries.object3DTweens)||void 0===r?void 0:r.results)&&void 0!==n?n:[]).forEach((function(t){var n=t.getComponent(G.c),r=t.getMutableComponent(de),o=t.getMutableComponent(he);if(void 0!==n&&void 0!==n.value&&void 0!==r&&void 0!==o){var a=n.value,i=r.loop,c=r.duration,s=r.value,u=o.prop,l=o.from,d=o.to,h=o.func,f=Math.min(1,e/c+s);r.value=f;var v=h(l,d,f);a[u].fromArray(v.toArray()),1===f&&(i>0&&(r.loop--,r.value=0),0===i&&t.removeComponent(de))}}))}}]),n}(G.a);fe.queries={object3DTweens:{components:[de,he,G.c]}};var ve=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(b.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).from=void 0,e.to=void 0,e.func=void 0,e}return n}(L.a);ve.schema={from:{type:L.d.Ref},to:{type:L.d.Ref},func:{type:L.d.Ref}};var be=n(36),pe=function(){function e(t,n){Object(b.a)(this,e),this.x=void 0,this.y=void 0,this.x=t,this.y=n}return Object(m.a)(e,[{key:"toArray",value:function(){return[this.x,this.y]}},{key:"toString",value:function(){return this.toArray().join(",")}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"scale",value:function(e){return this.x*=e,this.y*=e,this}},{key:"euclideanDistance",value:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}},{key:"manhattanDistance",value:function(e){return this.x-e.x+(this.y-e.y)}},{key:"added",value:function(t){return new e(this.x,this.y).add(t)}},{key:"scaled",value:function(t){return new e(this.x,this.y).scale(t)}},{key:"norm",value:function(){return this.euclideanDistance(e.origin)}},{key:"normalize",value:function(){return this.scale(1/this.norm())}},{key:"normalized",value:function(){return new e(this.x,this.y).normalize()}},{key:"clone",value:function(){return new e(this.x,this.y)}}],[{key:"fromArray",value:function(t){return Object(be.a)(e,Object(I.a)(t))}},{key:"fromString",value:function(t){var n=t.split(",").map((function(e){return parseInt(e,10)}));return e.fromArray([n[0],n[1]])}},{key:"origin",get:function(){return new e(0,0)}}]),e}();pe.neighbors=[new pe(-1,-1),new pe(0,-1),new pe(1,-1),new pe(-1,0),new pe(1,0),new pe(-1,1),new pe(0,1),new pe(1,1)];var me=function(){function e(t,n){Object(b.a)(this,e),this.q=void 0,this.r=void 0,this.q=t,this.r=n}return Object(m.a)(e,[{key:"toArray",value:function(){return[this.q,this.r]}},{key:"toString",value:function(){return this.toArray().join(",")}},{key:"toHexCube",value:function(){return new Oe(this.q,-this.q-this.r,this.r)}},{key:"toCartesian",value:function(e){var t=e*(Math.sqrt(3)*this.q+Math.sqrt(3)/2*this.r),n=e*(1.5*this.r);return new pe(t,n)}},{key:"add",value:function(e){return this.q+=e.q,this.r+=e.r,this}},{key:"scale",value:function(e){return this.q*=e,this.r*=e,this}},{key:"tileDistance",value:function(e){return(Math.abs(this.q-e.q)+Math.abs(this.q+this.r-e.q-e.r)+Math.abs(this.r-e.r))/2}},{key:"range",value:function(e){return this.toHexCube().range(e).map((function(e){return e.toAxial()}))}}],[{key:"fromArray",value:function(t){return Object(be.a)(e,Object(I.a)(t))}},{key:"fromString",value:function(t){var n=t.split(",").map((function(e){return parseInt(e,10)}));return e.fromArray([n[0],n[1]])}},{key:"origin",get:function(){return new e(0,0)}}]),e}();me.neighbors=[new me(1,0),new me(1,-1),new me(0,-1),new me(-1,0),new me(-1,1),new me(0,1)];var Oe=function(){function e(t,n,r){Object(b.a)(this,e),this.x=void 0,this.y=void 0,this.z=void 0,this.x=t,this.y=n,this.z=r}return Object(m.a)(e,[{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"toString",value:function(){return this.toArray().join(",")}},{key:"toAxial",value:function(){return new me(this.x,this.z)}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"scale",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"tileDistance",value:function(e){return(Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z))/2}},{key:"range",value:function(t){for(var n=[],r=-t;r<=t;r++)for(var o=Math.max(-t,-r-t);o<=Math.min(t,-r+t);o++){var a=-r-o;n.push(new e(this.x+r,this.y+o,this.z+a))}return n}}],[{key:"fromArray",value:function(t){return Object(be.a)(e,Object(I.a)(t))}},{key:"fromString",value:function(t){var n=t.split(",").map((function(e){return parseInt(e,10)}));return e.fromArray([n[0],n[1],n[2]])}},{key:"origin",get:function(){return new e(0,0,0)}}]),e}();Oe.neighbors=[new Oe(1,-1,0),new Oe(1,0,-1),new Oe(0,1,-1),new Oe(-1,1,0),new Oe(-1,0,1),new Oe(0,-1,1)];var ge=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"execute",value:function(e,t){this.queries.axialPositions.results.forEach((function(e){var t=e.getComponent(se),n=e.getComponent(G.c),r=null===n||void 0===n?void 0:n.value;if(void 0!==t&&void 0!==r){var o=t.axial.toCartesian(5).toArray(),a=Object(s.a)(o,2),i=a[0],c=a[1];r.position.set(i,0,c)}}))}}]),n}(G.a);ge.queries={axialPositions:{components:[se,G.c]}};var ye=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"execute",value:function(e,t){this.queries.tiles.results.forEach((function(e){var t=e.getComponent(ue);if(void 0!==t&&void 0!==t.material){var n;if(void 0!==t.treeEntity){var r=t.treeEntity.getComponent(z);if(void 0===r)return;n=$[r.color]}else n=3355443;n!==t.material.color.getHex()&&t.material.color.setHex(n)}}))}}]),n}(G.a);ye.queries={tiles:{components:[ue]}};var Ee=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"execute",value:function(e,t){var n=this;this.queries.sunFacingObjs.results.forEach((function(e){var t=e.getObject3D();void 0!==t&&(t.rotation.y=n.gameWorld.sunOrientationRad)}))}}]),n}(ce);Ee.queries={sunFacingObjs:{components:[ie,G.c]}};var je=n(52),we=new D.l(4,4,1,12),ke=new D.P;ke.visible=!1,ke.name="invisible";var Ce=new D.O(we,ke),xe=new D.X;xe.name="cylinder",xe.add(Ce);new D.P({color:13421772});var Se,_e=n(60),Re=n.n(_e),Ae=function(){function e(){var t=this;Object(b.a)(this,e),this.gui=void 0,this.renderer=void 0,this.world=void 0,this.sceneEntity=void 0,this.camera=void 0,this.messages={},this.stats=void 0,this.sunOrientationRad=0,this.started=!1,this.tileEntities=new Map,this.stats=new Re.a,this.gui=new je.a.GUI,this.renderer=new D.Cb,this.world=new G.b({entityPoolSize:1e3}),document.body.appendChild(this.stats.dom),window.addEventListener("load",(function(){t.init()}))}return Object(m.a)(e,[{key:"dispose",value:function(){var e;this.destroyGUI(),this.world.stop(),this.tileEntities.clear(),W(null===(e=this.sceneEntity)||void 0===e?void 0:e.getObject3D()),this.sunOrientationRad=0,this.started=!1,console.log("end")}},{key:"init",value:function(){var e=this;if(!this.started){console.log("start"),this.started=!0,this.initGUI();var t=new D.j,n=Object(G.e)(this.world,{renderer:this.renderer,animationLoop:function(){e.stats.begin(),e.world.execute(t.getDelta(),t.elapsedTime),e.stats.end()}}),r=n.camera,o=n.sceneEntity;this.camera=r,this.sceneEntity=o,this.initRenderer(),this.initECS(),this.initScene(),this.world.play()}}},{key:"destroyGUI",value:function(){this.gui.destroy(),this.gui=new je.a.GUI}},{key:"initGUI",value:function(){var e=this.gui.add(this,"sunOrientationRad",0,2*Math.PI);e.name("Sun orientation"),e.step(.01)}},{key:"initECS",value:function(){this.world.registerComponent(z),this.world.registerComponent(de),this.world.registerComponent(he),this.world.registerComponent(ve),this.world.registerComponent(se),this.world.registerComponent(ue),this.world.registerComponent(ie),this.world.registerSystem(ge),this.world.registerSystem(ye),this.world.registerSystem(le,{gameWorld:this}),this.world.registerSystem(fe),this.world.registerSystem(Ee,{gameWorld:this})}},{key:"initRenderer",value:function(){this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=D.xb,this.renderer.setClearColor(13300220),this.renderer.outputEncoding=D.Db}},{key:"initScene",value:function(){if(void 0!==this.camera&&void 0!==this.sceneEntity){var e;this.camera.position.set(0,0,95),this.camera.fov=40,null===(e=this.sceneEntity.getObject3D())||void 0===e||e.remove(this.camera);var t=new D.X;t.name="cameraTilt",t.rotation.x=-.4,t.add(this.camera);var n=new D.X;n.name="cameraPivot",n.add(t);var r=this.gui.addFolder("Camera");r.add(this.camera.position,"z",20,300,1).name("zoom"),r.add(t.rotation,"x",-Math.PI/2,0,.01).name("tilt"),r.add(n.rotation,"y",0,2*Math.PI,.01).name("rotation"),r.open(),this.world.createEntity().addObject3DComponent(n,this.sceneEntity)}var o=new D.a(1646408,.5),a=new D.n(16318386,1.2);a.position.set(0,150*Math.sin(52.725),150),a.castShadow=!0,a.shadow.camera.visible=!0,a.shadow.bias=-.001,a.shadow.radius=2,a.shadow.camera.near=50,a.shadow.camera.far=300,a.shadow.camera.top=-100,a.shadow.camera.bottom=50,a.shadow.camera.left=-100,a.shadow.camera.right=100;var i=new D.t;i.name="sun",i.add(a);var c=new D.n(16777215,.2);c.name="sky",c.position.y=100;var s=new D.t;s.name="commonLights",s.add(o,c);var u=new D.X;ae(J.LANDSCAPE).then((function(e){return u.add(e.clone())})).catch(console.error),u.name="floor",this.world.createEntity().addObject3DComponent(u,this.sceneEntity),this.world.createEntity().addObject3DComponent(s,this.sceneEntity),this.world.createEntity().addObject3DComponent(i,this.sceneEntity).addComponent(ie),this.generateGrid(),function(e,t){var n=t.color,r=t.growthStage,o=t.axial,a=new D.X;void 0!==e.tileEntities.get(o.toString())?e.world.createEntity().addObject3DComponent(a,e.sceneEntity).addComponent(z,{color:n,growthStage:r}).addComponent(se,{axial:o}):console.error("Tile not found: "+o.toString())}(this,{color:F.YELLOW,growthStage:Y.MID,axial:new me(0,1)})}},{key:"generateGrid",value:function(){var e=this,t=new D.X;t.name="gameBoard";var n=this.world.createEntity().addObject3DComponent(t,this.sceneEntity);new Oe(0,0,0).range(3).forEach((function(t){var r=t.toAxial(),o=new D.t;o.name="tileContainer-"+r.toString();var a=e.world.createEntity().addObject3DComponent(o,n).addComponent(se,{axial:r}).addComponent(ue);e.tileEntities.set(r.toString(),a)})),ae(J.RING).then((function(t){e.tileEntities.forEach((function(e){var n,r=new D.X;r.name="ringContainer";var o=t.clone(),a=o.children.find((function(e){return e instanceof D.O})),i=null===a||void 0===a?void 0:a.material,c=e.getComponent(se);if(void 0!==a&&i instanceof D.R&&void 0!==c){var s=i.clone();a.material=s,a.material.name="tileRing-"+c.axial.toString();var u=e.getMutableComponent(ue);void 0!==u&&(u.material=s)}else console.error("Cannot find standard material inside ring object");r.add(o,xe.clone()),null===(n=e.getObject3D())||void 0===n||n.add(r)}))})).catch(console.error)}},{key:"send",value:function(e,t){var n,r=null!==(n=this.messages[e])&&void 0!==n?n:[];void 0===this.messages[e]&&(this.messages[e]=r),r.push(t)}}]),e}(),Te=n(91),Ne=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){setTimeout((function(){e()}),t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();!function(e){e[e.STATE_CHANGE=0]="STATE_CHANGE",e[e.MEMBERS_CHANGE=1]="MEMBERS_CHANGE",e[e.MEMBERS_JOIN=2]="MEMBERS_JOIN",e[e.MEMBERS_LEFT=3]="MEMBERS_LEFT",e[e.NETWORK_ERROR=4]="NETWORK_ERROR",e[e.HOST_CHANGE=5]="HOST_CHANGE"}(Se||(Se={}));var Me,Pe,He=function(e){if("object"===typeof e&&null!==e&&"members"in e&&"host"in e){var t=e;return Array.isArray(t.members)&&t.members.reduce((function(e,t){return e&&"string"===typeof t}),!0)}return!1},Ge=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(e,r,o){var a;return Object(b.a)(this,n),(a=t.call(this)).hostConnectionManager=void 0,a.myConnectionManager=void 0,a.meToHostConnection=void 0,a.members=[],a.state=void 0,a.networkName=void 0,a.reducer=void 0,a.hostId=void 0,a.initialState=void 0,a.networkErrorHandler=function(e){a.emit(Se.NETWORK_ERROR,{error:e})},a.sendToHost=function(){var e=Object(v.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==a.meToHostConnection){e.next=2;break}throw new Error("not connected to host");case 2:return e.next=4,a.myConnectionManager.sendPkg(a.meToHostConnection.id,t,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),a.initMyConnectionManagerListeners=function(){a.myConnectionManager.onPkg(x.MEMBER_CHANGE,(function(e){var t=e.data;a.handleMemberChange(t).catch(a.networkErrorHandler)})),a.myConnectionManager.onPkg(x.SET_STATE,(function(e){var t=e.data;a.emit(Se.STATE_CHANGE,{state:t}),a.state=t})),a.myConnectionManager.onPkg(x.DISPATCH,a.dispatchHandler)},a.host=function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.startPrefix(t);case 2:if(n=e.sent,r=a.hostId,a.hostId=a.id,a.hostConnectionManager=n,a.hostConnectionManager.on(C.CONN_OPEN,(function(e){var t,n=e.conn;void 0!==n&&(null===(t=a.hostConnectionManager)||void 0===t||t.broadcastPkg(x.MEMBER_CHANGE,{host:a.hostId,members:[].concat(Object(I.a)(a.members),[n.id])}).catch(a.networkErrorHandler),n.sendPkg(x.SET_STATE,Object(Te.a)(a.state)).catch(a.networkErrorHandler))})),a.hostConnectionManager.on(C.CONN_CLOSE,(function(e){var t,n=e.conn;null===(t=a.hostConnectionManager)||void 0===t||t.broadcastPkg(x.MEMBER_CHANGE,{host:a.id,members:a.members.filter((function(e){return e!==(null===n||void 0===n?void 0:n.id)}))}).catch(a.networkErrorHandler)})),!(a.members.length>0)){e.next=14;break}return o=a.members.filter((function(e){return e!==r})),e.next=12,Promise.all(o.map(function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===n||void 0===n?void 0:n.connect(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).catch(console.log);case 12:return e.next=14,n.broadcastPkg(x.MEMBER_CHANGE,{host:a.id,members:o});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.join=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.myConnectionManager.connectPrefix(t);case 2:a.meToHostConnection=e.sent,a.meToHostConnection.on(C.CONN_CLOSE,(function(){a.members.length>1&&(void 0===a.networkName||a.myConnectionManager.isClosed()||a.members.filter((function(e){return e!==a.hostId}))[0]!==a.id||a.host(a.networkName).catch(a.networkErrorHandler))}));case 4:if(0!==a.members.length){e.next=9;break}return e.next=7,Ne(100);case 7:e.next=4;break;case 9:if(a.members.reduce((function(e,t){return e&&void 0!==a.myConnectionManager.connections.find((function(e){return e.id===t}))}),!0)){e.next=14;break}return e.next=12,Ne(100);case 12:e.next=9;break;case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleMemberChange=function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,o,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!He(t)){e.next=25;break}if(a.emit(Se.HOST_CHANGE,{host:t.host}),t.members.length!==a.members.length||!a.members.reduce((function(e,n){return e&&t.members.includes(n)}),!0)){e.next=4;break}return e.abrupt("return");case 4:return a.hostId=t.host,n=Object(I.a)(a.members),r=t.members,a.members=Object(I.a)(r),o=r.filter((function(e){return!n.includes(e)})),i=n.filter((function(e){return!r.includes(e)})),e.prev=10,e.next=13,Promise.all(o.map(function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.myConnectionManager.connect(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 13:i.forEach((function(e){a.myConnectionManager.disconnect(e)})),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(10),a.emit(Se.NETWORK_ERROR,e.t0),console.log(e.t0);case 20:(o.length>0||i.length>0)&&a.emit(Se.MEMBERS_CHANGE,{members:a.members}),o.length>0&&a.emit(Se.MEMBERS_JOIN,{members:o}),i.length>0&&a.emit(Se.MEMBERS_LEFT,{members:i}),e.next=26;break;case 25:throw new Error("wrong member change payload");case 26:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(t){return e.apply(this,arguments)}}(),a.setReducer=function(e){a.reducer=e},a.dispatch=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(a.members.map(function(){var e=Object(v.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.myConnectionManager.conn(n).sendPkg(x.DISPATCH,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:e.sent.forEach((function(e){var t=e.data;if(void 0!==t&&!0!==t&&"string"===typeof t)throw new Error(t)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.dispatchLocal=function(){var e=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==a.reducer){e.next=3;break}throw a.emit(Se.NETWORK_ERROR,{error:new Error("no reducer defined")}),new Error("no reducer defined");case 3:return n=a.reducer(a.state,t,a.id),a.setState(n),e.next=7,Promise.resolve();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.dispatchHandler=function(e){var t=e.conn,n=e.data,r=e.ack;if(void 0===a.reducer)a.emit(Se.NETWORK_ERROR,{error:new Error("no reducer defined")}),null===r||void 0===r||r("no reducer defined");else if(void 0===t)a.emit(Se.NETWORK_ERROR,{error:new Error("no conn")}),null===r||void 0===r||r("no conn");else try{var o=a.reducer(a.state,n,t.id);a.setState(o),null===r||void 0===r||r(!0)}catch(i){null===r||void 0===r||r(i.message)}},a.setState=function(e){a.state=e,a.emit(Se.STATE_CHANGE,{state:e})},a.leave=function(){var e,t;a.networkName=void 0,null===(e=a.hostConnectionManager)||void 0===e||e.destroy(),null===(t=a.meToHostConnection)||void 0===t||t.close(),a.emit(Se.MEMBERS_LEFT,{members:a.members}),a.emit(Se.MEMBERS_CHANGE,{members:[]}),a.meToHostConnection=void 0,a.hostConnectionManager=void 0,a.state=Object(Te.a)(a.initialState),a.members=[],a.hostId=void 0},a.reducer=o,a.initialState=Object(Te.a)(r),a.myConnectionManager=e,a.initMyConnectionManagerListeners(),a.state=Object(Te.a)(r),a}return Object(m.a)(n,[{key:"id",get:function(){return this.myConnectionManager.id}}]),Object(m.a)(n,[{key:"isHost",value:function(){return void 0!==this.hostConnectionManager||void 0===this.meToHostConnection&&void 0}},{key:"joinOrHost",value:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.networkName=t,e.prev=1,e.next=4,this.host(t);case 4:return e.next=6,this.join(t);case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(1),e.next=12,this.join(t);case 12:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"myId",get:function(){return this.myConnectionManager.id}}]),n}(S);!function(e){e[e.UPDATE_GAME_STATE=0]="UPDATE_GAME_STATE",e[e.REQUEST_GAME_STATE=1]="REQUEST_GAME_STATE",e[e.GAME_OVER=2]="GAME_OVER",e[e.CLICK=3]="CLICK",e[e.GAME_INIT=4]="GAME_INIT"}(Me||(Me={})),function(e){e[e.CLICK=0]="CLICK"}(Pe||(Pe={}));var De,Ie,Le=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this)).room=void 0,r.gameWorld=new Ae,r.dispatch=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.room.network.dispatch({action:De.GAME_EVENT,payload:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.errorHandler=function(e){console.log(e)},r.reducer=function(e,t,n){var o=t.action,a=t.payload,i=r.room.pi(n);switch(o){case Pe.CLICK:var u=a,l=Object(s.a)(u,2),d=l[0],h=l[1];if(null===e.board[d][h]&&e.turn===i)return e.board[d][h]=0===i?"O":"X",e.turn=1-e.turn,0===d&&0===h&&r.room.endGame(n).catch(r.errorHandler),Object(c.a)({},e);throw new Error("invalid move")}return e},r.room=e,r.room.network.on(Se.STATE_CHANGE,(function(e){var t=e.state;r.emit(Me.UPDATE_GAME_STATE,{data:null===t||void 0===t?void 0:t.game})})),r}return Object(m.a)(n,[{key:"started",get:function(){return this.room.started}},{key:"state",get:function(){return this.room.network.state.game}},{key:"me",get:function(){return this.room.p(this.room.myId)}},{key:"mi",get:function(){return Number.parseInt(this.me)}}],[{key:"initialState",get:function(){return{turn:0,board:[[null,null,null],[null,null,null],[null,null,null]]}}}]),Object(m.a)(n,[{key:"start",value:function(){}},{key:"stop",value:function(e){this.emit(Me.GAME_OVER,{data:e})}},{key:"click",value:function(){var e=Object(v.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dispatch({action:Pe.CLICK,payload:[t,n]}).catch(this.errorHandler);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(S),We="ABCDEFGHJKLMNOPQRSTUVWXYZ";!function(e){e[e.JOIN=0]="JOIN",e[e.LEAVE=1]="LEAVE",e[e.RENAME=2]="RENAME",e[e.START_GAME=3]="START_GAME",e[e.END_GAME=4]="END_GAME",e[e.GAME_EVENT=5]="GAME_EVENT"}(De||(De={})),function(e){e[e.SET_PLAYERS=0]="SET_PLAYERS",e[e.SET_HOST=1]="SET_HOST",e[e.START_GAME=2]="START_GAME",e[e.ERROR=3]="ERROR",e[e.END_GAME=4]="END_GAME"}(Ie||(Ie={}));var ze=new(function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this)).network=void 0,r.manager=void 0,r.game=void 0,r.create=function(){var e=Object(v.a)(f.a.mark((function e(t,n){var o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=void 0===n||""===n?[0,0,0,0].map((function(){return We[Math.floor(Math.random()*We.length)]})).join(""):n,e.next=3,r.join(t,o);case 3:return e.abrupt("return",o);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r.join=function(){var e=Object(v.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("joining ".concat(n)),e.next=3,r.network.joinOrHost(n);case 3:return e.next=5,r.network.dispatch({action:De.JOIN,payload:t}).catch((function(e){throw r.leaveRoom(),e}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r.joinOrCreate=r.join,r.errorHandler=function(e){var t=e.error;console.log(t),r.emit(Ie.ERROR,{data:t})},r.rename=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.network.dispatch({action:De.RENAME,payload:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.leaveRoom=function(){r.network.leave(),r.emit(Ie.SET_HOST,{data:void 0})},r.startGame=Object(v.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},n={},Object.entries(r.players).forEach((function(e,r){var o=Object(s.a)(e,2),a=o[0],i=o[1];t[a]=r.toString(),t[r]=a,n[i]=r.toString()})),e.next=5,r.network.dispatch({action:De.START_GAME,payload:{idDict:t,nameDict:n}});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),r.endGame=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.network.dispatch({action:De.END_GAME,payload:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.networkReducer=function(e,t,n){var o=t.action,a=t.payload,i=function(){if("string"!==typeof a)throw new Error("Invalid payload");if(r.started){var t;if(void 0===r.n(a))throw new Error("Room '".concat(null!==(t=r.roomCode)&&void 0!==t?t:"","' has started game"));if(void 0!==e.idDict&&void 0!==e.nameDict){var o=r.n(a);e.idDict[n]=o,e.idDict[o]=n,e.nameDict[a]=o}}if(Object.values(e.players).includes(a))throw new Error("Name '".concat(a,"' already taken"));e.players=Object(c.a)(Object(c.a)({},e.players),{},Object(d.a)({},n,a)),r.emit(Ie.SET_PLAYERS,{data:Object(c.a)({},e.players)})};switch(o){case De.JOIN:var s;if(Object.keys(e.players).length+1>e.maxPlayers)throw new Error("Room '".concat(null!==(s=r.roomCode)&&void 0!==s?s:"","' is already full"));return i(),Object(c.a)({},e);case De.RENAME:return i(),Object(c.a)({},e);case De.LEAVE:var h=r.players,f=a,v=(h[f],Object(u.a)(h,[f].map(l.a)));return e.players=v,r.emit(Ie.SET_PLAYERS,{data:Object(c.a)({},e.players)}),Object(c.a)({},e);case De.START_GAME:var b;if(r.playerIds.length<r.network.state.minPlayers)throw new Error("Not enough players, required 2");var p=a;return e.idDict=Object(Te.a)(p.idDict),e.nameDict=Object(Te.a)(p.nameDict),e.game=Le.initialState,null===(b=r.game)||void 0===b||b.start(),r.emit(Ie.START_GAME,{data:r.game}),Object(c.a)({},e);case De.END_GAME:return e.idDict=void 0,e.nameDict=void 0,void 0!==e.game&&(e.game.gameOver=a),r.game.stop(a),r.emit(Ie.END_GAME,{data:a}),Object(c.a)({},e);case De.GAME_EVENT:if(r.started&&void 0!==e.game){var m;if(void 0!==e.game.gameOver)throw new Error("Game over");return e.game=null===(m=r.game)||void 0===m?void 0:m.reducer(e.game,a,n),Object(c.a)({},e)}throw new Error("Game not started")}return e},r.manager=null!==e&&void 0!==e?e:new H,r.network=new Ge(r.manager,{maxPlayers:4,minPlayers:2,players:{}},r.networkReducer),r.network.on(Se.MEMBERS_LEFT,(function(e){var t=e.members;void 0!==t&&t.forEach((function(e){r.network.dispatchLocal({action:De.LEAVE,payload:e}).catch(r.errorHandler)}))})),r.network.on(Se.HOST_CHANGE,(function(e){var t=e.host;void 0!==t&&r.emit(Ie.SET_HOST,{data:t})})),r.game=new Le(Object(p.a)(r)),r}return Object(m.a)(n,[{key:"p",value:function(e){if(void 0===this.network.state.idDict)throw console.trace("Game not started yet"),new Error("Game not started yet");return this.network.state.idDict[e]}},{key:"pi",value:function(e){if(void 0===this.network.state.idDict)throw console.trace("Game not started yet"),new Error("Game not started yet");return Number.parseInt(this.network.state.idDict[e])}},{key:"n",value:function(e){if(void 0===this.network.state.nameDict)throw console.trace("Game not started yet"),new Error("Game not started yet");return this.network.state.nameDict[e]}},{key:"hostPlayerId",get:function(){return this.network.hostId}},{key:"roomCode",get:function(){return this.network.networkName}},{key:"myId",get:function(){return this.network.id}},{key:"players",get:function(){return this.network.state.players}},{key:"playerIds",get:function(){return Object.keys(this.players)}},{key:"started",get:function(){return void 0!==this.network.state.game&&void 0===this.network.state.game.gameOver}}]),n}(S)),Be=Object(r.createContext)(ze),Ke=function(){return Object(r.useContext)(Be)},qe=n(10),Ue=n(33),Fe=n(65),Ye=n(15),Ve=n(26),Je=n(87),Xe=Object(Ve.a)(.6),Qe={blue:"#3976E9",red:"#E4456F",green:"#2AC87D",yellow:"#E99608",gray:"#9CC6E9"},$e={blue:"#4168AE",red:"#925666",green:"#569276",yellow:"#D49E41",gray:"#8E959B"},Ze={blue:"#7ea6f1",red:"#ed86a1",green:"#74dbaa",yellow:"#f1bb5e",gray:"#bfdaf1"},et=Object(c.a)(Object(c.a)({},Qe),{},{vibrantHighlights:Object(Je.a)(Xe,Qe),dark:["#282c30","#383e43","#484f56"],light:["#E0E3E5","#c0c2c4","#a0a1a3"],white:["#f9fbfc","#f0f2f3","#e8ebec"]}),tt=Object(c.a)(Object(c.a)({},et),{},{primary:et.blue,accent:et.yellow,inputFocus:Object(Ve.a)(.2,et.blue)}),nt=Object(c.a)(Object(c.a)({},tt),{},{blue:[tt.blue,$e.blue],red:[tt.red,$e.red],green:[tt.green,$e.green],yellow:[tt.yellow,$e.yellow],fgHighlights:Object(Je.a)(Xe,$e),bgHighlights:Object(Je.a)(Xe,Ze),gray:[tt.gray,$e.gray],text:tt.dark[0],muted:Xe(tt.dark[0]),background:tt.white[0],bgs:tt.white,fgs:tt.dark,fgPales:tt.dark.map(Xe),border:Object(Ve.a)(.8,et.dark[0]),highlight:Object(Ve.a)(.9,et.dark[0]),code:{color:"#0451a5",backgroundColor:"#ffffff",prolog:"#001080",comment:"#008000",keyword:"#0000FF",number:"#09885a",constant:"#0000ff",variable:"#001080",string:"#a31515",selector:"#800000",tag:"#800000",operator:"#000000",punctuation:"#000000",function:"#795e26",className:"#267f99",char:"#a31515"}}),rt=Object(c.a)(Object(c.a)({},tt),{},{blue:[tt.blue,Ze.blue],red:[tt.red,Ze.red],green:[tt.green,Ze.green],yellow:[tt.yellow,Ze.yellow],gray:[tt.gray,Ze.gray],fgHighlights:Object(Je.a)(Xe,Ze),bgHighlights:Object(Je.a)(Xe,$e),text:tt.light[0],muted:Xe(tt.light[0]),background:tt.dark[0],bgs:tt.dark,fgs:tt.light,fgPales:tt.light.map(Xe),border:Object(Ve.a)(.8,et.light[0]),highlight:Object(Ve.a)(.9,et.light[0]),code:{color:"#9CDCFE",backgroundColor:"#1E1E1E",prolog:"#9cdcfe",comment:"rgb(106, 153, 85)",keyword:"rgb(86, 156, 214)",number:"rgb(181, 206, 168)",constant:"rgb(100, 102, 149)",variable:"rgb(156, 220, 254)",string:"rgb(206, 145, 120)",selector:"rgb(215, 186, 125)",tag:"rgb(86, 156, 214)",operator:"#808080",punctuation:"rgb(212, 212, 212)",function:"rgb(220, 220, 170)",className:"rgb(78, 201, 176)",char:"rgb(209, 105, 105)"}}),ot=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ease";return{transition:t.map((function(t){return"".concat(e,"s ").concat(t," ").concat(n)})).join(",")}},at=function(e){return ot(.1,e)},it={px:3,py:2},ct=Object(c.a)(Object(c.a)({borderRadius:1,border:"1px solid",borderColor:"border"},at(["box-shadow"])),{},{boxShadow:"0 0 0 0 transparent",":focus, &.focus":{boxShadow:function(e){return"0 0 0 3px ".concat(e.colors.inputFocus)},borderColor:"unset"},lineHeight:"input",backgroundColor:"transparent",color:"text",fontFamily:"body",fontWeight:"body",fontSize:1}),st=Object(c.a)(Object(c.a)(Object(c.a)(Object(c.a)({},ct),it),at(["background-color"])),{},{display:"inline-flex",alignItems:"center",textAlign:"unset",outline:"none","::-moz-focus-inner":{border:"none"}}),ut={borderRadius:4},lt=Object(c.a)(Object(c.a)({},st),{px:1,py:1}),dt=Object(c.a)(Object(c.a)({},st),{px:2,py:2}),ht={"":st,"-sm":lt,"-md":dt,"-borderless":Object(c.a)(Object(c.a)({},st),{},{border:0}),"-borderless-sm":Object(c.a)(Object(c.a)({},lt),{},{border:0}),"-borderless-md":Object(c.a)(Object(c.a)({},dt),{},{border:0}),"-pill":Object(c.a)(Object(c.a)(Object(c.a)({},st),ut),{},{px:5}),"-pill-sm":Object(c.a)(Object(c.a)(Object(c.a)({},lt),ut),{},{px:3}),"-pill-md":Object(c.a)(Object(c.a)(Object(c.a)({},dt),ut),{},{px:4})},ft={normal:{fg:"text",bg:"background",hoverBg:"highlight"},primary:{fg:"white.0",bg:"blue.0",hoverBg:"blue.1"},success:{fg:"white.0",bg:"blue.0",hoverBg:"blue.1"},warning:{fg:"dark.0",bg:"yellow.0",hoverBg:"yellow.1"},danger:{fg:"white.0",bg:"red.0",hoverBg:"red.1"},red:{fg:"white.0",bg:"red.0",hoverBg:"red.1"},active:{fg:"white.0",bg:"blue.0"},transparent:{fg:"fgs.0",bg:"transparent",hoverBg:"highlight",border:0}},vt={};for(var bt in ht)for(var pt in ft)vt[pt+bt]=Object(c.a)(Object(c.a)({},ht[bt]),{},{backgroundColor:ft[pt].bg,color:ft[pt].fg,"*":{fill:ft[pt].fg},":hover":{backgroundColor:ft[pt].hoverBg},"&:disabled":{backgroundColor:"light.0",color:"light.1"}});var mt=vt,Ot=Object(c.a)(Object(c.a)({},ct),it),gt=Object(c.a)({position:"absolute",top:"12px",pt:"1px",left:it.px,pointerEvents:"none",ml:-1,px:1,fontSize:1,borderRadius:1,color:"fgs.1"},at(["top","font-size","color","background-color"])),yt={backgroundColor:"background",fontSize:0,top:"-10px"},Et=Object(c.a)(Object(c.a)({},{"::placeholder":{color:"transparent"}}),{},{"+ *":Object(c.a)({},gt),":not(:placeholder-shown) + *":Object(c.a)({},yt),":focus + *":Object(c.a)(Object(c.a)({},yt),{color:"blue"})}),jt={normal:Ot,baseMagic:Et,inputMagic:Object(c.a)(Object(c.a)({},Ot),Et)},wt=Object(c.a)(Object(c.a)({},it),{},{color:"text",display:"block",":hover":{backgroundColor:"highlight"}}),kt=Object(c.a)(Object(c.a)({},ct),{},{boxShadow:2,backgroundColor:"bgs.1",lineHeight:1.8,overflow:"hidden",zIndex:1}),Ct=[4,5,6],xt=Ct.map((function(e){return function(t){return t.fontSizes[e]}})),St={fontSize:1,success:{color:"green.1"},danger:{color:"red.1"},warning:{color:"yellow.1"},heading:{fontSize:[3,4],mb:3},subheading:{textTransform:"uppercase",letterSpacing:"2px",fontWeight:"bold",fontSize:2,color:"fgPales.0",mb:3},pageHeading:{fontSize:Ct,mb:3,svg:{color:"#ff0000",width:xt,height:xt}},largeHeading:{fontSize:[5,null,7],mb:3},columnHeading:{fontSize:2,fontWeight:"bold"},columnCardHeading:{fontSize:2,fontWeight:"bold"},helperText:{fontSize:0,color:"muted"}},_t={p:3,px:3,py:3,my:3,borderRadius:1,borderWidth:1,borderStyle:"solid",borderColor:"border"},Rt={normal:Object(c.a)({},_t),dashed:Object(c.a)(Object(c.a)({},_t),{},{borderStyle:"dashed"}),primary:Object(c.a)(Object(c.a)({},_t),{},{borderColor:"blue.1"}),danger:Object(c.a)(Object(c.a)({},_t),{},{borderColor:"red.1",backgroundColor:Object(Ve.a)(.7,tt.red)}),warning:Object(c.a)(Object(c.a)({},_t),{},{borderColor:"yellow.1"}),success:Object(c.a)(Object(c.a)({},_t),{},{borderColor:"green.1",backgroundColor:Object(Ve.a)(.7,tt.green)})},At={borderRadius:1},Tt=function(e,t){return Object(c.a)(Object(c.a)({},At),{},{borderColor:e,color:t,"*":{fill:t}})},Nt={primary:Tt("blue.0","blue.1"),info:Tt("gray.0","gray.1"),danger:Tt("red.0","red.1"),warning:Tt("yellow.0","yellow.1"),success:Tt("green.0","green.1")},Mt={useColorSchemeMediaQuery:!0,colors:Object(c.a)(Object(c.a)({},nt),{},{modes:{dark:rt}}),bg:{success:tt.green[0],danger:tt.red[0],warning:tt.yellow[0]},text:St,breakpoints:["40em","52em","64em","110em"],space:[0,4,8,16,32,64,128,256,512],fonts:{body:"Arial",heading:"inherit",monospace:"Inconsolata, monospace"},fontSizes:[12,14,16,20,24,32,48,64,96],fontWeights:{body:400,heading:300,bold:700},lineHeights:{body:1.5,heading:1.3,input:1.7},radii:[0,4,8,16,32],shadows:[null,"0 2px 4px rgba(0, 0, 0, 0.2)","0 4px 8px rgba(0, 0, 0, 0.3)"],layout:{container:{maxWidth:"100em",p:[3,null,4]},sidebar:{width:"250px"}},buttons:mt,inputs:jt,badges:{primary:{backgroundColor:"blue.0",color:"white.0","*":{fill:"white.0"}},success:{backgroundColor:"green.0",color:"white.0","*":{fill:"white.0"}},danger:{backgroundColor:"red.0",color:"white.0","*":{fill:"white.0"}},warning:{backgroundColor:"yellow.0",color:"dark.0","*":{fill:"dark.0"}}},messages:Nt,code:{fontFamily:"monospace",fontSize:"inherit",color:"code.color",backgroundColor:"code.backgroundColor",borderRadius:1,borderWidth:"1px",borderStyle:"solid",borderColor:"border",p:3,tabSize:4,MozTabSize:"4",".token-line":{display:"flex"},".token":{display:"inline-block",lineHeight:1.5},".prolog":{color:"code.prolog"},".comment":{color:"code.comment"},".builtin,.changed,.keyword":{color:"code.keyword"},".number":{color:"code.number"},".constant":{color:"code.constant"},".attr-name,.variable":{color:"code.variable"},".string,.attr-value":{color:"code.string"},".selector":{color:"code.selector"},".tag":{color:"code.tag"},".punctuation,.operator":{color:"code.operator"},".punctuation, .plain":{color:"code.punctuation"},".function":{color:"code.function"},".class-name":{color:"code.className"},".char":{color:"code.char"},".inserted":{backgroundColor:"fgHighlights.green"},".deleted":{backgroundColor:"fgHighlights.red"},".special":{color:"red.0"},".tab":{position:"relative","::before":{position:"absolute",left:"1px",top:"calc(50% - 0.5px)",content:'""',width:"calc(100% - 3.5px)",borderTopWidth:"1px",borderTopStyle:"solid",borderTopColor:"red.0"},"::after":{position:"absolute",right:"1px",top:0,content:'">"',color:"red.0"}}},menuItem:wt,links:{default:{color:"blue.1","*":{fill:"blue.1"},":hover":{color:"blue.0","*":{fill:"blue.0"}}},plain:{color:"gray.1","*":{fill:"gray.1"},":hover":{color:"gray.0","*":{fill:"gray.0"}}},active:{color:"yellow.1","*":{fill:"yellow.1"},":hover":{color:"yellow.0","*":{fill:"yellow.0"}}}},dropdown:kt,wells:Rt,styles:{root:{fontFamily:"body",fontWeight:"body",lineHeight:"body"},"*":{boxSizing:"border-box"},body:{margin:0},h1:{color:"text",fontFamily:"heading",lineHeight:"heading",fontWeight:"heading",fontSize:5},h2:{color:"text",fontFamily:"heading",lineHeight:"heading",fontWeight:"heading",fontSize:4},h3:{color:"text",fontFamily:"heading",lineHeight:"heading",fontWeight:"heading",fontSize:3},h4:{color:"text",fontFamily:"heading",lineHeight:"heading",fontWeight:"heading",fontSize:2},h5:{color:"text",fontFamily:"heading",lineHeight:"heading",fontWeight:"heading",fontSize:1},h6:{color:"text",fontFamily:"heading",lineHeight:"heading",fontWeight:"heading",fontSize:0},p:{color:"text",fontFamily:"body",fontWeight:"body",lineHeight:"body"},a:{textDecoration:"none",outline:"none","::-moz-focus-inner":{border:"none"}},pre:{fontFamily:"monospace",overflowX:"auto",code:{color:"inherit"}},table:{width:"100%",borderCollapse:"separate",borderSpacing:0},th:{textAlign:"left",borderBottomStyle:"solid"},td:{textAlign:"left",borderBottomStyle:"solid"},img:{maxWidth:"100%"},hr:{borderTop:"1px solid",borderBottom:"none",borderColor:"border"}}},Pt=n(12),Ht=n.n(Pt),Gt=function(e){return void 0!==e&&null!==e},Dt={block:Ht.a.bool},It=Object(r.forwardRef)((function(e,t){return Object(Ye.c)(qe.b,Object.assign({ref:t,variant:"normal",sx:{display:Gt(e.block)&&e.block?"flex":void 0,width:Gt(e.block)&&e.block?"100%":void 0,justifyContent:Gt(e.block)&&e.block?"center":void 0,position:"relative"}},e))}));It.propTypes=Dt,It.defaultProps={block:!1},It.displayName="Button";var Lt=It,Wt=n(64),zt=n.n(Wt),Bt=function(e){var t=(Array.isArray(e.size)?e.size:[e.size]).map((function(e){return function(t){return t.fontSizes[e]*t.lineHeights.body}}));return Object(Ye.c)(zt.a,Object.assign({},Object(c.a)(Object(c.a)({},e),{},{color:null,size:null}),{sx:Object(c.a)({fill:e.color,height:t,width:t},null===e||void 0===e?void 0:e.sx)}))};Bt.defaultProps={color:"text",size:1};var Kt=Bt,qt=(Ht.a.func.isRequired,Ht.a.number.isRequired,function(e){e.state,e.setState;var t=Object(Fe.b)(),n=Object(s.a)(t,2),r=n[0],o=n[1];return Object(Ye.c)(qe.d,{py:2,px:Mt.layout.container.p,sx:{alignItems:"center",position:"fixed",width:"100%"}},Object(Ye.c)(qe.d,{mr:2,sx:{alignItems:"center",flex:1}}),Object(Ye.c)(qe.d,{ml:"auto",sx:{alignItems:"center"}},Object(Ye.c)(Lt,{onClick:function(){return o("default"===r?"dark":"default")},mr:2,title:"Toggle Dark Mode"},Object(Ye.c)(Kt,{path:Ue.b}))))}),Ut=function(e){return Object(Ye.c)(qe.a,Object.assign({as:"input",__themeKey:"inputs",variant:"normal"},e))},Ft=function(e){return o.a.createElement(Lt,{variant:e.variant||"normal-sm",type:"button",sx:Object(c.a)(Object(c.a)({},e.sx),{},{visibility:void 0!==e.hidden&&null!==e.hidden&&e.hidden?"hidden":"unset",overflow:"hidden"}),onClick:e.onClick},o.a.createElement(Kt,{path:e.path,sx:e.iconSx,color:e.color,size:e.size}))},Yt=(Ht.a.bool,Ht.a.string.isRequired,Ht.a.object,Ht.a.string,Ht.a.bool,Ht.a.func,Ht.a.func,Ht.a.string,function(e){var t,n,r,o=e.onClearClick,a=Object(u.a)(e,["onClearClick"]);return Object(Ye.c)(qe.a,{mt:3,sx:Object(c.a)({width:null!==(t=a.fullwidth)&&void 0!==t&&t?"100%":void 0},a.sx)},Object(Ye.c)(qe.f,{sx:{position:"relative"}},Object(Ye.c)(Ut,Object.assign({},a,{placeholder:a.label,variant:"inputMagic",sx:Object(c.a)({width:null!==(n=a.fullwidth)&&void 0!==n&&n?"100%":void 0},a.sx)})),Object(Ye.c)(qe.g,null,a.label),null!==(r=a.disabled)&&void 0!==r&&r||void 0===o?null:Object(Ye.c)(qe.a,{sx:{position:"absolute",right:1,top:"50%",transform:"translateY(-50%)"}},Object(Ye.c)(Ft,{variant:"transparent-borderless-sm",path:Ue.c,onClick:o}))),Object(Ye.c)(qe.g,{variant:"helperText"},a.helperText))}),Vt=Object(r.forwardRef)((function(e,t){return o.a.createElement(qe.a,Object.assign({ref:t,__themeKey:"wells",variant:"normal"},e))}));Vt.displayName="Well";var Jt=Vt,Xt=function(e){return o.a.createElement(qe.a,Object.assign({sx:{py:4,px:5,backgroundColor:"background",boxShadow:2,borderRadius:3}},e))},Qt=(Ht.a.func.isRequired,function(e){var t,n,a=e.setState,i=Ke(),c=Object(r.useState)(""),u=Object(s.a)(c,2),l=u[0],d=u[1],h=Object(r.useState)(null!==(t=null===(n=/^\/(.*)$/.exec(window.location.pathname.replace("/photosynthesis","")))||void 0===n?void 0:n[1])&&void 0!==t?t:""),f=Object(s.a)(h,2),v=f[0],b=f[1],p=Object(r.useState)(""),m=Object(s.a)(p,2),O=m[0],g=m[1],y=Object(r.useState)(""),E=Object(s.a)(y,2),j=E[0],w=E[1],k=Object(r.useState)(!1),C=Object(s.a)(k,2),x=C[0],S=C[1];return o.a.createElement(Xt,null,o.a.createElement(qe.d,{sx:{flexDirection:"column"}},o.a.createElement(qe.e,null,"Welcome to Photosynthesis"),""!==O&&o.a.createElement(Jt,{variant:"danger"},O),o.a.createElement(Yt,{fullwidth:!0,disabled:x,label:"Name",onChange:function(e){var t=e.target;return null===d||void 0===d?void 0:d(t.value)},value:l}),o.a.createElement(Yt,{fullwidth:!0,disabled:x,label:"Room",onChange:function(e){var t=e.target;return null===b||void 0===b?void 0:b(t.value.toUpperCase())},value:v}),o.a.createElement(qe.d,{mt:3},o.a.createElement(Lt,{sx:{flex:1},disabled:x||""===l,variant:"warning",onClick:function(){w("Creating Room..."),S(!0),i.create(l,v).then((function(){g(""),a(ln.ROOM)})).catch((function(e){"unavailable-id"===e.type?g("Room ".concat(v," already exists")):g("Error when creating room"),console.error(e)})).finally((function(){w(""),S(!1)}))}},"New Room"),o.a.createElement(Lt,{sx:{flex:1},disabled:x||""===l,ml:3,variant:"primary",onClick:function(){w("Joining Room..."),S(!0),i.join(l,v).then((function(){g(""),i.started?a(ln.GAME):a(ln.ROOM)})).catch((function(e){g(e.message),console.error(e)})).finally((function(){w(""),S(!1)}))}},"Join Room")),o.a.createElement(qe.g,null,j)))}),$t=(Ht.a.string.isRequired,Ht.a.node.isRequired,Ht.a.number,Ht.a.any,Ht.a.bool,function(e){var t=e.children,n=e.color,r=e.path,a=e.size,i=e.reverse,c=void 0!==i&&i,s=Object(u.a)(e,["children","color","path","size","reverse"]),l=null!==c&&void 0!==c&&c;return o.a.createElement(qe.d,Object.assign({sx:{alignItems:"center",flexDirection:l?"row-reverse":"row"}},s),o.a.createElement(Kt,{size:a,path:r,color:n,sx:{fillOpacity:"transparent"===n?0:1,path:{fill:n}}})," ",o.a.createElement(qe.g,{ml:l?0:2,mr:l?2:0,sx:{flex:1,color:n}},t))});$t.defaultProps={reverse:!1};var Zt=$t,en=n(66),tn=n.n(en),nn=function(e){var t=Object(Ye.e)().theme;return Object(Ye.c)(tn.a,{ariaHideApp:!1,isOpen:e.isOpen,onRequestClose:function(){return!e.isStatic&&e.onClose()},contentLabel:e.contentLabel,style:{overlay:{backgroundColor:t.colors.fgPales[0],zIndex:200,display:"flex",justifyContent:"center",alignItems:"center",padding:t.space[2],overflowY:"auto"}},sx:Object(c.a)(Object(c.a)({minWidth:["100%","250px"],maxWidth:"number"===typeof e.size&&t.breakpoints[e.size],outline:"none",opacity:0,margin:"auto",fontFamily:"body",lineHeight:"body"},at(["opacity"])),{},{"&.ReactModal__Content--after-open":{opacity:1},"&.ReactModal__Content--before-close":{opacity:0}})},Object(Ye.c)(qe.a,Object.assign({},e,{sx:{backgroundColor:"bgs.1",boxShadow:2,borderRadius:1}})))};nn.defaultProps={size:0};var rn=nn,on=function(e){var t="function"===typeof e.onClose?e.onClose:function(){},n="function"===typeof e.onAction?e.onAction:function(){},r=function(e){return function(){t(),n(e)}};return Object(Ye.c)(rn,Object.assign({isStatic:!0},{isOpen:e.isOpen,onClose:e.onClose,contentLabel:e.contentLabel,setIsOpen:e.setIsOpen,size:e.size}),Object(Ye.c)(qe.a,{p:[4,3],pb:2},Object(Ye.c)(qe.e,{variant:"subheading"},e.title),Object(Ye.c)(qe.g,null,e.children)),Object(Ye.c)(qe.d,{p:[3,2],sx:{alignItems:"center",justifyContent:"flex-end"}},!e.hideNoChoice&&Object(Ye.c)(Lt,{onClick:r(!1)},e.noText),Object(Ye.c)(Lt,{ml:2,onClick:r(!0)},e.yesText)))};on.defaultProps={noText:"No",yesText:"Yes",title:"Confirm",hideNoChoice:!1};var an=on,cn=(Ht.a.bool.isRequired,Ht.a.func,Ht.a.string,Ht.a.func,Ht.a.string,Ht.a.node.isRequired,Ht.a.string,Ht.a.number,function(e){return o.a.createElement(an,Object.assign({},e,{hideNoChoice:!0}),e.children)});cn.defaultProps={title:"Alert",yesText:"OK"};var sn=cn,un=Object(r.createContext)(window.alert);un.displayName="AlertContext";Ht.a.func.isRequired;var ln,dn=function(e){var t,n=e.setState,a=Ke(),i=Object(r.useState)({}),c=Object(s.a)(i,2),u=c[0],l=c[1],d=Object(r.useState)(""),h=Object(s.a)(d,2),b=h[0],p=h[1],m=Object(r.useContext)(un),O=null!==(t=u[a.myId])&&void 0!==t?t:"",g=a.rename;Object(r.useEffect)((function(){a.on(Ie.SET_PLAYERS,(function(e){var t=e.data;return l(t)})),a.on(Ie.SET_HOST,(function(e){var t=e.data;return p(t)})),a.on(Ie.START_GAME,(function(e){var t=e.data;n(ln.GAME,t)}))}),[a,n]);return o.a.createElement(Xt,null,o.a.createElement(qe.d,{sx:{flexDirection:"column"}},o.a.createElement(qe.e,null,a.roomCode),o.a.createElement(Yt,{label:"My Name",value:O,onChange:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,r,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.target,e.next=3,g(null!==(n=null===(r=o)||void 0===r?void 0:r.value)&&void 0!==n?n:"");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),o.a.createElement(qe.c,{my:3}),o.a.createElement(qe.d,{sx:{flexDirection:"column"}},Object.entries(u).map((function(e){var t=Object(s.a)(e,2),n=t[0],r=t[1];return n===b?o.a.createElement(Zt,{key:n,path:Ue.d},r,n===a.myId&&" (me)"):o.a.createElement(Zt,{key:n,path:Ue.a},r,n===a.myId&&" (me)")}))),o.a.createElement(qe.c,{my:3}),o.a.createElement(qe.d,null,o.a.createElement(Lt,{sx:{flex:1},variant:"warning",onClick:function(){n(ln.HOME)}},"Back"),o.a.createElement(Lt,{sx:{flex:1,visibility:b===a.myId?null:"hidden"},ml:3,variant:"primary",onClick:b===a.myId?function(){null===a||void 0===a||a.startGame().catch((function(e){console.log(e),m(e.message)}))}:void 0},"Start"))))},hn=Object(r.createContext)([ze.game,void 0,void 0]),fn=function(e){var t=Ke().game,n=Object(r.useState)(void 0),a=Object(s.a)(n,2),i=a[0],u=a[1],l=Object(r.useState)(void 0),d=Object(s.a)(l,2),h=d[0],f=d[1];return Object(r.useEffect)((function(){u(void 0),t.on(Me.UPDATE_GAME_STATE,(function(e){var t=e.data;f(null===t||void 0===t?void 0:t.gameOver),u(Object(c.a)({},t))})),t.on(Me.GAME_OVER,(function(e){var t=e.data;return f(t)}))}),[t]),o.a.createElement(hn.Provider,Object.assign({value:[t,i,h]},e))},vn=(Ht.a.instanceOf(Ae).isRequired,function(e){var t=e.gameWorld,n=Object(r.useRef)(null);return Object(r.useEffect)((function(){var e,r=n.current;null!==r&&(r.childNodes.forEach((function(e){r.removeChild(e)})),r.appendChild(t.renderer.domElement),null===(e=t.world.getSystem(G.d))||void 0===e||e.onResize())}),[n,t.renderer.domElement,t.world]),o.a.createElement(qe.a,{ref:n,sx:{width:"100vw",height:"100vh",position:"fixed",left:0,top:0,right:0,bottom:0,zIndex:-1,canvas:{width:"100%",height:"100%"}}})}),bn=(Ht.a.func.isRequired,function(e){var t,n=e.setState,a=Object(r.useContext)(hn),i=Object(s.a)(a,3),c=i[0],u=i[1],l=i[2];return o.a.createElement(qe.a,null,o.a.createElement(vn,{gameWorld:c.gameWorld}),o.a.createElement(qe.a,{sx:{position:"relative",zIndex:1}},o.a.createElement(Xt,null,null===u||void 0===u||null===(t=u.board)||void 0===t?void 0:t.map((function(e,t){return o.a.createElement(qe.d,{key:t},e.map((function(e,n){return o.a.createElement(qe.a,{key:n,sx:{width:"40px",height:"40px",border:"1px solid black"},onClick:function(){return function(e,t){null===c||void 0===c||c.click(e,t).catch(console.log)}(t,n)}},e)})))})),void 0!==l&&o.a.createElement(qe.a,null,o.a.createElement(qe.c,null),o.a.createElement(Lt,{variant:"primary",onClick:function(){n(ln.ROOM)}},"Next Round")))))});!function(e){e[e.HOME=0]="HOME",e[e.ROOM=1]="ROOM",e[e.GAME=2]="GAME"}(ln||(ln={}));var pn,mn=(pn=function(){var e=Object(r.useState)(ln.HOME),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Ke(),u=function(e){if(e!==n){if(e===ln.HOME)i.leaveRoom(),window.history.pushState({pageTitle:"Whatever Game"},"","/photosynthesis");else if(e===ln.ROOM){var t,r;window.history.pushState({pageTitle:(null!==(t=i.roomCode)&&void 0!==t?t:"")+" - Whatever Game"},"","".concat("/photosynthesis","/").concat(null!==(r=i.roomCode)&&void 0!==r?r:""))}a(e)}};return o.a.createElement(qe.d,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,flexDirection:"column"}},o.a.createElement(qt,{setState:u,state:n}),o.a.createElement(qe.d,{sx:Object(c.a)({flex:1,ml:"-".concat(100*n,"%")},ot(.3,["margin-left"],"linear"))},o.a.createElement(qe.d,{sx:{minWidth:"100vw",justifyContent:"center",alignItems:"center"}},o.a.createElement(Qt,{setState:u})),o.a.createElement(qe.d,{sx:{minWidth:"100vw",justifyContent:"center",alignItems:"center"}},o.a.createElement(dn,{setState:u})),o.a.createElement(qe.d,{sx:{minWidth:"100vw",justifyContent:"center",alignItems:"center"}},o.a.createElement(fn,null,o.a.createElement(bn,{setState:u})))))},function(e){var t=Object(r.useState)([]),n=Object(s.a)(t,2),a=n[0],i=n[1],c=function(){i(a.slice(1))},u=a.map((function(e,t){return o.a.createElement(sn,{key:t,isOpen:0===t,title:e.title,onClose:c},e.message)}));return o.a.createElement(un.Provider,{value:function(e){var t="string"===typeof e?{title:"Alert",message:e}:e;i(a.concat([t]))}},o.a.createElement(pn,e),u)});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/.exec(window.location.hostname));var On=n(19),gn=n(90),yn=function(){return o.a.createElement(On.a,{styles:function(e){return{body:e.styles.body,"*":e.styles["*"],a:e.styles.a}}})};i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(gn.a,{theme:Mt},o.a.createElement(yn,null),o.a.createElement(mn,null))),document.getElementById("root")),function(){var e=new V.a,t=Object.values(J);oe=t.length,t.forEach((function(t){e.load("/photosynthesis/models/"+t+".glb",(function(e){var n=new D.X;n.name=t,n.add.apply(n,Object(I.a)(e.scene.children)),n.traverse((function(e){e instanceof D.O&&(e.castShadow=!0,e.receiveShadow=!0)})),te[t]=n;var r=ne[t];void 0!==r&&(r.forEach((function(e){e.resolve(n)})),ne[t]=void 0),++re===oe&&(Object.values(ne).filter((function(e){return Array.isArray(e)})).forEach((function(e){return null===e||void 0===e?void 0:e.forEach((function(e){var t=e.reject,n=e.modelName;return t(new Error("Model not found: "+n))}))})),Object.keys(ne).forEach((function(e){ne[e]=void 0})))}),void 0,(function(e){return console.error(e)}))}))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister().catch(console.error)})).catch((function(e){console.error(e.message)}))}},[[67,1,2]]]);
//# sourceMappingURL=main.94cc5c69.chunk.js.map